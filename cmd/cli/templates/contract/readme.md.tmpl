# {{.Name}}

A contract-first API service using Mizu's contract/v2 framework.

## Architecture

This project uses a **definition-first** approach:

1. `cmd/api/api.yaml` - Contract definition (types, methods, HTTP bindings)
2. `service/todo/` - Service implementation (business logic)
3. `service/todo/invoker.go` - Bridges contract to service methods
4. `app/server/` - HTTP server with REST and JSON-RPC transports

## Getting Started

```bash
# Run the server
go run ./cmd/api

# Or with make
make run

# Run with hot reload (requires mizu CLI)
mizu dev
```

## Endpoints

| Endpoint | Description |
|----------|-------------|
| `GET /todos` | List all todos |
| `POST /todos` | Create a new todo |
| `GET /todos/{id}` | Get a todo by ID |
| `PUT /todos/{id}` | Update a todo |
| `DELETE /todos/{id}` | Delete a todo |
| `GET /health` | Health check |
| `POST /rpc` | JSON-RPC 2.0 endpoint |
| `GET /openapi.json` | OpenAPI 3.0 specification |

## Testing

```bash
# Run all tests
make test

# Or with go test
go test ./...
```

## Contract Definition

The API contract is defined in `cmd/api/api.yaml`:

```yaml
name: {{.Name}}
description: A simple todo list API

resources:
  - name: todos
    methods:
      - name: list
        output: TodoList
        http:
          method: GET
          path: /todos
      # ... more methods
```

## Example Usage

### REST API

```bash
# List todos
curl http://localhost:8080/todos

# Create a todo
curl -X POST http://localhost:8080/todos \
  -H "Content-Type: application/json" \
  -d '{"title": "Learn Mizu", "priority": "high"}'

# Get a todo
curl http://localhost:8080/todos/todo_1

# Update a todo
curl -X PUT http://localhost:8080/todos/todo_1 \
  -H "Content-Type: application/json" \
  -d '{"completed": true}'

# Delete a todo
curl -X DELETE http://localhost:8080/todos/todo_1
```

### JSON-RPC

```bash
# List todos
curl -X POST http://localhost:8080/rpc \
  -H "Content-Type: application/json" \
  -d '{"jsonrpc": "2.0", "method": "todos.list", "id": 1}'

# Create a todo
curl -X POST http://localhost:8080/rpc \
  -H "Content-Type: application/json" \
  -d '{"jsonrpc": "2.0", "method": "todos.create", "params": {"title": "Learn JSON-RPC"}, "id": 2}'
```

## License

{{.License}}
