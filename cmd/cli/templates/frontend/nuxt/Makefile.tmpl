.PHONY: dev build run clean install

# Development mode: run Nuxt dev server and Go server concurrently
dev:
	@echo "Starting development servers..."
	@(cd frontend && npm run dev) & \
	MIZU_ENV=development go run ./cmd/server

# Build frontend for production
build:
	@echo "Building frontend..."
	cd frontend && npm run build
	@echo "Build complete: dist/"

# Run production server
run: build
	@echo "Starting production server..."
	MIZU_ENV=production go run ./cmd/server

# Clean build artifacts
clean:
	rm -rf dist
	rm -rf frontend/node_modules
	rm -rf frontend/.nuxt
	rm -rf frontend/.output

# Install dependencies
install:
	cd frontend && npm install
	go mod tidy
