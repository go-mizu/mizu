<!DOCTYPE html>
<html lang="{{ .Site.Language }}" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Title -->
    <title>{{ block "title" . }}{{ .Site.Name }}{{ end }}</title>

    <!-- Meta Description -->
    {{ block "meta_description" . }}
    <meta name="description" content="{{ .Site.Description }}">
    {{ end }}

    <!-- Canonical URL -->
    <link rel="canonical" href="{{ .Request.URL }}">

    <!-- Open Graph -->
    {{ block "og_tags" . }}
    <meta property="og:type" content="website">
    <meta property="og:title" content="{{ .Site.Name }}">
    <meta property="og:description" content="{{ .Site.Description }}">
    <meta property="og:url" content="{{ .Site.URL }}">
    {{ end }}

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Preconnect to Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Google Fonts - Pixel Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Pixelify+Sans:wght@400;500;600;700&family=VT323&display=swap" rel="stylesheet">

    <!-- Critical Inline Styles for Theme Colors -->
    <style>
        :root {
            --color-primary: {{ .Theme.Colors.primary }};
            --color-secondary: {{ .Theme.Colors.secondary }};
            --color-background: {{ .Theme.Colors.background }};
            --color-surface: {{ .Theme.Colors.surface }};
            --color-text: {{ .Theme.Colors.text }};
            --color-border: {{ .Theme.Colors.border }};
        }

        [data-theme="dark"] {
            --color-primary: {{ .Theme.DarkColors.primary }};
            --color-secondary: {{ .Theme.DarkColors.secondary }};
            --color-background: {{ .Theme.DarkColors.background }};
            --color-surface: {{ .Theme.DarkColors.surface }};
            --color-text: {{ .Theme.DarkColors.text }};
            --color-border: {{ .Theme.DarkColors.border }};
        }
    </style>

    <!-- Theme Stylesheet -->
    <link rel="stylesheet" href="/theme/assets/css/style.css">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect width='16' height='16' fill='%23f83800'/><rect x='2' y='2' width='12' height='12' fill='%23fcfcfc'/><rect x='4' y='4' width='3' height='3' fill='%23000'/><rect x='9' y='4' width='3' height='3' fill='%23000'/><rect x='6' y='10' width='4' height='2' fill='%23000'/></svg>">

    {{ block "head" . }}{{ end }}
</head>
<body class="{{ block "body_class" . }}{{ end }}{{ if .Theme.Features.pixel_cursor }} pixel-cursor{{ end }}{{ if .Theme.Features.crt_effect }} crt-glow{{ end }}{{ if .Theme.Features.scanlines }} crt-scanlines{{ end }}">

    <!-- Reading Progress Bar -->
    {{ if and .Theme.Features.reading_progress .Request.IsSingle }}
    <div class="reading-progress" id="reading-progress">
        <div class="reading-progress__bar" id="reading-progress-bar"></div>
    </div>
    {{ end }}

    <!-- Site Header -->
    {{ template "partials/header.html" . }}

    <!-- Mobile Navigation -->
    <nav class="mobile-nav" id="mobile-nav" aria-label="Mobile navigation">
        <ul class="mobile-nav__list">
            {{ range .Menus.primary.Items }}
            <li>
                <a href="{{ .URL }}" class="mobile-nav__link{{ if .Active }} active{{ end }}">
                    {{ .Title }}
                </a>
            </li>
            {{ end }}
        </ul>
    </nav>

    <!-- Search Overlay -->
    {{ if .Theme.Features.search }}
    <div class="search-overlay" id="search-overlay">
        <div class="search-box">
            <div class="search-box__header">
                <input type="text" class="search-box__input" placeholder="SEARCH..." id="search-input" autocomplete="off">
                <button class="search-box__close" id="search-close" aria-label="Close search">X</button>
            </div>
            <div class="search-box__results" id="search-results"></div>
        </div>
    </div>
    {{ end }}

    <!-- Main Content -->
    <main class="site-main" id="main-content">
        {{ block "content" . }}{{ end }}
    </main>

    <!-- Site Footer -->
    {{ template "partials/footer.html" . }}

    <!-- Back to Top Button -->
    {{ if .Theme.Features.back_to_top }}
    <button class="back-to-top" id="back-to-top" aria-label="Back to top">
        <span aria-hidden="true">&#9650;</span>
    </button>
    {{ end }}

    <!-- Theme Script -->
    <script src="/theme/assets/js/main.js" defer></script>

    {{ block "scripts" . }}{{ end }}
</body>
</html>
