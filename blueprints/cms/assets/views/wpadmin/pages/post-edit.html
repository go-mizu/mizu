{{define "category-item"}}
<li id="category-{{.ID}}" class="popular-category">
    <label class="selectit">
        <input value="{{.ID}}" type="checkbox" name="post_category[]" id="in-category-{{.ID}}" {{if .Selected}}checked="checked"{{end}}>
        {{.Name}}
    </label>
    {{if .Children}}
    <ul class="children">
        {{range .Children}}
        {{template "category-item" .}}
        {{end}}
    </ul>
    {{end}}
</li>
{{end}}

{{define "content"}}
<h1>{{if .IsNew}}Add New Post{{else}}Edit Post{{end}}</h1>

<form name="post" action="/wp-admin/post.php" method="post" id="post">
    <input type="hidden" id="post_ID" name="post_ID" value="{{if .Post}}{{.Post.ID}}{{end}}">
    <input type="hidden" name="post_type" value="post">
    <input type="hidden" name="action" value="{{if .IsNew}}create{{else}}update{{end}}">

    <div id="poststuff">
        <div id="post-body" class="metabox-holder columns-2">
            <div id="post-body-content">
                <!-- Title -->
                <div id="titlediv">
                    <div id="titlewrap">
                        <label class="screen-reader-text" id="title-prompt-text" for="title">Title</label>
                        <input type="text" name="post_title" size="30" value="{{if .Post}}{{.Post.Title}}{{end}}" id="title" spellcheck="true" autocomplete="off" placeholder="Add title">
                    </div>
                    <div class="inside">
                        <div id="edit-slug-box" class="hide-if-no-js">
                            <strong>Permalink:</strong>
                            <span id="sample-permalink">
                                <a href="{{if .Post}}/{{.Post.Slug}}/{{end}}">/
                                    <span id="editable-post-name">{{.Slug}}</span>/
                                </a>
                            </span>
                            <span id="edit-slug-buttons">
                                <button type="button" class="edit-slug button button-small hide-if-no-js">Edit</button>
                            </span>
                            <input type="hidden" name="post_name" id="post_name" value="{{.Slug}}">
                        </div>
                    </div>
                </div>

                <!-- Content Editor -->
                <div id="postdivrich" class="postarea wp-editor-expand">
                    <label class="screen-reader-text" for="content">Content</label>
                    <div id="wp-content-wrap" class="wp-core-ui wp-editor-wrap tmce-active">
                        <div id="wp-content-editor-tools" class="wp-editor-tools hide-if-no-js">
                            <div id="wp-content-media-buttons" class="wp-media-buttons">
                                <button type="button" id="insert-media-button" class="button insert-media add_media" data-editor="content">
                                    <span class="wp-media-buttons-icon"></span> Add Media
                                </button>
                            </div>
                            <div class="wp-editor-tabs">
                                <button type="button" id="content-tmce" class="wp-switch-editor switch-tmce" data-wp-editor-id="content">Visual</button>
                                <button type="button" id="content-html" class="wp-switch-editor switch-html" data-wp-editor-id="content">Text</button>
                            </div>
                        </div>
                        <div id="wp-content-editor-container" class="wp-editor-container">
                            <textarea class="wp-editor-area" rows="20" autocomplete="off" cols="40" name="content" id="content">{{if .Post}}{{.Post.Content}}{{end}}</textarea>
                        </div>
                    </div>
                </div>

                <!-- Excerpt -->
                <div id="postexcerpt" class="postbox">
                    <div class="postbox-header">
                        <h2 class="hndle">Excerpt</h2>
                    </div>
                    <div class="inside">
                        <label class="screen-reader-text" for="excerpt">Excerpt</label>
                        <textarea rows="1" cols="40" name="excerpt" id="excerpt">{{.Excerpt}}</textarea>
                        <p>Excerpts are optional hand-crafted summaries of your content.</p>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div id="postbox-container-1" class="postbox-container">
                <!-- Publish Box -->
                <div id="submitdiv" class="postbox">
                    <div class="postbox-header">
                        <h2 class="hndle">Publish</h2>
                    </div>
                    <div class="inside">
                        <div class="submitbox" id="submitpost">
                            <div id="minor-publishing">
                                <div id="minor-publishing-actions">
                                    <div id="save-action">
                                        <input type="submit" name="save" id="save-post" value="Save Draft" class="button">
                                        <span class="spinner"></span>
                                    </div>
                                    <div id="preview-action">
                                        <a class="preview button" href="{{if .Post}}/{{.Post.Slug}}/{{else}}#{{end}}" target="wp-preview">Preview</a>
                                    </div>
                                    <div class="clear"></div>
                                </div>

                                <div id="misc-publishing-actions">
                                    <div class="misc-pub-section misc-pub-post-status">
                                        <label for="post_status">Status:</label>
                                        <span id="post-status-display">{{.CurrentStatus}}</span>
                                        <a href="#post_status" class="edit-post-status hide-if-no-js">Edit</a>
                                        <div id="post-status-select" class="hide-if-js">
                                            <select name="post_status" id="post_status">
                                                {{range .Statuses}}
                                                <option value="{{.Value}}" {{if eq $.CurrentStatus .Value}}selected{{end}}>{{.Label}}</option>
                                                {{end}}
                                            </select>
                                            <a href="#post_status" class="save-post-status hide-if-no-js button">OK</a>
                                            <a href="#post_status" class="cancel-post-status hide-if-no-js button-cancel">Cancel</a>
                                        </div>
                                    </div>

                                    <div class="misc-pub-section misc-pub-visibility">
                                        <label>Visibility:</label>
                                        <span id="post-visibility-display">{{.CurrentVisibility}}</span>
                                        <a href="#visibility" class="edit-visibility hide-if-no-js">Edit</a>
                                        <div id="post-visibility-select" class="hide-if-js">
                                            {{range .Visibilities}}
                                            <input type="radio" name="visibility" id="visibility-{{.Value}}" value="{{.Value}}" {{if eq $.CurrentVisibility .Value}}checked{{end}}>
                                            <label for="visibility-{{.Value}}">{{.Label}}</label><br>
                                            {{end}}
                                            <div id="password-visibility-row" class="hide-if-js">
                                                <label for="post_password">Password:</label>
                                                <input type="text" name="post_password" id="post_password" value="">
                                            </div>
                                            <p>
                                                <a href="#visibility" class="save-post-visibility hide-if-no-js button">OK</a>
                                                <a href="#visibility" class="cancel-post-visibility hide-if-no-js button-cancel">Cancel</a>
                                            </p>
                                        </div>
                                    </div>

                                    <div class="misc-pub-section curtime misc-pub-curtime">
                                        <span id="timestamp">
                                            {{if .IsNew}}
                                            Publish <b>immediately</b>
                                            {{else if .Post}}
                                            Published on: <b>{{formatDateTime .Post.CreatedAt}}</b>
                                            {{end}}
                                        </span>
                                        <a href="#edit_timestamp" class="edit-timestamp hide-if-no-js">Edit</a>
                                        <div id="timestampdiv" class="hide-if-js">
                                            <input type="text" name="publish_date" id="publish_date" value="{{.PublishDate}}">
                                            <input type="text" name="publish_time" id="publish_time" value="{{.PublishTime}}">
                                            <a href="#edit_timestamp" class="save-timestamp hide-if-no-js button">OK</a>
                                            <a href="#edit_timestamp" class="cancel-timestamp hide-if-no-js button-cancel">Cancel</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="clear"></div>
                            </div>

                            <div id="major-publishing-actions">
                                {{if not .IsNew}}
                                <div id="delete-action">
                                    <a class="submitdelete deletion" href="/wp-admin/post.php?post={{.Post.ID}}&action=trash">Move to Trash</a>
                                </div>
                                {{end}}
                                <div id="publishing-action">
                                    <span class="spinner"></span>
                                    <input type="submit" name="publish" id="publish" class="button button-primary button-large" value="{{if .IsNew}}Publish{{else}}Update{{end}}">
                                </div>
                                <div class="clear"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Categories -->
                <div id="categorydiv" class="postbox">
                    <div class="postbox-header">
                        <h2 class="hndle">Categories</h2>
                    </div>
                    <div class="inside">
                        <div id="taxonomy-category" class="categorydiv">
                            <ul id="category-tabs" class="category-tabs">
                                <li class="tabs"><a href="#category-all">All Categories</a></li>
                                <li class="hide-if-no-js"><a href="#category-pop">Most Used</a></li>
                            </ul>
                            <div id="category-all" class="tabs-panel">
                                <input type="hidden" name="post_category[]" value="0">
                                <ul id="categorychecklist" class="categorychecklist form-no-clear">
                                    {{range .AllCategories}}
                                    {{template "category-item" .}}
                                    {{end}}
                                </ul>
                            </div>
                        </div>
                        <div id="category-adder" class="wp-hidden-children">
                            <a id="category-add-toggle" href="#category-add" class="hide-if-no-js taxonomy-add-new">+ Add New Category</a>
                            <p id="category-add" class="category-add wp-hidden-child">
                                <label class="screen-reader-text" for="newcategory">Add New Category</label>
                                <input type="text" name="newcategory" id="newcategory" class="form-required form-input-tip" value="">
                                <label class="screen-reader-text" for="newcategory_parent">Parent Category:</label>
                                <select name="newcategory_parent" id="newcategory_parent" class="postform">
                                    <option value="-1">— Parent Category —</option>
                                    {{range .AllCategories}}
                                    <option value="{{.ID}}">{{.Name}}</option>
                                    {{end}}
                                </select>
                                <input type="button" id="category-add-submit" data-wp-lists="add:categorychecklist:category-add" class="button category-add-submit" value="Add New Category">
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Tags -->
                <div id="tagsdiv-post_tag" class="postbox">
                    <div class="postbox-header">
                        <h2 class="hndle">Tags</h2>
                    </div>
                    <div class="inside">
                        <div class="tagsdiv" id="post_tag">
                            <div class="jaxtag">
                                <div class="nojs-tags hide-if-js">
                                    <label for="tax-input-post_tag">Add or remove tags</label>
                                    <p><textarea name="tax_input[post_tag]" id="tax-input-post_tag" cols="22" rows="2">{{range $i, $tag := .AllTags}}{{if contains $.SelectedTags $tag.ID}}{{if $i}}, {{end}}{{$tag.Name}}{{end}}{{end}}</textarea></p>
                                </div>
                                <div class="ajaxtag hide-if-no-js">
                                    <label class="screen-reader-text" for="new-tag-post_tag">Add New Tag</label>
                                    <input type="text" id="new-tag-post_tag" name="newtag[post_tag]" class="newtag form-input-tip" size="16" autocomplete="off" value="">
                                    <input type="button" class="button tagadd" value="Add">
                                </div>
                            </div>
                            <div class="tagchecklist" role="list"></div>
                        </div>
                        <p class="howto" id="new-tag-post_tag-desc">Separate tags with commas</p>
                    </div>
                </div>

                <!-- Featured Image -->
                <div id="postimagediv" class="postbox">
                    <div class="postbox-header">
                        <h2 class="hndle">Featured image</h2>
                    </div>
                    <div class="inside">
                        <div id="set-post-thumbnail" class="hide-if-no-js">
                            {{if .FeaturedMedia}}
                            <img src="{{.FeaturedMedia.URL}}" alt="" class="attachment-post-thumbnail">
                            <p><a href="#" id="remove-post-thumbnail">Remove featured image</a></p>
                            <input type="hidden" name="thumbnail_id" value="{{.FeaturedMedia.ID}}">
                            {{else}}
                            <a href="#" id="set-post-thumbnail-link">Set featured image</a>
                            {{end}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
{{end}}
