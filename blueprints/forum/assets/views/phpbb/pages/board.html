{{define "board.html"}}
{{template "default.html" .}}
{{end}}

{{define "content"}}
<div class="panel forum-info-panel">
    <div class="inner">
        <h2>{{.Data.Board.Title}}</h2>
        <p class="forum-description">{{.Data.Board.Description}}</p>
        <div class="forum-stats">
            <span><strong>{{formatNumber .Data.Board.MemberCount}}</strong> members</span>
            <span><strong>{{formatNumber .Data.Board.ThreadCount}}</strong> topics</span>
            <span>Created {{formatTimeRelative .Data.Board.CreatedAt}}</span>
        </div>
        {{if .CurrentUser}}
        <div class="forum-actions">
            {{if .Data.Board.IsJoined}}
            <button class="button" data-action="leave" data-board="{{.Data.Board.Name}}">Leave Forum</button>
            {{else}}
            <button class="button button-primary" data-action="join" data-board="{{.Data.Board.Name}}">Join Forum</button>
            {{end}}
        </div>
        {{end}}
    </div>
</div>

<div class="action-bar top">
    <div class="inner">
        <ul class="sort-tabs">
            <li class="{{if eq .Data.Sort "hot"}}active{{end}}"><a href="/b/{{.Data.Board.Name}}?sort=hot">Hot</a></li>
            <li class="{{if eq .Data.Sort "new"}}active{{end}}"><a href="/b/{{.Data.Board.Name}}?sort=new">New</a></li>
            <li class="{{if eq .Data.Sort "rising"}}active{{end}}"><a href="/b/{{.Data.Board.Name}}?sort=rising">Rising</a></li>
            <li class="{{if eq .Data.Sort "top"}}active{{end}}"><a href="/b/{{.Data.Board.Name}}?sort=top">Top</a></li>
        </ul>
        {{if .CurrentUser}}
        <div class="buttons">
            <a href="/b/{{.Data.Board.Name}}/submit" class="button button-primary">New Topic</a>
        </div>
        {{end}}
    </div>
</div>

<div class="forumbg">
    <div class="inner">
        <ul class="topiclist topics">
            <li class="header">
                <dl class="row-item">
                    <dt><div class="list-inner">Topics</div></dt>
                    <dd class="posts">Replies</dd>
                    <dd class="views">Points</dd>
                    <dd class="lastpost">Last post</dd>
                </dl>
            </li>
        </ul>
        <ul class="topiclist topics">
            {{range .Data.Threads}}
            <li class="row topic-row {{if .IsPinned}}sticky{{end}} {{if .IsLocked}}locked{{end}}" data-thread-id="{{.ID}}">
                <dl class="row-item topic_{{if gt .Score 50}}hot{{else if .IsLocked}}locked{{else if .IsPinned}}sticky{{else}}read{{end}}">
                    <dt class="topic-icon">
                        <div class="topic-folder-icon {{if gt .Score 50}}hot{{else if .IsLocked}}locked{{else if .IsPinned}}sticky{{end}}"></div>
                    </dt>
                    <dd class="topic-info">
                        <div class="list-inner">
                            {{if or .IsNSFW .IsSpoiler .IsPinned .IsLocked}}
                            <div class="topic-labels">
                                {{if .IsPinned}}<span class="label label-sticky">Sticky</span>{{end}}
                                {{if .IsLocked}}<span class="label label-locked">Locked</span>{{end}}
                                {{if .IsNSFW}}<span class="label label-nsfw">NSFW</span>{{end}}
                                {{if .IsSpoiler}}<span class="label label-spoiler">Spoiler</span>{{end}}
                            </div>
                            {{end}}
                            <a href="/b/{{$.Data.Board.Name}}/{{.ID}}/{{slugify .Title}}" class="topictitle">{{.Title}}</a>
                            {{if eq .Type "link"}}
                            <span class="topic-domain">(<a href="/search?q=site:{{.Domain}}">{{.Domain}}</a>)</span>
                            {{end}}
                            <br>
                            <div class="topic-poster">
                                by
                                {{if .Author}}
                                <a href="/u/{{.Author.Username}}" class="username">{{.Author.Username}}</a>
                                {{else}}
                                <span class="username">[deleted]</span>
                                {{end}}
                                &raquo; <time>{{formatTimeRelative .CreatedAt}}</time>
                            </div>
                        </div>
                    </dd>
                    <dd class="posts">{{.CommentCount}}</dd>
                    <dd class="views">
                        <div class="vote-display">
                            <span class="arrow up {{if eq .Vote 1}}upmod{{else}}login-required{{end}}" data-action="upvote" data-thread="{{.ID}}" role="button" tabindex="0"></span>
                            <span class="score">{{formatScore .Score}}</span>
                            <span class="arrow down {{if eq .Vote -1}}downmod{{else}}login-required{{end}}" data-action="downvote" data-thread="{{.ID}}" role="button" tabindex="0"></span>
                        </div>
                    </dd>
                    <dd class="lastpost">
                        <span>{{formatTimeRelative .CreatedAt}}</span>
                        {{if .Author}}
                        <br>by <a href="/u/{{.Author.Username}}" class="username-coloured">{{.Author.Username}}</a>
                        {{end}}
                    </dd>
                </dl>
            </li>
            {{else}}
            <li class="row no-results">
                <div class="inner">No topics in this forum yet. Be the first to post!</div>
            </li>
            {{end}}
        </ul>
    </div>
</div>

<div class="action-bar bottom">
    <div class="inner">
        <div class="pagination">
            <a href="/b/{{.Data.Board.Name}}?after=25" class="button">Next &raquo;</a>
        </div>
    </div>
</div>

{{if .Data.Board.SidebarHTML}}
<div class="panel sidebar-panel">
    <div class="inner">
        <h3>Forum Rules</h3>
        <div class="panel-content">
            {{safeHTML .Data.Board.SidebarHTML}}
        </div>
    </div>
</div>
{{end}}

{{if .Data.Board.IsModerator}}
<div class="panel mod-panel">
    <div class="inner">
        <h3>Moderator Tools</h3>
        <ul class="mod-links">
            <li><a href="/b/{{.Data.Board.Name}}/mod">Moderator Dashboard</a></li>
        </ul>
    </div>
</div>
{{end}}
{{end}}
