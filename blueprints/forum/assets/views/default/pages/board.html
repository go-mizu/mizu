{{define "board.html"}}
{{template "default.html" .}}
{{end}}

{{define "content"}}
<div class="board-header">
    <div class="board-banner" {{if .Data.Board.BannerURL}}style="background-image: url('{{.Data.Board.BannerURL}}')"{{end}}></div>
    <div class="board-header-content">
        {{if .Data.Board.IconURL}}
            <img src="{{.Data.Board.IconURL}}" alt="" class="board-icon-lg">
        {{else}}
            <div class="board-icon-lg placeholder">{{slice .Data.Board.Name 0 1}}</div>
        {{end}}
        <div class="board-info">
            <h1>{{.Data.Board.Title}}</h1>
            <span class="board-name">b/{{.Data.Board.Name}}</span>
        </div>
        {{if .CurrentUser}}
            {{if .Data.Board.IsJoined}}
                <button class="btn btn-secondary" data-action="leave" data-board="{{.Data.Board.Name}}">Joined</button>
            {{else}}
                <button class="btn btn-primary" data-action="join" data-board="{{.Data.Board.Name}}">Join</button>
            {{end}}
        {{end}}
    </div>
</div>

<div class="page-layout">
    <div class="content-feed">
        <div class="sort-tabs">
            <a href="/b/{{.Data.Board.Name}}?sort=hot" class="sort-tab {{if eq .Data.Sort "hot"}}active{{end}}">Hot</a>
            <a href="/b/{{.Data.Board.Name}}?sort=new" class="sort-tab {{if eq .Data.Sort "new"}}active{{end}}">New</a>
            <a href="/b/{{.Data.Board.Name}}?sort=top" class="sort-tab {{if eq .Data.Sort "top"}}active{{end}}">Top</a>
            <a href="/b/{{.Data.Board.Name}}?sort=rising" class="sort-tab {{if eq .Data.Sort "rising"}}active{{end}}">Rising</a>
        </div>

        <div class="thread-list">
            {{range .Data.Threads}}
                {{template "thread_card" .}}
            {{else}}
                <div class="empty-state">
                    <h3>No posts in this community yet</h3>
                    <p>Be the first to share something!</p>
                    {{if $.CurrentUser}}
                        <a href="/b/{{$.Data.Board.Name}}/submit" class="btn btn-primary">Create Post</a>
                    {{end}}
                </div>
            {{end}}
        </div>
    </div>

    <aside class="sidebar">
        <div class="sidebar-card">
            <div class="sidebar-card-header">About Community</div>
            <div class="sidebar-card-body board-about">
                <p class="board-description">{{.Data.Board.Description}}</p>
                <div class="board-stats">
                    <div class="stat">
                        <span class="stat-value">{{formatNumber .Data.Board.MemberCount}}</span>
                        <span class="stat-label">Members</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value">{{formatNumber .Data.Board.ThreadCount}}</span>
                        <span class="stat-label">Posts</span>
                    </div>
                </div>
                <p class="board-created">Created {{formatTimeRelative .Data.Board.CreatedAt}}</p>
            </div>
        </div>

        {{if .Data.Board.SidebarHTML}}
            <div class="sidebar-card">
                <div class="sidebar-card-header">Community Rules</div>
                <div class="sidebar-card-body">
                    {{safeHTML .Data.Board.SidebarHTML}}
                </div>
            </div>
        {{end}}

        {{if .CurrentUser}}
            <div class="sidebar-card">
                <div class="sidebar-card-body">
                    <a href="/b/{{.Data.Board.Name}}/submit" class="btn btn-primary btn-block">Create Post</a>
                </div>
            </div>
        {{end}}

        {{if .Data.Board.IsModerator}}
            <div class="sidebar-card">
                <div class="sidebar-card-header">Moderator Tools</div>
                <div class="sidebar-card-body">
                    <a href="/b/{{.Data.Board.Name}}/mod" class="btn btn-secondary btn-block">Mod Dashboard</a>
                </div>
            </div>
        {{end}}
    </aside>
</div>
{{end}}
