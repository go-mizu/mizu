import{j as e}from"./markdown-DRpjVqyA.js";import{u as P,r as m}from"./react-vendor-DqWpB-k-.js";import{S as k}from"./SearchHeader-DsNOD52C.js";import{P as z}from"./Pagination-Cu2MGMWm.js";import{s as C}from"./index-C5nRY0DN.js";import{N as R,a as L,b as M,f as w,E as D}from"./ui-BUNJN1AT.js";const N=20;function b(a){const r=new Date(a),l=new Date().getTime()-r.getTime(),i=Math.floor(l/(1e3*60)),c=Math.floor(l/(1e3*60*60)),d=Math.floor(l/(1e3*60*60*24));return i<1?"Just now":i<60?`${i} min${i>1?"s":""} ago`:c<24?`${c} hour${c>1?"s":""} ago`:d<7?`${d} day${d>1?"s":""} ago`:r.toLocaleDateString()}function v(a,r){if(!a&&!r)return"";try{return`https://www.google.com/s2/favicons?domain=${a||new URL(r).hostname}&sz=32`}catch{return""}}function q(a){return a?a.charAt(0).toUpperCase():"?"}function B(){const[a,r]=P(),o=a.get("q")||"",l=parseInt(a.get("page")||"1",10),[i,c]=m.useState([]),[d,h]=m.useState([]),[y,x]=m.useState(!1),[f,p]=m.useState(null),[_,S]=m.useState(0),u=m.useRef(null);m.useEffect(()=>{if(!o){c([]),h([]);return}(async()=>{x(!0),p(null);try{const n=await C.searchNews(o,{page:l,per_page:N}),t=n.results||[];l===1&&t.length>5?(h(t.slice(0,5)),c(t.slice(5))):(h([]),c(t)),S(n.total_results||t.length*10)}catch(n){p(n instanceof Error?n.message:"Search failed")}finally{x(!1)}})()},[o,l]);const E=s=>{r({q:s})},T=s=>{r({q:o,page:String(s)}),window.scrollTo({top:0,behavior:"smooth"})},g=s=>{if(u.current){const n=s==="left"?-400:400;u.current.scrollBy({left:n,behavior:"smooth"})}},$=Math.ceil(_/N);return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(k,{query:o,activeTab:"news",onSearch:E}),e.jsx("main",{children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:y?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}):f?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-red-600",children:f})}):i.length>0||d.length>0?e.jsxs(e.Fragment,{children:[d.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-medium text-[#202124] mb-4 flex items-center gap-2",children:[e.jsx(R,{size:20,className:"text-[#1a73e8]"}),"Top Stories"]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",onClick:()=>g("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 z-10 w-10 h-10 bg-white rounded-full shadow-lg flex items-center justify-center text-[#5f6368] hover:text-[#202124] transition-colors",children:e.jsx(L,{size:24})}),e.jsx("button",{type:"button",onClick:()=>g("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 z-10 w-10 h-10 bg-white rounded-full shadow-lg flex items-center justify-center text-[#5f6368] hover:text-[#202124] transition-colors",children:e.jsx(M,{size:24})}),e.jsx("div",{ref:u,className:"flex gap-4 overflow-x-auto scrollbar-hide scroll-smooth pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:d.map((s,n)=>e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex-shrink-0 w-80 bg-white rounded-lg shadow-sm border border-[#dadce0] overflow-hidden hover:shadow-md transition-shadow",children:[(s.image_url||s.thumbnail_url)&&e.jsx("div",{className:"h-40 bg-[#f1f3f4]",children:e.jsx("img",{src:s.image_url||s.thumbnail_url,alt:"",className:"w-full h-full object-cover",onError:t=>{t.currentTarget.parentElement.style.display="none"}})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:v(s.source||s.source_name,s.url),alt:"",className:"w-4 h-4 rounded",onError:t=>{t.currentTarget.style.display="none"}}),e.jsx("span",{className:"text-xs text-[#70757a]",children:s.source||s.source_name||s.source_domain})]}),e.jsx("h3",{className:"text-sm font-medium text-[#202124] line-clamp-2",children:s.title}),e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-[#70757a]",children:[e.jsx(w,{size:12}),e.jsx("span",{children:s.published_at?b(s.published_at):""})]})]})]},`top-${s.id}-${n}`))})]})]}),e.jsx("div",{className:"space-y-4",children:i.map((s,n)=>e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"block bg-white rounded-lg shadow-sm border border-[#dadce0] overflow-hidden hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex-1 p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-[#f1f3f4] flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:v(s.source||s.source_name,s.url),alt:"",className:"w-5 h-5",onError:t=>{t.currentTarget.style.display="none";const j=t.currentTarget.parentElement;j&&(j.innerHTML=`<span class="text-xs font-medium text-[#5f6368]">${q(s.source||s.source_name)}</span>`)}})}),e.jsx("span",{className:"text-sm font-medium text-[#202124]",children:s.source||s.source_name||s.source_domain}),e.jsx("span",{className:"text-[#70757a]",children:"â€¢"}),e.jsxs("span",{className:`text-sm flex items-center gap-1 ${s.published_at&&new Date(s.published_at).getTime()>Date.now()-36e5?"text-[#1a73e8] font-medium":"text-[#70757a]"}`,children:[e.jsx(w,{size:14}),s.published_at?b(s.published_at):""]})]}),e.jsx("h3",{className:"text-lg font-medium text-[#202124] line-clamp-2 hover:text-[#1a73e8] transition-colors",children:s.title}),s.snippet&&e.jsx("p",{className:"text-sm text-[#4d5156] mt-2 line-clamp-2",children:s.snippet}),e.jsxs("div",{className:"mt-3 flex items-center gap-1 text-xs text-[#70757a]",children:[e.jsx(D,{size:12}),e.jsx("span",{children:"Opens in new tab"})]})]}),(s.image_url||s.thumbnail_url)&&e.jsx("div",{className:"flex-shrink-0 w-48 bg-[#f1f3f4]",children:e.jsx("img",{src:s.image_url||s.thumbnail_url,alt:"",className:"w-full h-full object-cover",onError:t=>{t.currentTarget.parentElement.style.display="none"}})})]})},`news-${s.id}-${n}`))}),e.jsx(z,{page:l,totalPages:$,onPageChange:T})]}):o?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"No news found"})}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"Search for news"})})})})]})}export{B as default};
