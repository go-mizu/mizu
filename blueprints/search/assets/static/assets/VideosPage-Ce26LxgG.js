import{j as e}from"./markdown-DRpjVqyA.js";import{u as de,a as me,r,L as q}from"./react-vendor-DqWpB-k-.js";import{s as B,S as he}from"./index-B26HZ0p4.js";import{u as fe}from"./useInfiniteScroll-UVndtYbB.js";import{S as xe,I as be,V as z,N as pe,L as ge,G as je,X as K,P as G,A as we,C as ye,c as Q,d as Ne,e as ve,a as ke,b as Se,E as H}from"./ui-BpHN6Zo2.js";function Pe(s){if(!s)return null;try{const a=new URL(s);return a.hostname.includes("youtube.com")||a.hostname.includes("youtube-nocookie.com")?(a.searchParams.set("autoplay","1"),a.searchParams.set("mute","1"),a.searchParams.set("controls","0"),a.searchParams.set("modestbranding","1"),a.searchParams.set("rel","0"),a.toString()):a.hostname.includes("vimeo.com")||a.hostname.includes("player.vimeo.com")?(a.searchParams.set("autoplay","1"),a.searchParams.set("muted","1"),a.searchParams.set("controls","0"),a.searchParams.set("background","1"),a.toString()):a.hostname.includes("dailymotion.com")?(a.searchParams.set("autoplay","1"),a.searchParams.set("mute","1"),a.searchParams.set("controls","0"),a.toString()):(a.searchParams.set("autoplay","1"),a.searchParams.set("mute","1"),a.toString())}catch{return null}}function W({video:s,isVisible:a,onMuteToggle:c,isMuted:n=!0}){const[l,m]=r.useState(!1),[u,f]=r.useState(!1),d=r.useRef(null),x=r.useRef(null),i=Pe(s.embed_url),p=!!i;if(r.useEffect(()=>(a&&p?d.current=setTimeout(()=>{m(!0)},400):(d.current&&(clearTimeout(d.current),d.current=null),m(!1),f(!1)),()=>{d.current&&clearTimeout(d.current)}),[a,p]),!p||!l)return null;const g=i&&(()=>{try{const h=new URL(i);return h.hostname.includes("youtube")?h.searchParams.set("mute",n?"1":"0"):h.hostname.includes("vimeo")?h.searchParams.set("muted",n?"1":"0"):h.hostname.includes("dailymotion")&&h.searchParams.set("mute",n?"1":"0"),h.toString()}catch{return i}})();return e.jsxs("div",{className:"absolute inset-0 z-10",children:[!u&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:e.jsx("div",{className:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"})}),e.jsx("iframe",{ref:x,src:g||void 0,className:`w-full h-full ${u?"opacity-100":"opacity-0"}`,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",title:`Preview: ${s.title}`,onLoad:()=>f(!0)}),u&&c&&e.jsx("button",{type:"button",onClick:h=>{h.stopPropagation(),c(!n)},className:"absolute bottom-2 left-2 p-1.5 bg-black/70 hover:bg-black/90 rounded-full text-white transition-colors z-20","aria-label":n?"Unmute":"Mute",children:n?e.jsx(Ne,{size:16}):e.jsx(ve,{size:16})})]})}const Ce=[{value:"",label:"Any duration"},{value:"short",label:"Short (< 4 min)"},{value:"medium",label:"Medium (4-20 min)"},{value:"long",label:"Long (> 20 min)"}],_e=[{value:"",label:"Any time"},{value:"hour",label:"Past hour"},{value:"day",label:"Past 24 hours"},{value:"week",label:"Past week"},{value:"month",label:"Past month"},{value:"year",label:"Past year"}],ze=[{value:"",label:"All sources"},{value:"youtube",label:"YouTube"},{value:"vimeo",label:"Vimeo"},{value:"dailymotion",label:"Dailymotion"},{value:"google_videos",label:"Google"},{value:"bing_videos",label:"Bing"},{value:"peertube",label:"PeerTube"}],Te=[{value:"",label:"Any quality"},{value:"hd",label:"HD"}];function Y(s){if(!s)return"";const a=Math.floor(s/60),c=s%60;if(a>=60){const n=Math.floor(a/60),l=a%60;return`${n}:${l.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`}return`${a}:${c.toString().padStart(2,"0")}`}function L(s){return s?s>=1e6?`${(s/1e6).toFixed(1)}M views`:s>=1e3?`${(s/1e3).toFixed(1)}K views`:`${s} views`:""}function A(s){if(!s)return"";const a=new Date(s),n=new Date().getTime()-a.getTime(),l=Math.floor(n/(1e3*60*60*24));return l<1?"Today":l<7?`${l} day${l>1?"s":""} ago`:l<30?`${Math.floor(l/7)} week${Math.floor(l/7)>1?"s":""} ago`:l<365?`${Math.floor(l/30)} month${Math.floor(l/30)>1?"s":""} ago`:`${Math.floor(l/365)} year${Math.floor(l/365)>1?"s":""} ago`}function _({label:s,value:a,options:c,onChange:n,isActive:l}){const[m,u]=r.useState(!1),f=r.useRef(null);r.useEffect(()=>{const i=p=>{f.current&&!f.current.contains(p.target)&&u(!1)};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]);const d=c.find(i=>i.value===a),x=l&&d?d.label:s;return e.jsxs("div",{className:"relative flex-shrink-0",ref:f,children:[e.jsxs("button",{type:"button",onClick:()=>u(!m),className:`
          flex items-center gap-1 px-3 py-1.5 text-sm rounded-full border transition-colors whitespace-nowrap
          ${l?"bg-[#e8f0fe] border-[#e8f0fe] text-[#1a73e8]":"bg-white border-[#dadce0] text-[#3c4043] hover:bg-[#f1f3f4]"}
        `,children:[x,e.jsx(ye,{size:14,className:`transition-transform ${m?"rotate-180":""}`})]}),m&&e.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white rounded-lg shadow-lg border border-[#e8eaed] py-1 z-50 min-w-[160px]",children:c.map(i=>e.jsxs("button",{type:"button",onClick:()=>{n(i.value),u(!1)},className:`
                w-full flex items-center gap-2 px-3 py-2 text-sm text-left transition-colors
                ${i.value===a?"bg-[#e8f0fe] text-[#1a73e8]":"text-[#3c4043] hover:bg-[#f1f3f4]"}
              `,children:[i.value===a&&e.jsx(Q,{size:14}),e.jsx("span",{className:i.value===a?"":"ml-[22px]",children:i.label})]},i.value))})]})}function $e({label:s,isActive:a,onToggle:c}){return e.jsxs("button",{type:"button",onClick:c,className:`
        flex items-center gap-1 px-3 py-1.5 text-sm rounded-full border transition-colors whitespace-nowrap flex-shrink-0
        ${a?"bg-[#e8f0fe] border-[#e8f0fe] text-[#1a73e8]":"bg-white border-[#dadce0] text-[#3c4043] hover:bg-[#f1f3f4]"}
      `,children:[a&&e.jsx(Q,{size:14}),s]})}function Ee(s){if(s.source_domain){const a=s.source_domain.replace(/^www\./,"");return a.includes("youtube")?"YouTube":a.includes("vimeo")?"Vimeo":a.includes("dailymotion")?"Dailymotion":a.includes("twitch")?"Twitch":a.includes("peertube")?"PeerTube":a}return s.engine?s.engine.charAt(0).toUpperCase()+s.engine.slice(1):"source"}function Le({video:s,onClose:a,onPrevious:c,onNext:n,hasPrevious:l,hasNext:m}){const u=r.useRef(null);r.useEffect(()=>{const x=i=>{i.key==="Escape"?a():i.key==="ArrowLeft"&&l?c():i.key==="ArrowRight"&&m&&n()};return document.addEventListener("keydown",x),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",x),document.body.style.overflow=""}},[a,c,n,l,m]);const f=x=>{x.target===u.current&&a()},d=Ee(s);return e.jsxs("div",{ref:u,onClick:f,className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80",children:[e.jsx("button",{type:"button",onClick:a,className:"absolute top-4 right-4 p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10","aria-label":"Close",children:e.jsx(K,{size:28})}),l&&e.jsx("button",{type:"button",onClick:c,className:"absolute left-4 top-1/2 -translate-y-1/2 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10","aria-label":"Previous video",children:e.jsx(ke,{size:36})}),m&&e.jsx("button",{type:"button",onClick:n,className:"absolute right-4 top-1/2 -translate-y-1/2 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10","aria-label":"Next video",children:e.jsx(Se,{size:36})}),e.jsxs("div",{className:"w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto rounded-lg",children:[e.jsx("div",{className:"bg-black",children:s.embed_url?e.jsx("div",{className:"relative w-full",style:{paddingBottom:"56.25%"},children:e.jsx("iframe",{src:s.embed_url,className:"absolute inset-0 w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,title:s.title})}):e.jsx("div",{className:"relative w-full",style:{paddingBottom:"56.25%"},children:e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-[#1a1a1a]",children:[s.thumbnail_url&&e.jsx("img",{src:s.thumbnail_url,alt:s.title,className:"absolute inset-0 w-full h-full object-cover opacity-30"}),e.jsxs("div",{className:"relative z-10 text-center p-8",children:[e.jsx(z,{size:64,className:"text-white/50 mx-auto mb-4"}),e.jsx("p",{className:"text-white/70 mb-4",children:"This video cannot be embedded"}),e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-6 py-3 bg-[#1a73e8] text-white rounded-full hover:bg-[#1557b0] transition-colors",children:[e.jsx(H,{size:18}),"Watch on ",d]})]})]})})}),e.jsxs("div",{className:"bg-white p-6",children:[e.jsx("h2",{className:"text-xl font-medium text-[#202124] leading-snug",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 text-sm text-[#5f6368]",children:[s.channel&&e.jsx("span",{className:"font-medium text-[#202124]",children:s.channel}),s.channel&&(s.views||s.published_at)&&e.jsx("span",{className:"text-[#70757a]",children:"-"}),s.views&&e.jsx("span",{children:L(s.views)}),s.views&&s.published_at&&e.jsx("span",{className:"text-[#70757a]",children:"-"}),s.published_at&&e.jsx("span",{children:A(s.published_at)})]}),s.description&&e.jsx("p",{className:"mt-4 text-sm text-[#4d5156] leading-relaxed",children:s.description}),e.jsx("div",{className:"mt-4 pt-4 border-t border-[#e8eaed]",children:e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 text-sm text-[#1a73e8] hover:underline",children:[e.jsx(H,{size:14}),"Open on ",d]})})]})]})]})}function Re(){const[s,a]=de(),c=me(),n=s.get("q")||"",[l,m]=r.useState([]),[u,f]=r.useState(!1),[d,x]=r.useState(null),[i,p]=r.useState(1),[g,h]=r.useState(()=>localStorage.getItem("videos_view_mode")||"list"),[j,I]=r.useState(""),[w,M]=r.useState(""),[y,F]=r.useState(""),[N,V]=r.useState(""),[v,R]=r.useState(!1),[O,X]=r.useState(null),[k,J]=r.useState(null),[U,T]=r.useState(!0),[S,P]=r.useState(null),[Z,ee]=r.useState(!1),te=r.useRef(null),C=r.useCallback(t=>{X(t),J(t),t!==k&&T(!0)},[k]),D=30,$=r.useCallback(()=>{const t={per_page:D};return j&&(t.duration=j),w&&(t.time=w),y&&(t.source=y),N&&(t.quality=N),v&&(t.cc=!0),t},[j,w,y,N,v]),se=j||w||y||N||v,ae=()=>{I(""),M(""),F(""),V(""),R(!1)};r.useEffect(()=>{localStorage.setItem("videos_view_mode",g)},[g]);const le=r.useCallback(async()=>{if(!n||u)return;const t=i+1;try{const o=$();o.page=t;const b=await B.searchVideos(n,o);b.results.length===0?E(!1):(m(ue=>[...ue,...b.results]),p(t))}catch{E(!1)}},[n,i,u,$]),{isLoading:re,hasMore:ne,setHasMore:E,reset:ie}=fe(le,{threshold:300,enabled:l.length>0&&!u});r.useEffect(()=>{if(!n){m([]);return}(async()=>{f(!0),x(null),ie(),p(1);try{const o=$(),b=await B.searchVideos(n,o);m(b.results||[]),E((b.results?.length||0)>=D)}catch(o){x(o instanceof Error?o.message:"Search failed")}finally{f(!1)}})()},[n,j,w,y,N,v]),r.useEffect(()=>{const t=()=>{ee(window.scrollY>500)};return window.addEventListener("scroll",t,{passive:!0}),()=>window.removeEventListener("scroll",t)},[]);const oe=t=>{a({q:t})},ce=()=>{window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsxs("header",{className:"sticky top-0 bg-white z-40 border-b border-[#e8eaed]",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(q,{to:"/",children:e.jsx("span",{className:"text-3xl font-bold",style:{background:"linear-gradient(90deg, #4285F4, #EA4335, #FBBC05, #34A853)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Search"})}),e.jsx("div",{className:"flex-1 max-w-xl",children:e.jsx(he,{initialValue:n,size:"sm",onSearch:oe})}),e.jsx(q,{to:"/settings",className:"p-2 text-[#5f6368] hover:bg-[#f1f3f4] rounded-full transition-colors",children:e.jsx(xe,{size:20})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"search-tabs",style:{paddingLeft:0},children:[e.jsx("button",{type:"button",className:"search-tab",onClick:()=>c(`/search?q=${encodeURIComponent(n)}`),children:"All"}),e.jsxs("button",{type:"button",className:"search-tab",onClick:()=>c(`/images?q=${encodeURIComponent(n)}`),children:[e.jsx(be,{size:16}),"Images"]}),e.jsxs("button",{type:"button",className:"search-tab active",children:[e.jsx(z,{size:16}),"Videos"]}),e.jsxs("button",{type:"button",className:"search-tab",onClick:()=>c(`/news?q=${encodeURIComponent(n)}`),children:[e.jsx(pe,{size:16}),"News"]})]}),e.jsxs("div",{className:"flex items-center border border-[#dadce0] rounded-full overflow-hidden",children:[e.jsx("button",{type:"button",onClick:()=>h("list"),className:`p-2 transition-colors ${g==="list"?"bg-[#e8f0fe] text-[#1a73e8]":"text-[#5f6368] hover:bg-[#f1f3f4]"}`,title:"List view",children:e.jsx(ge,{size:18})}),e.jsx("button",{type:"button",onClick:()=>h("grid"),className:`p-2 transition-colors ${g==="grid"?"bg-[#e8f0fe] text-[#1a73e8]":"text-[#5f6368] hover:bg-[#f1f3f4]"}`,title:"Grid view",children:e.jsx(je,{size:18})})]})]})]}),e.jsx("div",{className:"border-t border-[#e8eaed] bg-[#f8f9fa]",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-2",children:e.jsxs("div",{ref:te,className:"flex items-center gap-2 overflow-x-auto scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[e.jsx(_,{label:"Any duration",value:j,options:Ce,onChange:I,isActive:!!j}),e.jsx(_,{label:"Any time",value:w,options:_e,onChange:M,isActive:!!w}),e.jsx(_,{label:"All sources",value:y,options:ze,onChange:F,isActive:!!y}),e.jsx(_,{label:"Any quality",value:N,options:Te,onChange:V,isActive:!!N}),e.jsx($e,{label:"CC",isActive:v,onToggle:()=>R(!v)}),se&&e.jsxs("button",{type:"button",onClick:ae,className:"flex items-center gap-1 px-3 py-1.5 text-sm text-[#1a73e8] hover:bg-[#e8f0fe] rounded-full transition-colors whitespace-nowrap flex-shrink-0",children:[e.jsx(K,{size:14}),"Clear all"]})]})})})]}),e.jsx("main",{children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:u&&l.length===0?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}):d?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-red-600",children:d})}):l.length>0?e.jsxs(e.Fragment,{children:[g==="list"?e.jsx("div",{className:"space-y-6",children:l.map((t,o)=>e.jsxs("button",{type:"button",onClick:()=>P(o),className:"flex gap-4 p-3 rounded-lg hover:bg-[#f8f9fa] transition-colors w-full text-left cursor-pointer",onMouseEnter:()=>C(o),onMouseLeave:()=>C(null),children:[e.jsxs("div",{className:"relative flex-shrink-0 w-80 h-44 bg-[#f1f3f4] rounded-lg overflow-hidden",children:[t.thumbnail_url?e.jsx("img",{src:t.thumbnail_url,alt:t.title,className:"w-full h-full object-cover",onError:b=>{b.currentTarget.style.display="none"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(z,{size:48,className:"text-[#9aa0a6]"})}),e.jsx(W,{video:t,isVisible:k===o,isMuted:U,onMuteToggle:T}),O===o&&!t.embed_url&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 transition-opacity",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-black/70 flex items-center justify-center",children:e.jsx(G,{size:28,className:"text-white ml-1",fill:"white"})})}),(t.duration||t.duration_seconds)&&k!==o&&e.jsx("span",{className:"absolute bottom-2 right-2 bg-black/80 text-white text-xs px-1.5 py-0.5 rounded",children:t.duration||Y(t.duration_seconds)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-[#1a0dab] text-lg font-medium line-clamp-2 hover:underline",children:t.title}),e.jsxs("div",{className:"text-sm text-[#70757a] mt-2 flex items-center gap-2",children:[e.jsx("span",{children:t.channel||t.source_domain||t.engine}),t.views&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsx("span",{children:L(t.views)})]}),t.published_at&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsx("span",{children:A(t.published_at)})]})]}),t.description&&e.jsx("p",{className:"text-sm text-[#4d5156] mt-3 line-clamp-2",children:t.description})]})]},`${t.id}-${o}`))}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:l.map((t,o)=>e.jsxs("button",{type:"button",onClick:()=>P(o),className:"block rounded-lg overflow-hidden hover:shadow-lg transition-shadow bg-white border border-[#e8eaed] text-left cursor-pointer",onMouseEnter:()=>C(o),onMouseLeave:()=>C(null),children:[e.jsxs("div",{className:"relative aspect-video bg-[#f1f3f4]",children:[t.thumbnail_url?e.jsx("img",{src:t.thumbnail_url,alt:t.title,className:"w-full h-full object-cover",onError:b=>{b.currentTarget.style.display="none"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(z,{size:48,className:"text-[#9aa0a6]"})}),e.jsx(W,{video:t,isVisible:k===o,isMuted:U,onMuteToggle:T}),O===o&&!t.embed_url&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 transition-opacity",children:e.jsx("div",{className:"w-14 h-14 rounded-full bg-black/70 flex items-center justify-center",children:e.jsx(G,{size:24,className:"text-white ml-0.5",fill:"white"})})}),(t.duration||t.duration_seconds)&&k!==o&&e.jsx("span",{className:"absolute bottom-2 right-2 bg-black/80 text-white text-xs px-1.5 py-0.5 rounded",children:t.duration||Y(t.duration_seconds)})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-[#202124] text-sm font-medium line-clamp-2",children:t.title}),e.jsxs("div",{className:"text-xs text-[#70757a] mt-2",children:[e.jsx("p",{children:t.channel||t.source_domain||t.engine}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[t.views&&e.jsx("span",{children:L(t.views)}),t.views&&t.published_at&&e.jsx("span",{children:"-"}),t.published_at&&e.jsx("span",{children:A(t.published_at)})]})]})]})]},`${t.id}-${o}`))}),re&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"w-6 h-6 border-3 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}),!ne&&l.length>0&&e.jsx("div",{className:"text-center py-8 text-[#70757a]",children:"No more videos"})]}):n?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"No videos found"})}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"Search for videos"})})})}),Z&&e.jsx("button",{type:"button",onClick:ce,className:"fixed bottom-6 right-6 p-3 bg-[#1a73e8] text-white rounded-full shadow-lg hover:bg-[#1557b0] transition-colors z-40",children:e.jsx(we,{size:20})}),S!==null&&l[S]&&e.jsx(Le,{video:l[S],onClose:()=>P(null),onPrevious:()=>P(t=>t!==null&&t>0?t-1:t),onNext:()=>P(t=>t!==null&&t<l.length-1?t+1:t),hasPrevious:S>0,hasNext:S<l.length-1}),e.jsx("style",{children:`
        .scrollbar-hide::-webkit-scrollbar {
          display: none;
        }
      `})]})}export{Re as default};
