import{j as e}from"./markdown-DRpjVqyA.js";import{u as P,r as c}from"./react-vendor-DqWpB-k-.js";import{S as R}from"./SearchHeader-Dzvknhqw.js";import{P as M}from"./Pagination-Cxloy67N.js";import{s as D}from"./index-cRIhjQq6.js";import{N as f,a as L,b as F,f as U,U as q}from"./ui-DxqIiTN1.js";const w=20;function v(a){const r=new Date(a);if(isNaN(r.getTime()))return"";const o=new Date,l=o.getTime()-r.getTime(),d=Math.floor(l/(1e3*60)),m=Math.floor(l/(1e3*60*60)),i=Math.floor(l/(1e3*60*60*24));return d<1?"Just now":d<60?`${d}m ago`:m<24?`${m}h ago`:i<7?`${i}d ago`:i<30?`${Math.floor(i/7)}w ago`:r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:r.getFullYear()!==o.getFullYear()?"numeric":void 0})}function y(a){const r=new Date(a);return isNaN(r.getTime())?!1:Date.now()-r.getTime()<36e5}function S(a,r){if(!a&&!r)return"";try{return`https://www.google.com/s2/favicons?domain=${new URL(r).hostname}&sz=32`}catch{return a?`https://www.google.com/s2/favicons?domain=${a}&sz=32`:""}}function T(a){return a?a.charAt(0).toUpperCase():"?"}function J(){const[a,r]=P(),o=a.get("q")||"",l=parseInt(a.get("page")||"1",10),[d,m]=c.useState([]),[i,h]=c.useState([]),[_,g]=c.useState(!1),[j,N]=c.useState(null),[z,E]=c.useState(0),u=c.useRef(null);c.useEffect(()=>{if(!o){m([]),h([]);return}(async()=>{g(!0),N(null);try{const n=await D.searchNews(o,{page:l,per_page:w}),t=n.results||[];l===1&&t.length>5?(h(t.slice(0,5)),m(t.slice(5))):(h([]),m(t)),E(n.total_results||t.length*10)}catch(n){N(n instanceof Error?n.message:"Search failed")}finally{g(!1)}})()},[o,l]);const $=s=>{r({q:s})},k=s=>{r({q:o,page:String(s)}),window.scrollTo({top:0,behavior:"smooth"})},b=s=>{if(u.current){const n=s==="left"?-400:400;u.current.scrollBy({left:n,behavior:"smooth"})}},C=Math.ceil(z/w);return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(R,{query:o,activeTab:"news",onSearch:$}),e.jsx("main",{children:e.jsx("div",{className:"max-w-5xl mx-auto px-4 py-4",children:_?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-[3px] border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}):j?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-red-600",children:j})}):d.length>0||i.length>0?e.jsxs(e.Fragment,{children:[i.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-base font-medium text-[#202124] mb-3 flex items-center gap-2",children:[e.jsx(f,{size:18,className:"text-[#1a73e8]"}),"Top Stories"]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",onClick:()=>b("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-3 z-10 w-8 h-8 bg-white rounded-full shadow-md flex items-center justify-center text-[#5f6368] hover:text-[#202124] transition-colors border border-[#dadce0]",children:e.jsx(L,{size:18})}),e.jsx("button",{type:"button",onClick:()=>b("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-3 z-10 w-8 h-8 bg-white rounded-full shadow-md flex items-center justify-center text-[#5f6368] hover:text-[#202124] transition-colors border border-[#dadce0]",children:e.jsx(F,{size:18})}),e.jsx("div",{ref:u,className:"flex gap-3 overflow-x-auto scroll-smooth pb-1",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:i.map((s,n)=>e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex-shrink-0 w-[260px] bg-white rounded-lg border border-[#dadce0] overflow-hidden hover:shadow-md transition-shadow group",children:[s.image_url||s.thumbnail_url?e.jsx("div",{className:"h-[140px] bg-[#f8f9fa] overflow-hidden",children:e.jsx("img",{src:s.image_url||s.thumbnail_url,alt:"",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy",onError:t=>{t.currentTarget.parentElement.style.display="none"}})}):e.jsx("div",{className:"h-[140px] bg-gradient-to-br from-[#e8f0fe] to-[#f8f9fa] flex items-center justify-center",children:e.jsx(f,{size:32,className:"text-[#dadce0]"})}),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[e.jsx("img",{src:S(s.source,s.url),alt:"",className:"w-4 h-4 rounded-sm",loading:"lazy",onError:t=>{t.currentTarget.style.display="none";const x=t.currentTarget.parentElement;if(x){const p=document.createElement("span");p.className="w-4 h-4 rounded-sm bg-[#e8eaed] flex items-center justify-center text-[8px] font-bold text-[#5f6368]",p.textContent=T(s.source),x.insertBefore(p,x.firstChild)}}}),e.jsx("span",{className:"text-xs text-[#70757a] truncate",children:s.source||s.source_domain})]}),e.jsx("h3",{className:"text-[13px] font-medium text-[#202124] line-clamp-2 leading-tight",children:s.title}),e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-[11px] text-[#70757a]",children:[e.jsx(U,{size:10}),e.jsx("span",{className:y(s.published_at)?"text-[#1a73e8] font-medium":"",children:v(s.published_at)})]})]})]},`top-${s.id}-${n}`))})]})]}),e.jsx("div",{className:"space-y-0 divide-y divide-[#e8eaed]",children:d.map((s,n)=>e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex gap-4 py-5 group",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-2 text-xs",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-[#f1f3f4] flex items-center justify-center overflow-hidden flex-shrink-0",children:e.jsx("img",{src:S(s.source,s.url),alt:"",className:"w-4 h-4",loading:"lazy",onError:t=>{t.currentTarget.style.display="none";const x=t.currentTarget.parentElement;x&&(x.innerHTML=`<span class="text-[10px] font-bold text-[#5f6368]">${T(s.source)}</span>`)}})}),e.jsx("span",{className:"font-medium text-[#202124] truncate",children:s.source||s.source_domain}),s.author&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-[#bdc1c6]",children:"/"}),e.jsxs("span",{className:"text-[#5f6368] truncate flex items-center gap-0.5",children:[e.jsx(q,{size:10,className:"flex-shrink-0"}),s.author]})]}),e.jsx("span",{className:"text-[#bdc1c6]",children:"Â·"}),e.jsx("span",{className:`flex-shrink-0 ${y(s.published_at)?"text-[#1a73e8] font-medium":"text-[#70757a]"}`,children:v(s.published_at)})]}),e.jsx("h3",{className:"text-base font-medium text-[#202124] line-clamp-2 leading-snug group-hover:text-[#1a73e8] transition-colors",children:s.title}),s.snippet&&e.jsx("p",{className:"text-sm text-[#4d5156] mt-1.5 line-clamp-2 leading-relaxed",children:s.snippet})]}),(s.image_url||s.thumbnail_url)&&e.jsx("div",{className:"flex-shrink-0 w-[120px] h-[120px] rounded-lg overflow-hidden bg-[#f8f9fa] self-center",children:e.jsx("img",{src:s.image_url||s.thumbnail_url,alt:"",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy",onError:t=>{t.currentTarget.parentElement.style.display="none"}})})]},`news-${s.id}-${n}`))}),e.jsx(M,{page:l,totalPages:C,onPageChange:k})]}):o?e.jsxs("div",{className:"py-16 text-center",children:[e.jsx(f,{size:48,className:"mx-auto text-[#dadce0] mb-4"}),e.jsx("p",{className:"text-[#5f6368] text-lg",children:"No news articles found"}),e.jsx("p",{className:"text-[#70757a] text-sm mt-1",children:"Try a different search term"})]}):e.jsxs("div",{className:"py-16 text-center",children:[e.jsx(f,{size:48,className:"mx-auto text-[#dadce0] mb-4"}),e.jsx("p",{className:"text-[#5f6368] text-lg",children:"Search for news"})]})})})]})}export{J as default};
