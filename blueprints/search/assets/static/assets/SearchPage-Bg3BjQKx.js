import{j as e}from"./markdown-DRpjVqyA.js";import{r as o,u as H,a as G,L as D}from"./react-vendor-DqWpB-k-.js";import{u as F,s as M,b as W,a as K,S as Y}from"./index-Dj7lXUE2.js";import{f as J,z as X,B as Z,J as ee,K as se,c as te,O as ae,Q as ne,W as re,Y as V,E as O,g as P,_ as Q,C as U,R as le,t as ie,e as $,S as ce,I as oe,V as de,N as me}from"./ui-yxNLaUKB.js";import{A as xe,a as ue}from"./AIResponse-DTMH8kDk.js";function he({result:s}){const{settings:a}=F(),[d,r]=o.useState(!1),i=o.useRef(null);o.useEffect(()=>{const t=u=>{i.current&&!i.current.contains(u.target)&&r(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const c=async t=>{try{await M.setPreference(s.domain,t),r(!1)}catch(u){console.error("Failed to set preference:",u)}},m=(()=>{try{const t=new URL(s.url),u=t.pathname.split("/").filter(Boolean);return{domain:t.hostname,path:u.slice(0,2).join(" › ")}}catch{return{domain:s.url,path:""}}})();return e.jsxs("div",{className:"search-result group",children:[e.jsxs("div",{className:"search-result-url",children:[s.favicon&&e.jsx("img",{src:s.favicon,alt:"",onError:t=>{t.target.style.display="none"}}),e.jsx("span",{children:m.domain}),m.path&&e.jsxs("span",{className:"search-result-breadcrumb",children:["› ",m.path]}),e.jsxs("div",{className:"relative ml-auto",ref:i,children:[e.jsx("button",{type:"button",onClick:()=>r(!d),className:"opacity-0 group-hover:opacity-100 p-1 text-[#70757a] hover:bg-[#f1f3f4] rounded-full transition-opacity",children:e.jsx(J,{size:16})}),d&&e.jsxs("div",{className:"dropdown-menu",children:[e.jsxs("button",{type:"button",className:"dropdown-item",onClick:()=>c("upvote"),children:[e.jsx(X,{size:16}),"Boost ",s.domain]}),e.jsxs("button",{type:"button",className:"dropdown-item",onClick:()=>c("downvote"),children:[e.jsx(Z,{size:16}),"Lower ",s.domain]}),e.jsx("div",{className:"dropdown-divider"}),e.jsxs("button",{type:"button",className:"dropdown-item danger",onClick:()=>c("block"),children:[e.jsx(ee,{size:16}),"Block ",s.domain]})]})]})]}),e.jsx("a",{href:s.url,target:a.open_in_new_tab?"_blank":"_self",rel:"noopener noreferrer",className:"search-result-title",children:s.title}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("p",{className:"search-result-snippet flex-1",dangerouslySetInnerHTML:{__html:s.snippet}}),s.thumbnail?.url&&a.show_thumbnails&&e.jsx("a",{href:s.url,target:a.open_in_new_tab?"_blank":"_self",rel:"noopener noreferrer",className:"flex-shrink-0",children:e.jsx("img",{src:s.thumbnail.url,alt:"",className:"w-24 h-16 object-cover rounded border border-[#dadce0]",onError:t=>{t.target.style.display="none"}})})]}),s.published&&e.jsx("p",{className:"text-xs text-[#70757a] mt-1",children:new Date(s.published).toLocaleDateString()}),(s.sitelinks?.length??0)>0&&e.jsx("div",{className:"flex flex-wrap gap-x-4 gap-y-1 mt-2",children:(s.sitelinks||[]).map(t=>e.jsx("a",{href:t.url,target:a.open_in_new_tab?"_blank":"_self",rel:"noopener noreferrer",className:"text-sm text-[#1a0dab] hover:underline",children:t.title},t.url))})]})}const pe={calculator:V,currency:re,weather:ne,definition:ae,time:te,unit:se};function fe({answer:s}){const a=pe[s.type]||V;return e.jsxs("div",{className:"bg-white border border-[#dadce0] rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(a,{size:20,className:"text-[#1a73e8]"}),e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium text-[#1a73e8] bg-[#e8f0fe] rounded",children:s.type?s.type.charAt(0).toUpperCase()+s.type.slice(1):"Answer"})]}),e.jsx("div",{className:"text-3xl font-semibold text-[#202124]",children:s.result}),s.type==="calculator"&&e.jsxs("p",{className:"text-sm text-[#70757a] mt-1",children:[s.query," ="]}),s.type==="weather"&&s.data?e.jsx(je,{data:s.data}):null,s.type==="definition"&&s.data?e.jsx(ge,{data:s.data}):null,s.type==="time"&&s.data?e.jsx(be,{data:s.data}):null,s.type==="currency"&&s.data?e.jsx(Ne,{data:s.data}):null,s.type==="unit"&&s.data?e.jsx(ve,{data:s.data}):null]})}function je({data:s}){return e.jsxs("div",{className:"flex gap-8 mt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-[#70757a]",children:"Humidity"}),e.jsxs("p",{className:"text-sm text-[#202124]",children:[s.humidity,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-[#70757a]",children:"Wind"}),e.jsxs("p",{className:"text-sm text-[#202124]",children:[s.wind_speed," ",s.wind_unit]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-[#70757a]",children:"Condition"}),e.jsx("p",{className:"text-sm text-[#202124]",children:s.condition})]})]})}function ge({data:s}){return e.jsxs("div",{className:"mt-3",children:[s.phonetic&&e.jsx("p",{className:"text-sm text-[#70757a] italic",children:s.phonetic}),e.jsx("p",{className:"text-sm text-[#70757a] mt-1",children:s.part_of_speech}),(s.definitions?.length??0)>1&&e.jsxs("p",{className:"text-sm text-[#70757a] mt-1",children:["2. ",s.definitions?.[1]]}),(s.synonyms?.length??0)>0&&e.jsxs("p",{className:"text-xs text-[#70757a] mt-2",children:["Synonyms: ",(s.synonyms||[]).join(", ")]})]})}function be({data:s}){return e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-[#70757a]",children:s.date}),e.jsxs("p",{className:"text-xs text-[#70757a]",children:[s.timezone," (",s.offset,")"]})]})}function Ne({data:s}){const a=typeof s.rate=="number"?s.rate.toFixed(4):s.rate??"—";return e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-sm text-[#70757a]",children:["1 ",s.from_currency," = ",a," ",s.to_currency]}),e.jsxs("p",{className:"text-xs text-[#70757a]",children:["Rate as of ",new Date(s.updated_at).toLocaleDateString()]})]})}function ve({data:s}){const a=typeof s.to_value=="number"?s.to_value.toFixed(4):s.to_value??"—";return e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-sm text-[#70757a]",children:[s.from_value," ",s.from_unit," = ",a," ",s.to_unit]}),e.jsx("p",{className:"text-xs text-[#70757a] capitalize",children:s.category})]})}function ye({panel:s}){return e.jsxs("div",{className:"knowledge-panel",children:[s.image&&e.jsx("img",{src:s.image,alt:s.title,className:"knowledge-panel-image",onError:a=>{a.target.style.display="none"}}),e.jsxs("div",{className:"knowledge-panel-content",children:[e.jsx("h2",{className:"knowledge-panel-title",children:s.title}),s.subtitle&&e.jsx("p",{className:"knowledge-panel-subtitle",children:s.subtitle.charAt(0).toUpperCase()+s.subtitle.slice(1).replace(/_/g," ")}),e.jsx("p",{className:"knowledge-panel-description",children:s.description}),(s.facts?.length??0)>0&&e.jsx("div",{className:"knowledge-panel-facts",children:(s.facts||[]).map(a=>e.jsxs("div",{className:"knowledge-panel-fact",children:[e.jsx("span",{className:"knowledge-panel-fact-label",children:a.label}),e.jsx("span",{className:"knowledge-panel-fact-value",children:a.value})]},a.label))}),(s.links?.length??0)>0&&e.jsx("div",{className:"mt-4 pt-4 border-t border-[#dadce0]",children:(s.links||[]).map(a=>e.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 py-2 text-sm text-[#1a73e8] hover:underline",children:[e.jsx(O,{size:14}),a.title]},a.url))}),s.source&&e.jsxs("p",{className:"mt-4 text-xs text-[#70757a]",children:["Source: ",s.source]})]})]})}function we({query:s,onFollowUp:a}){const{mode:d,aiAvailable:r,isLoading:i,isStreaming:c,streamingContent:m,streamingThinking:t,currentResponse:u,error:E,setLoading:R,setStreaming:z,appendStreamContent:A,addThinkingStep:I,resetStream:S,setCurrentResponse:p,setError:v}=W(),[y,j]=o.useState(!0),[L,_]=o.useState(!1),x=o.useRef(null),w=o.useRef(0),g=o.useCallback(()=>{x.current&&(x.current.abort(),x.current=null)},[]);o.useEffect(()=>()=>{g()},[g]);const b=o.useCallback(async()=>{if(!s||!r)return;g(),w.current+=1;const k=w.current,f=new AbortController;x.current=f;const h=()=>w.current!==k;S(),R(!0),v(null),p(null);try{z(!0);const C=K.queryStreamFetch({text:s,mode:d},f.signal);let q=null;for await(const N of C){if(h())break;switch(N.type){case"token":N.content&&!h()&&A(N.content);break;case"thinking":N.thinking&&!h()&&I(N.thinking);break;case"done":N.response&&!h()&&(q=N.response);break;case"error":h()||v(N.error||"An error occurred");break}}q&&!h()&&p(q)}catch(C){if(C instanceof Error&&C.name==="AbortError")return;h()||v(C instanceof Error?C.message:"Failed to get AI response")}finally{h()||(R(!1),z(!1),_(!0)),x.current===f&&(x.current=null)}},[s,d,r,g]);if(o.useEffect(()=>{s&&r&&!L&&b()},[s,r,L,b]),o.useEffect(()=>{g(),_(!1),S(),p(null)},[s,g]),!r)return null;const T=()=>{b()},n=()=>{b()},l=u||{text:m,mode:d,citations:[],follow_ups:[],session_id:"",sources_used:0,thinking_steps:t};return e.jsxs("div",{className:"ai-summary",children:[e.jsxs("div",{className:"ai-summary-header",children:[e.jsxs("button",{type:"button",onClick:()=>j(!y),className:"ai-summary-toggle",children:[e.jsx(P,{size:18,className:"ai-summary-icon"}),e.jsx("span",{className:"ai-summary-title",children:"AI Overview"}),y?e.jsx(Q,{size:16}):e.jsx(U,{size:16})]}),e.jsxs("div",{className:"ai-summary-controls",children:[e.jsx(xe,{size:"sm",onChange:n}),e.jsx("button",{type:"button",onClick:T,disabled:i||c,className:"ai-refresh-button",title:"Regenerate",children:e.jsx(le,{size:14,className:i?"animate-spin":""})})]})]}),y&&e.jsx("div",{className:"ai-summary-content",children:E?e.jsxs("div",{className:"ai-error",children:[e.jsx("p",{children:E}),e.jsx("button",{type:"button",onClick:T,children:"Try again"})]}):i&&!m?e.jsxs("div",{className:"ai-loading",children:[e.jsxs("div",{className:"ai-loading-dots",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]}),e.jsx("p",{children:"Generating AI overview..."})]}):l.text||m?e.jsx(ue,{response:l,streamingContent:c?m:void 0,streamingThinking:c?t:void 0,isStreaming:c,onFollowUp:a}):null})]})}function ke({sheet:s}){const[a,d]=o.useState(new Set([0])),r=i=>{const c=new Set(a);c.has(i)?c.delete(i):c.add(i),d(c)};return e.jsxs("div",{className:"bg-[#f8f9fa] border border-[#dadce0] rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ie,{size:18,className:"text-[#1a73e8]"}),e.jsx("h3",{className:"font-medium text-[#202124]",children:s.title})]}),s.description&&e.jsx("p",{className:"text-sm text-[#70757a] mb-3",children:s.description}),e.jsx("div",{className:"space-y-2",children:s.sections.map((i,c)=>e.jsxs("div",{className:"border border-[#e8eaed] rounded bg-white",children:[e.jsxs("button",{type:"button",onClick:()=>r(c),className:"w-full flex items-center justify-between px-3 py-2 text-sm font-medium text-[#202124] hover:bg-[#f1f3f4]",children:[e.jsx("span",{children:i.title}),a.has(c)?e.jsx(Q,{size:16,className:"text-[#70757a]"}):e.jsx(U,{size:16,className:"text-[#70757a]"})]}),a.has(c)&&e.jsx("div",{className:"px-3 pb-3 space-y-2",children:i.items.map((m,t)=>e.jsxs("div",{className:"flex gap-3 text-sm",children:[e.jsx("code",{className:"px-2 py-0.5 bg-[#f1f3f4] rounded text-[#1a73e8] font-mono text-xs flex-shrink-0",children:m.code}),e.jsx("span",{className:"text-[#5f6368]",children:m.description})]},t))})]},c))})]})}function Se({searches:s,onSearch:a}){return!s||s.length===0?null:e.jsxs("div",{className:"bg-[#f8f9fa] border border-[#dadce0] rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx($,{size:18,className:"text-[#1a73e8]"}),e.jsx("h3",{className:"font-medium text-[#202124]",children:"Related Searches"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.map((d,r)=>e.jsxs("button",{type:"button",onClick:()=>a(d),className:"flex items-center gap-2 px-3 py-2 text-sm text-left text-[#1a0dab] hover:bg-[#e8f0fe] rounded transition-colors",children:[e.jsx($,{size:14,className:"text-[#70757a] flex-shrink-0"}),e.jsx("span",{className:"truncate",children:d})]},r))})]})}const B=[{value:"",label:"Any time"},{value:"day",label:"Past 24 hours"},{value:"week",label:"Past week"},{value:"month",label:"Past month"},{value:"year",label:"Past year"}];function Ae(){const[s,a]=H(),d=G(),r=s.get("q")||"",i=parseInt(s.get("page")||"1",10),c=s.get("time")||"",[m]=o.useState("all"),[t,u]=o.useState(null),[E,R]=o.useState(!1),[z,A]=o.useState(null),[I,S]=o.useState(!1),[p,v]=o.useState(null),y=o.useRef(null),{settings:j,addRecentSearch:L}=F(),{aiAvailable:_}=W();o.useEffect(()=>{const n=l=>{y.current&&!y.current.contains(l.target)&&S(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),o.useEffect(()=>{if(!r)return;(async()=>{R(!0),A(null),v(null);try{const l=await M.search(r,{page:i,per_page:j.results_per_page,time:c,safe:j.safe_search,region:j.region,lang:j.language});if(l.redirect)if(l.redirect.startsWith("http"))v({url:l.redirect,name:l.bang?.name||"External site"}),u(null);else{d(l.redirect);return}else if(l.category){d(`/${l.category}?q=${encodeURIComponent(l.query)}`);return}else u(l);L(r)}catch(l){A(l instanceof Error?l.message:"Search failed")}finally{R(!1)}})()},[r,i,c,j]);const x=n=>{a({q:n})},w=n=>{a({q:r,page:String(n)}),window.scrollTo({top:0,behavior:"smooth"})},g=n=>{a(n?{q:r,time:n}:{q:r}),S(!1)},b=t?Math.ceil(t.total_results/j.results_per_page):0,T=B.find(n=>n.value===c)?.label||"Any time";return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("header",{className:"sticky top-0 bg-white z-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(D,{to:"/",children:e.jsx("span",{className:"text-3xl font-bold",style:{background:"linear-gradient(90deg, #4285F4, #EA4335, #FBBC05, #34A853)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Search"})}),e.jsx("div",{className:"flex-1 max-w-xl",children:e.jsx(Y,{initialValue:r,size:"sm",onSearch:x})}),_&&e.jsx(D,{to:"/ai/sessions",className:"p-2 text-[#5f6368] hover:bg-[#f1f3f4] rounded-full transition-colors",title:"AI Research Sessions",children:e.jsx(P,{size:20})}),e.jsx(D,{to:"/settings",className:"p-2 text-[#5f6368] hover:bg-[#f1f3f4] rounded-full transition-colors",children:e.jsx(ce,{size:20})})]}),e.jsxs("div",{className:"search-tabs mt-2",style:{paddingLeft:0},children:[e.jsx("button",{type:"button",className:`search-tab ${m==="all"?"active":""}`,onClick:()=>d(`/search?q=${encodeURIComponent(r)}`),children:"All"}),_&&e.jsxs("button",{type:"button",className:`search-tab ${m==="ai"?"active":""}`,onClick:()=>d(`/ai?q=${encodeURIComponent(r)}`),children:[e.jsx(P,{size:16}),"AI"]}),e.jsxs("button",{type:"button",className:`search-tab ${m==="images"?"active":""}`,onClick:()=>d(`/images?q=${encodeURIComponent(r)}`),children:[e.jsx(oe,{size:16}),"Images"]}),e.jsxs("button",{type:"button",className:`search-tab ${m==="videos"?"active":""}`,onClick:()=>d(`/videos?q=${encodeURIComponent(r)}`),children:[e.jsx(de,{size:16}),"Videos"]}),e.jsxs("button",{type:"button",className:`search-tab ${m==="news"?"active":""}`,onClick:()=>d(`/news?q=${encodeURIComponent(r)}`),children:[e.jsx(me,{size:16}),"News"]}),e.jsxs("div",{className:"time-filter ml-auto",ref:y,children:[e.jsxs("button",{type:"button",className:"time-filter-button",onClick:()=>S(!I),children:[T,e.jsx(U,{size:16})]}),I&&e.jsx("div",{className:"time-filter-dropdown",children:B.map(n=>e.jsx("button",{type:"button",className:`time-filter-option ${c===n.value?"active":""}`,onClick:()=>g(n.value),children:n.label},n.value))})]})]})]})}),e.jsx("main",{children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex gap-8",children:[e.jsx("div",{className:"flex-1 max-w-2xl",children:E?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}):p?e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"bg-[#f8f9fa] border border-[#dadce0] rounded-lg p-6 text-center",children:[e.jsx(O,{size:32,className:"mx-auto mb-4 text-[#1a73e8]"}),e.jsxs("h2",{className:"text-lg font-medium text-[#202124] mb-2",children:["Redirecting to ",p.name]}),e.jsx("p",{className:"text-sm text-[#5f6368] mb-4",children:"You're about to leave Mizu Search"}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsxs("a",{href:p.url,className:"px-4 py-2 bg-[#1a73e8] text-white rounded-lg hover:bg-[#1557b0] transition-colors",rel:"noopener noreferrer",children:["Continue to ",p.name]}),e.jsx("button",{type:"button",onClick:()=>{v(null),d("/")},className:"px-4 py-2 border border-[#dadce0] rounded-lg hover:bg-[#f1f3f4] transition-colors text-[#5f6368]",children:"Go Back"})]}),e.jsx("p",{className:"text-xs text-[#9aa0a6] mt-4 break-all",children:p.url})]})}):z?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-red-600",children:z})}):t?e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-[#70757a] mb-4",children:["About ",(t.total_results??0).toLocaleString()," results (",(t.search_time_ms??0).toFixed(2)," ms)"]}),t.corrected_query&&e.jsxs("p",{className:"text-sm mb-4",children:["Showing results for"," ",e.jsx("button",{type:"button",onClick:()=>x(t.corrected_query),className:"font-medium text-[#1a73e8] hover:underline",children:t.corrected_query})]}),_&&r&&e.jsx("div",{className:"mb-6",children:e.jsx(we,{query:r,onFollowUp:n=>x(n)})}),t.widgets?.filter(n=>n.type==="cheat_sheet").map((n,l)=>e.jsx(ke,{sheet:n.content},l)),t.instant_answer&&e.jsx("div",{className:"mb-4",children:e.jsx(fe,{answer:t.instant_answer})}),(t.results||[]).map(n=>e.jsx(he,{result:n},n.id)),(()=>{const n=t.widgets?.find(k=>k.type==="related_searches"),l=n?n.content:t.related_searches||[];return l.length>0?e.jsx(Se,{searches:l,onSearch:x}):null})(),b>1&&e.jsxs("div",{className:"pagination",children:[i>1&&e.jsx("button",{type:"button",className:"pagination-item",onClick:()=>w(i-1),children:"<"}),(()=>{let l=Math.max(1,i-Math.floor(5));const k=Math.min(b,l+10-1);return k-l+1<10&&(l=Math.max(1,k-10+1)),Array.from({length:k-l+1},(f,h)=>l+h).map(f=>e.jsx("button",{type:"button",className:`pagination-item ${i===f?"active":""}`,onClick:()=>w(f),children:f},f))})(),i<b&&e.jsx("button",{type:"button",className:"pagination-item",onClick:()=>w(i+1),children:">"})]})]}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"Enter a search query"})})}),t?.knowledge_panel&&e.jsx("div",{className:"hidden lg:block w-80",children:e.jsx(ye,{panel:t.knowledge_panel})})]})})})]})}export{Ae as default};
