import{j as e}from"./markdown-DRpjVqyA.js";import{u as D,a as G,r as l,L as S}from"./react-vendor-DqWpB-k-.js";import{s as C,S as H}from"./index-B26HZ0p4.js";import{u as W}from"./useInfiniteScroll-UVndtYbB.js";import{S as Y,I as K,V as X,N as Z,C as J,A as Q,X as ee,a as se,b as te}from"./ui-BpHN6Zo2.js";const le=[{value:"",label:"Any size"},{value:"large",label:"Large"},{value:"medium",label:"Medium"},{value:"small",label:"Small"}],ae=[{value:"",label:"Any color"},{value:"color",label:"Full color"},{value:"mono",label:"Black & white"}],ne=[{value:"",label:"Any type"},{value:"photo",label:"Photo"},{value:"clipart",label:"Clipart"},{value:"gif",label:"GIF"}];function ue(){const[E,I]=D(),u=G(),r=E.get("q")||"",[o,h]=l.useState([]),[d,b]=l.useState(!1),[f,g]=l.useState(null),[i,c]=l.useState(null),[v,j]=l.useState(1),[w,N]=l.useState(!1),[z,L]=l.useState(""),[P,T]=l.useState(""),[F,A]=l.useState(""),[_,y]=l.useState(null),[R,O]=l.useState(!1),m=l.useRef(null),x=30,B=l.useCallback(async()=>{if(!r||d)return;const s=v+1;try{const t=await C.searchImages(r,{page:s,per_page:x});t.results.length===0?p(!1):(h(n=>[...n,...t.results]),j(s))}catch{p(!1)}},[r,v,d]),{isLoading:$,hasMore:q,setHasMore:p,reset:M}=W(B,{threshold:300,enabled:o.length>0&&!d});l.useEffect(()=>{if(!r){h([]);return}(async()=>{b(!0),g(null),M(),j(1);try{const t=await C.searchImages(r,{per_page:x});h(t.results||[]),p((t.results?.length||0)>=x)}catch(t){g(t instanceof Error?t.message:"Search failed")}finally{b(!1)}})()},[r]),l.useEffect(()=>{const s=()=>{O(window.scrollY>500)};return window.addEventListener("scroll",s,{passive:!0}),()=>window.removeEventListener("scroll",s)},[]),l.useEffect(()=>{if(i===null)return;const s=t=>{switch(t.key){case"Escape":c(null);break;case"ArrowLeft":c(n=>n!==null&&n>0?n-1:n);break;case"ArrowRight":c(n=>n!==null&&n<o.length-1?n+1:n);break}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[i,o.length]),l.useEffect(()=>{const s=t=>{m.current&&!m.current.contains(t.target)&&N(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const V=s=>{I({q:s})},U=()=>{window.scrollTo({top:0,behavior:"smooth"})},a=i!==null?o[i]:null;return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("header",{className:"sticky top-0 bg-white z-40 border-b border-[#e8eaed]",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(S,{to:"/",children:e.jsx("span",{className:"text-3xl font-bold",style:{background:"linear-gradient(90deg, #4285F4, #EA4335, #FBBC05, #34A853)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Search"})}),e.jsx("div",{className:"flex-1 max-w-xl",children:e.jsx(H,{initialValue:r,size:"sm",onSearch:V})}),e.jsx(S,{to:"/settings",className:"p-2 text-[#5f6368] hover:bg-[#f1f3f4] rounded-full transition-colors",children:e.jsx(Y,{size:20})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"search-tabs",style:{paddingLeft:0},children:[e.jsx("button",{type:"button",className:"search-tab",onClick:()=>u(`/search?q=${encodeURIComponent(r)}`),children:"All"}),e.jsxs("button",{type:"button",className:"search-tab active",children:[e.jsx(K,{size:16}),"Images"]}),e.jsxs("button",{type:"button",className:"search-tab",onClick:()=>u(`/videos?q=${encodeURIComponent(r)}`),children:[e.jsx(X,{size:16}),"Videos"]}),e.jsxs("button",{type:"button",className:"search-tab",onClick:()=>u(`/news?q=${encodeURIComponent(r)}`),children:[e.jsx(Z,{size:16}),"News"]})]}),e.jsxs("div",{className:"relative",ref:m,children:[e.jsxs("button",{type:"button",className:"flex items-center gap-1 px-3 py-1.5 text-sm text-[#5f6368] hover:bg-[#f1f3f4] rounded-full transition-colors",onClick:()=>N(!w),children:["Filters",e.jsx(J,{size:16})]}),w&&e.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-[#e8eaed] p-4 z-50",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#202124] mb-2",children:"Size"}),e.jsx("select",{value:z,onChange:s=>L(s.target.value),className:"w-full px-3 py-2 border border-[#dadce0] rounded-lg text-sm focus:outline-none focus:border-[#1a73e8]",children:le.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#202124] mb-2",children:"Color"}),e.jsx("select",{value:P,onChange:s=>T(s.target.value),className:"w-full px-3 py-2 border border-[#dadce0] rounded-lg text-sm focus:outline-none focus:border-[#1a73e8]",children:ae.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#202124] mb-2",children:"Type"}),e.jsx("select",{value:F,onChange:s=>A(s.target.value),className:"w-full px-3 py-2 border border-[#dadce0] rounded-lg text-sm focus:outline-none focus:border-[#1a73e8]",children:ne.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]})})]})]})]})}),e.jsx("main",{children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:d&&o.length===0?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}):f?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-red-600",children:f})}):o.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"columns-2 sm:columns-3 md:columns-4 lg:columns-5 gap-4",children:o.map((s,t)=>e.jsx("div",{className:"break-inside-avoid mb-4 relative group cursor-pointer",onClick:()=>c(t),onMouseEnter:()=>y(t),onMouseLeave:()=>y(null),children:e.jsxs("div",{className:"relative overflow-hidden rounded-lg bg-[#f1f3f4]",children:[e.jsx("img",{src:s.thumbnail_url||s.url,alt:s.title,loading:"lazy",className:"w-full h-auto transition-transform duration-200 group-hover:scale-105",onError:n=>{const k=n.currentTarget.parentElement?.parentElement;k&&(k.style.display="none")}}),_===t&&e.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-end p-3 transition-opacity",children:e.jsxs("div",{className:"text-white",children:[e.jsx("p",{className:"text-sm font-medium line-clamp-2",children:s.title}),e.jsxs("p",{className:"text-xs opacity-80 mt-1",children:[s.source_domain,s.width&&s.height&&` • ${s.width}×${s.height}`]})]})})]})},`${s.id}-${t}`))}),$&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"w-6 h-6 border-3 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}),!q&&o.length>0&&e.jsx("div",{className:"text-center py-8 text-[#70757a]",children:"No more images"})]}):r?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"No images found"})}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"Search for images"})})})}),R&&e.jsx("button",{type:"button",onClick:U,className:"fixed bottom-6 right-6 p-3 bg-[#1a73e8] text-white rounded-full shadow-lg hover:bg-[#1557b0] transition-colors z-40",children:e.jsx(Q,{size:20})}),a&&i!==null&&e.jsxs("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center",onClick:()=>c(null),children:[e.jsx("button",{type:"button",onClick:()=>c(null),className:"absolute top-4 right-4 p-2 text-white/80 hover:text-white transition-colors",children:e.jsx(ee,{size:24})}),i>0&&e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),c(i-1)},className:"absolute left-4 p-2 text-white/80 hover:text-white transition-colors",children:e.jsx(se,{size:32})}),i<o.length-1&&e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),c(i+1)},className:"absolute right-4 p-2 text-white/80 hover:text-white transition-colors",children:e.jsx(te,{size:32})}),e.jsxs("div",{className:"max-w-[90vw] max-h-[90vh] flex flex-col",onClick:s=>s.stopPropagation(),children:[e.jsx("img",{src:a.url,alt:a.title,className:"max-h-[80vh] w-auto object-contain rounded-lg",onError:s=>{s.currentTarget.src=a.thumbnail_url||""}}),e.jsxs("div",{className:"mt-4 text-white text-center",children:[e.jsx("p",{className:"font-medium",children:a.title}),e.jsxs("div",{className:"text-sm text-white/70 mt-1 flex items-center justify-center gap-4",children:[e.jsx("span",{children:a.source_domain}),a.width&&a.height&&e.jsxs("span",{children:[a.width," × ",a.height]}),a.format&&e.jsx("span",{className:"uppercase",children:a.format})]}),e.jsx("a",{href:a.source_url,target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-3 px-4 py-2 bg-[#1a73e8] text-white rounded-full text-sm hover:bg-[#1557b0] transition-colors",children:"Visit page"})]})]}),e.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 text-white/70 text-sm",children:[i+1," / ",o.length]})]})]})}export{ue as default};
