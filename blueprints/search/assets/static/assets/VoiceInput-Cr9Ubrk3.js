import{j as e}from"./markdown-DRpjVqyA.js";import{r as n}from"./react-vendor-DqWpB-k-.js";import{b as L}from"./index-C5nRY0DN.js";import{n as y,C,c as E,Z as R,o as k,p as $,q as I,r as O,m as F}from"./ui-BUNJN1AT.js";const M={text:I,vision:$,voice:k,embeddings:R},w={fast:{label:"Fast",color:"#34a853"},balanced:{label:"Balanced",color:"#fbbc04"},thorough:{label:"Thorough",color:"#ea4335"}};function D({selectedModel:o,onSelectModel:r,requiredCapability:u,size:c="md"}){const[i,p]=n.useState([]),[m,x]=n.useState(!1),[j,d]=n.useState(!0),l=n.useRef(null);n.useEffect(()=>{async function s(){try{const t=await L.getModels();if(p(t),!o){const a=t.find(h=>h.is_default&&h.available);a&&r(a.id)}}catch(t){console.error("Failed to fetch models:",t)}finally{d(!1)}}s()},[o,r]),n.useEffect(()=>{function s(t){l.current&&!l.current.contains(t.target)&&x(!1)}return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const b=u?i.filter(s=>s.capabilities.includes(u)):i,f=i.find(s=>s.id===o);return j?e.jsx("div",{className:`model-selector ${c}`,children:e.jsx("span",{className:"model-selector-loading",children:"Loading models..."})}):e.jsxs("div",{className:`model-selector ${c}`,ref:l,children:[e.jsxs("button",{type:"button",className:"model-selector-button",onClick:()=>x(!m),"aria-expanded":m,"aria-haspopup":"listbox",children:[e.jsx("div",{className:"model-selector-current",children:f?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"model-name",children:f.name}),!f.available&&e.jsx(y,{size:14,className:"model-unavailable-icon"})]}):e.jsx("span",{className:"model-placeholder",children:"Select model"})}),e.jsx(C,{size:16,className:`model-selector-chevron ${m?"open":""}`})]}),m&&e.jsx("div",{className:"model-selector-dropdown",role:"listbox",children:b.length===0?e.jsx("div",{className:"model-selector-empty",children:"No models available"}):b.map(s=>e.jsxs("button",{type:"button",className:`model-option ${s.id===o?"selected":""} ${s.available?"":"unavailable"}`,onClick:()=>{r(s.id),x(!1)},disabled:!s.available,role:"option","aria-selected":s.id===o,children:[e.jsxs("div",{className:"model-option-info",children:[e.jsxs("div",{className:"model-option-header",children:[e.jsx("span",{className:"model-option-name",children:s.name}),s.is_default&&e.jsx("span",{className:"model-default-badge",children:"Default"}),s.id===o&&e.jsx(E,{size:14,className:"model-check"})]}),s.description&&e.jsx("span",{className:"model-option-description",children:s.description}),e.jsxs("div",{className:"model-option-meta",children:[e.jsx("span",{className:"model-speed",style:{color:w[s.speed]?.color},children:w[s.speed]?.label||s.speed}),e.jsxs("span",{className:"model-context",children:[s.context_size.toLocaleString()," ctx"]}),e.jsx("div",{className:"model-capabilities",children:s.capabilities.map(t=>{const a=M[t];return e.jsx("span",{className:"model-capability",title:t,children:e.jsx(a,{size:12})},t)})})]})]}),!s.available&&e.jsx("span",{className:"model-unavailable",children:"Offline"})]},s.id))})]})}const g=typeof window<"u"?window.SpeechRecognition||window.webkitSpeechRecognition:null;function Z({onTranscript:o,onInterimTranscript:r,disabled:u=!1,size:c="md"}){const[i,p]=n.useState(!1),[m,x]=n.useState(!1),[j,d]=n.useState(null),l=n.useRef(null);n.useEffect(()=>{x(g!==null)},[]);const b=n.useCallback(()=>{if(!g||u)return;d(null);const t=new g;t.continuous=!0,t.interimResults=!0,t.lang="en-US",t.onresult=a=>{let h="",N="";for(let v=a.resultIndex;v<a.results.length;v++){const S=a.results[v][0].transcript;a.results[v].isFinal?N+=S:h+=S}h&&r&&r(h),N&&o(N)},t.onerror=a=>{switch(a.error){case"no-speech":d("No speech detected");break;case"audio-capture":d("No microphone found");break;case"not-allowed":d("Microphone access denied");break;default:d(`Speech recognition error: ${a.error}`)}p(!1)},t.onend=()=>{p(!1)},l.current=t,t.start(),p(!0)},[u,o,r]),f=n.useCallback(()=>{l.current&&(l.current.stop(),l.current=null),p(!1)},[]),s=n.useCallback(()=>{i?f():b()},[i,b,f]);return n.useEffect(()=>()=>{l.current&&l.current.stop()},[]),m?e.jsxs("div",{className:"voice-input",children:[e.jsx("button",{type:"button",onClick:s,className:`voice-input-button ${c} ${i?"listening":""}`,disabled:u,title:i?"Stop listening":"Start voice input","aria-label":i?"Stop listening":"Start voice input",children:i?e.jsx("div",{className:"voice-input-active",children:e.jsx(F,{size:c==="sm"?16:18,className:"animate-spin"})}):e.jsx(k,{size:c==="sm"?16:18})}),j&&e.jsx("div",{className:"voice-input-error",role:"alert",children:j}),i&&e.jsxs("div",{className:"voice-input-indicator",children:[e.jsx("span",{className:"voice-input-dot"}),e.jsx("span",{className:"voice-input-label",children:"Listening..."})]})]}):e.jsx("button",{type:"button",className:`voice-input-button ${c} unsupported`,disabled:!0,title:"Voice input not supported in this browser",children:e.jsx(O,{size:c==="sm"?16:18})})}export{D as M,Z as V};
