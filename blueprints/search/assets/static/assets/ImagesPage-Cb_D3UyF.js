import{j as e}from"./markdown-DRpjVqyA.js";import{u as H,r as l}from"./react-vendor-DqWpB-k-.js";import{S as D}from"./SearchHeader-Cxz-iMHo.js";import{s as C}from"./index-CAplHHN5.js";import{u as G}from"./useInfiniteScroll-UVndtYbB.js";import{C as Y,A as K,X as U,a as V,b as X}from"./ui-DxqIiTN1.js";const Z=[{value:"",label:"Any size"},{value:"large",label:"Large"},{value:"medium",label:"Medium"},{value:"small",label:"Small"}],J=[{value:"",label:"Any color"},{value:"color",label:"Full color"},{value:"mono",label:"Black & white"}],Q=[{value:"",label:"Any type"},{value:"photo",label:"Photo"},{value:"clipart",label:"Clipart"},{value:"gif",label:"GIF"}];function re(){const[I,P]=H(),i=I.get("q")||"",[n,x]=l.useState([]),[m,g]=l.useState(!1),[v,j]=l.useState(null),[o,c]=l.useState(null),[w,N]=l.useState(1),[y,S]=l.useState(!1),[d,T]=l.useState(""),[u,z]=l.useState(""),[h,L]=l.useState(""),[F,k]=l.useState(null),[_,A]=l.useState(!1),p=l.useRef(null),f=30,O=l.useCallback(async()=>{if(!i||m)return;const s=w+1;try{const t=await C.searchImages(i,{page:s,per_page:f,...d&&{size:d},...u&&{color:u},...h&&{type:h}});t.results.length===0?b(!1):(x(r=>[...r,...t.results]),N(s))}catch{b(!1)}},[i,w,m]),{isLoading:R,hasMore:M,setHasMore:b,reset:$}=G(O,{threshold:300,enabled:n.length>0&&!m});l.useEffect(()=>{if(!i){x([]);return}(async()=>{g(!0),j(null),$(),N(1);try{const t=await C.searchImages(i,{per_page:f,...d&&{size:d},...u&&{color:u},...h&&{type:h}});x(t.results||[]),b((t.results?.length||0)>=f)}catch(t){j(t instanceof Error?t.message:"Search failed")}finally{g(!1)}})()},[i,d,u,h]),l.useEffect(()=>{const s=()=>{A(window.scrollY>500)};return window.addEventListener("scroll",s,{passive:!0}),()=>window.removeEventListener("scroll",s)},[]),l.useEffect(()=>{if(o===null)return;const s=t=>{switch(t.key){case"Escape":c(null);break;case"ArrowLeft":c(r=>r!==null&&r>0?r-1:r);break;case"ArrowRight":c(r=>r!==null&&r<n.length-1?r+1:r);break}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[o,n.length]),l.useEffect(()=>{const s=t=>{p.current&&!p.current.contains(t.target)&&S(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const q=s=>{P({q:s})},B=()=>{window.scrollTo({top:0,behavior:"smooth"})},a=o!==null?n[o]:null;return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(D,{query:i,activeTab:"images",onSearch:q,tabsRight:e.jsxs("div",{className:"relative",ref:p,children:[e.jsxs("button",{type:"button",className:"flex items-center gap-1 px-3 py-1.5 text-sm text-[#5f6368] hover:bg-[#f1f3f4] rounded-full transition-colors",onClick:()=>S(!y),children:["Filters",e.jsx(Y,{size:16})]}),y&&e.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-[#e8eaed] p-4 z-50",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#202124] mb-2",children:"Size"}),e.jsx("select",{value:d,onChange:s=>T(s.target.value),className:"w-full px-3 py-2 border border-[#dadce0] rounded-lg text-sm focus:outline-none focus:border-[#1a73e8]",children:Z.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#202124] mb-2",children:"Color"}),e.jsx("select",{value:u,onChange:s=>z(s.target.value),className:"w-full px-3 py-2 border border-[#dadce0] rounded-lg text-sm focus:outline-none focus:border-[#1a73e8]",children:J.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#202124] mb-2",children:"Type"}),e.jsx("select",{value:h,onChange:s=>L(s.target.value),className:"w-full px-3 py-2 border border-[#dadce0] rounded-lg text-sm focus:outline-none focus:border-[#1a73e8]",children:Q.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]})})]})}),e.jsx("main",{children:e.jsx("div",{className:"mx-auto px-4 py-4",children:m&&n.length===0?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}):v?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-red-600",children:v})}):n.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"columns-2 sm:columns-3 md:columns-4 lg:columns-5 gap-4",children:n.map((s,t)=>e.jsx("div",{className:"break-inside-avoid mb-4 relative group cursor-pointer",onClick:()=>c(t),onMouseEnter:()=>k(t),onMouseLeave:()=>k(null),children:e.jsxs("div",{className:"relative overflow-hidden rounded-lg bg-[#f1f3f4]",children:[e.jsx("img",{src:s.thumbnail_url||s.url,alt:s.title,loading:"lazy",className:"w-full h-auto transition-transform duration-200 group-hover:scale-105",onError:r=>{const E=r.currentTarget.parentElement?.parentElement;E&&(E.style.display="none")}}),F===t&&e.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-end p-3 transition-opacity",children:e.jsxs("div",{className:"text-white",children:[e.jsx("p",{className:"text-sm font-medium line-clamp-2",children:s.title}),e.jsxs("p",{className:"text-xs opacity-80 mt-1",children:[s.source_domain,s.width&&s.height&&` • ${s.width}×${s.height}`]})]})})]})},`${s.id}-${t}`))}),R&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"w-6 h-6 border-2 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}),!M&&n.length>0&&e.jsx("div",{className:"text-center py-8 text-[#70757a]",children:"No more images"})]}):i?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"No images found"})}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"Search for images"})})})}),_&&e.jsx("button",{type:"button",onClick:B,className:"fixed bottom-6 right-6 p-3 bg-[#1a73e8] text-white rounded-full shadow-lg hover:bg-[#1557b0] transition-colors z-40",children:e.jsx(K,{size:20})}),a&&o!==null&&e.jsxs("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center",onClick:()=>c(null),children:[e.jsx("button",{type:"button",onClick:()=>c(null),className:"absolute top-4 right-4 p-2 text-white/80 hover:text-white transition-colors",children:e.jsx(U,{size:24})}),o>0&&e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),c(o-1)},className:"absolute left-4 p-2 text-white/80 hover:text-white transition-colors",children:e.jsx(V,{size:32})}),o<n.length-1&&e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),c(o+1)},className:"absolute right-4 p-2 text-white/80 hover:text-white transition-colors",children:e.jsx(X,{size:32})}),e.jsxs("div",{className:"max-w-[90vw] max-h-[90vh] flex flex-col",onClick:s=>s.stopPropagation(),children:[e.jsx("img",{src:a.url,alt:a.title,className:"max-h-[80vh] w-auto object-contain rounded-lg",onError:s=>{s.currentTarget.src=a.thumbnail_url||""}}),e.jsxs("div",{className:"mt-4 text-white text-center",children:[e.jsx("p",{className:"font-medium",children:a.title}),e.jsxs("div",{className:"text-sm text-white/70 mt-1 flex items-center justify-center gap-4",children:[e.jsx("span",{children:a.source_domain}),a.width&&a.height&&e.jsxs("span",{children:[a.width," × ",a.height]}),a.format&&e.jsx("span",{className:"uppercase",children:a.format})]}),e.jsx("a",{href:a.source_url,target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-3 px-4 py-2 bg-[#1a73e8] text-white rounded-full text-sm hover:bg-[#1557b0] transition-colors",children:"Visit page"})]})]}),e.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 text-white/70 text-sm",children:[o+1," / ",n.length]})]})]})}export{re as default};
