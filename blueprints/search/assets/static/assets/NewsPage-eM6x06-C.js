import{j as e}from"./markdown-DRpjVqyA.js";import{u as I,a as q,r as m,L as S}from"./react-vendor-DqWpB-k-.js";import{S as A,s as F}from"./index-Dj7lXUE2.js";import{S as D,I as B,V as U,N as _,a as k,b as z,c as C,E as V}from"./ui-yxNLaUKB.js";const E=20;function $(o){const l=new Date(o),a=new Date().getTime()-l.getTime(),n=Math.floor(a/(1e3*60)),x=Math.floor(a/(1e3*60*60)),i=Math.floor(a/(1e3*60*60*24));return n<1?"Just now":n<60?`${n} min${n>1?"s":""} ago`:x<24?`${x} hour${x>1?"s":""} ago`:i<7?`${i} day${i>1?"s":""} ago`:l.toLocaleDateString()}function T(o,l){if(!o&&!l)return"";try{return`https://www.google.com/s2/favicons?domain=${o||new URL(l).hostname}&sz=32`}catch{return""}}function W(o){return o?o.charAt(0).toUpperCase():"?"}function K(){const[o,l]=I(),u=q(),a=o.get("q")||"",n=parseInt(o.get("page")||"1",10),[x,i]=m.useState([]),[p,g]=m.useState([]),[R,w]=m.useState(!1),[N,v]=m.useState(null),[M,L]=m.useState(0),b=m.useRef(null);m.useEffect(()=>{if(!a){i([]),g([]);return}(async()=>{w(!0),v(null);try{const r=await F.searchNews(a,{page:n,per_page:E}),t=r.results||[];n===1&&t.length>5?(g(t.slice(0,5)),i(t.slice(5))):(g([]),i(t)),L(r.total_results||t.length*10)}catch(r){v(r instanceof Error?r.message:"Search failed")}finally{w(!1)}})()},[a,n]);const P=s=>{l({q:s})},f=s=>{l({q:a,page:String(s)}),window.scrollTo({top:0,behavior:"smooth"})},y=s=>{if(b.current){const r=s==="left"?-400:400;b.current.scrollBy({left:r,behavior:"smooth"})}},c=Math.ceil(M/E),d=()=>{const s=[];let t=Math.max(1,n-Math.floor(2.5));const h=Math.min(c,t+5-1);h-t+1<5&&(t=Math.max(1,h-5+1));for(let j=t;j<=h;j++)s.push(j);return s};return e.jsxs("div",{className:"min-h-screen bg-[#f8f9fa]",children:[e.jsx("header",{className:"sticky top-0 bg-white z-50 border-b border-[#e8eaed]",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(S,{to:"/",children:e.jsx("span",{className:"text-3xl font-bold",style:{background:"linear-gradient(90deg, #4285F4, #EA4335, #FBBC05, #34A853)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Search"})}),e.jsx("div",{className:"flex-1 max-w-xl",children:e.jsx(A,{initialValue:a,size:"sm",onSearch:P})}),e.jsx(S,{to:"/settings",className:"p-2 text-[#5f6368] hover:bg-[#f1f3f4] rounded-full transition-colors",children:e.jsx(D,{size:20})})]}),e.jsxs("div",{className:"search-tabs mt-2",style:{paddingLeft:0},children:[e.jsx("button",{type:"button",className:"search-tab",onClick:()=>u(`/search?q=${encodeURIComponent(a)}`),children:"All"}),e.jsxs("button",{type:"button",className:"search-tab",onClick:()=>u(`/images?q=${encodeURIComponent(a)}`),children:[e.jsx(B,{size:16}),"Images"]}),e.jsxs("button",{type:"button",className:"search-tab",onClick:()=>u(`/videos?q=${encodeURIComponent(a)}`),children:[e.jsx(U,{size:16}),"Videos"]}),e.jsxs("button",{type:"button",className:"search-tab active",children:[e.jsx(_,{size:16}),"News"]})]})]})}),e.jsx("main",{children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:R?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}):N?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-red-600",children:N})}):x.length>0||p.length>0?e.jsxs(e.Fragment,{children:[p.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-medium text-[#202124] mb-4 flex items-center gap-2",children:[e.jsx(_,{size:20,className:"text-[#1a73e8]"}),"Top Stories"]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",onClick:()=>y("left"),className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 z-10 w-10 h-10 bg-white rounded-full shadow-lg flex items-center justify-center text-[#5f6368] hover:text-[#202124] transition-colors",children:e.jsx(k,{size:24})}),e.jsx("button",{type:"button",onClick:()=>y("right"),className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 z-10 w-10 h-10 bg-white rounded-full shadow-lg flex items-center justify-center text-[#5f6368] hover:text-[#202124] transition-colors",children:e.jsx(z,{size:24})}),e.jsx("div",{ref:b,className:"flex gap-4 overflow-x-auto scrollbar-hide scroll-smooth pb-2",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:p.map((s,r)=>e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex-shrink-0 w-80 bg-white rounded-xl shadow-sm border border-[#e8eaed] overflow-hidden hover:shadow-md transition-shadow",children:[(s.image_url||s.thumbnail_url)&&e.jsx("div",{className:"h-40 bg-[#f1f3f4]",children:e.jsx("img",{src:s.image_url||s.thumbnail_url,alt:"",className:"w-full h-full object-cover",onError:t=>{t.currentTarget.parentElement.style.display="none"}})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:T(s.source||s.source_name,s.url),alt:"",className:"w-4 h-4 rounded",onError:t=>{t.currentTarget.style.display="none"}}),e.jsx("span",{className:"text-xs text-[#70757a]",children:s.source||s.source_name||s.source_domain})]}),e.jsx("h3",{className:"text-sm font-medium text-[#202124] line-clamp-2",children:s.title}),e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-[#70757a]",children:[e.jsx(C,{size:12}),e.jsx("span",{children:s.published_at?$(s.published_at):""})]})]})]},`top-${s.id}-${r}`))})]})]}),e.jsx("div",{className:"space-y-4",children:x.map((s,r)=>e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"block bg-white rounded-xl shadow-sm border border-[#e8eaed] overflow-hidden hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex-1 p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-[#f1f3f4] flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:T(s.source||s.source_name,s.url),alt:"",className:"w-5 h-5",onError:t=>{t.currentTarget.style.display="none";const h=t.currentTarget.parentElement;h&&(h.innerHTML=`<span class="text-xs font-medium text-[#5f6368]">${W(s.source||s.source_name)}</span>`)}})}),e.jsx("span",{className:"text-sm font-medium text-[#202124]",children:s.source||s.source_name||s.source_domain}),e.jsx("span",{className:"text-[#70757a]",children:"â€¢"}),e.jsxs("span",{className:`text-sm flex items-center gap-1 ${s.published_at&&new Date(s.published_at).getTime()>Date.now()-36e5?"text-[#1a73e8] font-medium":"text-[#70757a]"}`,children:[e.jsx(C,{size:14}),s.published_at?$(s.published_at):""]})]}),e.jsx("h3",{className:"text-lg font-medium text-[#202124] line-clamp-2 hover:text-[#1a73e8] transition-colors",children:s.title}),s.snippet&&e.jsx("p",{className:"text-sm text-[#4d5156] mt-2 line-clamp-2",children:s.snippet}),e.jsxs("div",{className:"mt-3 flex items-center gap-1 text-xs text-[#70757a]",children:[e.jsx(V,{size:12}),e.jsx("span",{children:"Opens in new tab"})]})]}),(s.image_url||s.thumbnail_url)&&e.jsx("div",{className:"flex-shrink-0 w-48 bg-[#f1f3f4]",children:e.jsx("img",{src:s.image_url||s.thumbnail_url,alt:"",className:"w-full h-full object-cover",onError:t=>{t.currentTarget.parentElement.style.display="none"}})})]})},`news-${s.id}-${r}`))}),c>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-8 py-4",children:[e.jsxs("button",{type:"button",onClick:()=>f(n-1),disabled:n<=1,className:"flex items-center gap-1 px-4 py-2 text-sm text-[#1a73e8] hover:bg-[#e8f0fe] rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(k,{size:18}),"Previous"]}),d()[0]>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>f(1),className:"w-10 h-10 text-sm text-[#1a73e8] hover:bg-[#e8f0fe] rounded-lg transition-colors",children:"1"}),d()[0]>2&&e.jsx("span",{className:"text-[#70757a]",children:"..."})]}),d().map(s=>e.jsx("button",{type:"button",onClick:()=>f(s),className:`w-10 h-10 text-sm rounded-lg transition-colors ${n===s?"bg-[#1a73e8] text-white":"text-[#1a73e8] hover:bg-[#e8f0fe]"}`,children:s},s)),d()[d().length-1]<c&&e.jsxs(e.Fragment,{children:[d()[d().length-1]<c-1&&e.jsx("span",{className:"text-[#70757a]",children:"..."}),e.jsx("button",{type:"button",onClick:()=>f(c),className:"w-10 h-10 text-sm text-[#1a73e8] hover:bg-[#e8f0fe] rounded-lg transition-colors",children:c})]}),e.jsxs("button",{type:"button",onClick:()=>f(n+1),disabled:n>=c,className:"flex items-center gap-1 px-4 py-2 text-sm text-[#1a73e8] hover:bg-[#e8f0fe] rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:["Next",e.jsx(z,{size:18})]})]})]}):a?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"No news found"})}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"Search for news"})})})})]})}export{K as default};
