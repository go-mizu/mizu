import{j as e}from"./markdown-DRpjVqyA.js";import{r as d,u as O,a as V,L as I}from"./react-vendor-DqWpB-k-.js";import{u as q,s as U,b as $,a as Q,S as H}from"./index-B9sQUvT8.js";import{f as G,z as K,B as Y,J,K as X,c as Z,O as ee,Q as se,W as te,Y as B,E as F,g as L,_ as M,C as T,R as ae,t as ne,e as D,S as re,I as ie,V as le,N as ce}from"./ui-DSv63oDG.js";import{A as oe,a as de}from"./AIResponse-HCCGBydo.js";function me({result:s}){const{settings:r}=q(),[o,i]=d.useState(!1),l=d.useRef(null);d.useEffect(()=>{const t=x=>{l.current&&!l.current.contains(x.target)&&i(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const c=async t=>{try{await U.setPreference(s.domain,t),i(!1)}catch(x){console.error("Failed to set preference:",x)}},m=(()=>{try{const t=new URL(s.url),x=t.pathname.split("/").filter(Boolean);return{domain:t.hostname,path:x.slice(0,2).join(" › ")}}catch{return{domain:s.url,path:""}}})();return e.jsxs("div",{className:"search-result group",children:[e.jsxs("div",{className:"search-result-url",children:[s.favicon&&e.jsx("img",{src:s.favicon,alt:"",onError:t=>{t.target.style.display="none"}}),e.jsx("span",{children:m.domain}),m.path&&e.jsxs("span",{className:"search-result-breadcrumb",children:["› ",m.path]}),e.jsxs("div",{className:"relative ml-auto",ref:l,children:[e.jsx("button",{type:"button",onClick:()=>i(!o),className:"opacity-0 group-hover:opacity-100 p-1 text-[#70757a] hover:bg-[#f1f3f4] rounded-full transition-opacity",children:e.jsx(G,{size:16})}),o&&e.jsxs("div",{className:"dropdown-menu",children:[e.jsxs("button",{type:"button",className:"dropdown-item",onClick:()=>c("upvote"),children:[e.jsx(K,{size:16}),"Boost ",s.domain]}),e.jsxs("button",{type:"button",className:"dropdown-item",onClick:()=>c("downvote"),children:[e.jsx(Y,{size:16}),"Lower ",s.domain]}),e.jsx("div",{className:"dropdown-divider"}),e.jsxs("button",{type:"button",className:"dropdown-item danger",onClick:()=>c("block"),children:[e.jsx(J,{size:16}),"Block ",s.domain]})]})]})]}),e.jsx("a",{href:s.url,target:r.open_in_new_tab?"_blank":"_self",rel:"noopener noreferrer",className:"search-result-title",children:s.title}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("p",{className:"search-result-snippet flex-1",dangerouslySetInnerHTML:{__html:s.snippet}}),s.thumbnail?.url&&r.show_thumbnails&&e.jsx("a",{href:s.url,target:r.open_in_new_tab?"_blank":"_self",rel:"noopener noreferrer",className:"flex-shrink-0",children:e.jsx("img",{src:s.thumbnail.url,alt:"",className:"w-24 h-16 object-cover rounded border border-[#dadce0]",onError:t=>{t.target.style.display="none"}})})]}),s.published&&e.jsx("p",{className:"text-xs text-[#70757a] mt-1",children:new Date(s.published).toLocaleDateString()}),(s.sitelinks?.length??0)>0&&e.jsx("div",{className:"flex flex-wrap gap-x-4 gap-y-1 mt-2",children:(s.sitelinks||[]).map(t=>e.jsx("a",{href:t.url,target:r.open_in_new_tab?"_blank":"_self",rel:"noopener noreferrer",className:"text-sm text-[#1a0dab] hover:underline",children:t.title},t.url))})]})}const xe={calculator:B,currency:te,weather:se,definition:ee,time:Z,unit:X};function he({answer:s}){const r=xe[s.type]||B;return e.jsxs("div",{className:"bg-white border border-[#dadce0] rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(r,{size:20,className:"text-[#1a73e8]"}),e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium text-[#1a73e8] bg-[#e8f0fe] rounded",children:s.type.charAt(0).toUpperCase()+s.type.slice(1)})]}),e.jsx("div",{className:"text-3xl font-semibold text-[#202124]",children:s.result}),s.type==="calculator"&&e.jsxs("p",{className:"text-sm text-[#70757a] mt-1",children:[s.query," ="]}),s.type==="weather"&&s.data?e.jsx(ue,{data:s.data}):null,s.type==="definition"&&s.data?e.jsx(pe,{data:s.data}):null,s.type==="time"&&s.data?e.jsx(fe,{data:s.data}):null,s.type==="currency"&&s.data?e.jsx(je,{data:s.data}):null,s.type==="unit"&&s.data?e.jsx(ge,{data:s.data}):null]})}function ue({data:s}){return e.jsxs("div",{className:"flex gap-8 mt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-[#70757a]",children:"Humidity"}),e.jsxs("p",{className:"text-sm text-[#202124]",children:[s.humidity,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-[#70757a]",children:"Wind"}),e.jsxs("p",{className:"text-sm text-[#202124]",children:[s.wind_speed," ",s.wind_unit]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-[#70757a]",children:"Condition"}),e.jsx("p",{className:"text-sm text-[#202124]",children:s.condition})]})]})}function pe({data:s}){return e.jsxs("div",{className:"mt-3",children:[s.phonetic&&e.jsx("p",{className:"text-sm text-[#70757a] italic",children:s.phonetic}),e.jsx("p",{className:"text-sm text-[#70757a] mt-1",children:s.part_of_speech}),(s.definitions?.length??0)>1&&e.jsxs("p",{className:"text-sm text-[#70757a] mt-1",children:["2. ",s.definitions?.[1]]}),(s.synonyms?.length??0)>0&&e.jsxs("p",{className:"text-xs text-[#70757a] mt-2",children:["Synonyms: ",(s.synonyms||[]).join(", ")]})]})}function fe({data:s}){return e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-[#70757a]",children:s.date}),e.jsxs("p",{className:"text-xs text-[#70757a]",children:[s.timezone," (",s.offset,")"]})]})}function je({data:s}){return e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-sm text-[#70757a]",children:["1 ",s.from_currency," = ",s.rate.toFixed(4)," ",s.to_currency]}),e.jsxs("p",{className:"text-xs text-[#70757a]",children:["Rate as of ",new Date(s.updated_at).toLocaleDateString()]})]})}function ge({data:s}){return e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-sm text-[#70757a]",children:[s.from_value," ",s.from_unit," = ",s.to_value.toFixed(4)," ",s.to_unit]}),e.jsx("p",{className:"text-xs text-[#70757a] capitalize",children:s.category})]})}function be({panel:s}){return e.jsxs("div",{className:"knowledge-panel",children:[s.image&&e.jsx("img",{src:s.image,alt:s.title,className:"knowledge-panel-image",onError:r=>{r.target.style.display="none"}}),e.jsxs("div",{className:"knowledge-panel-content",children:[e.jsx("h2",{className:"knowledge-panel-title",children:s.title}),s.subtitle&&e.jsx("p",{className:"knowledge-panel-subtitle",children:s.subtitle.charAt(0).toUpperCase()+s.subtitle.slice(1).replace(/_/g," ")}),e.jsx("p",{className:"knowledge-panel-description",children:s.description}),(s.facts?.length??0)>0&&e.jsx("div",{className:"knowledge-panel-facts",children:(s.facts||[]).map(r=>e.jsxs("div",{className:"knowledge-panel-fact",children:[e.jsx("span",{className:"knowledge-panel-fact-label",children:r.label}),e.jsx("span",{className:"knowledge-panel-fact-value",children:r.value})]},r.label))}),(s.links?.length??0)>0&&e.jsx("div",{className:"mt-4 pt-4 border-t border-[#dadce0]",children:(s.links||[]).map(r=>e.jsxs("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 py-2 text-sm text-[#1a73e8] hover:underline",children:[e.jsx(F,{size:14}),r.title]},r.url))}),s.source&&e.jsxs("p",{className:"mt-4 text-xs text-[#70757a]",children:["Source: ",s.source]})]})]})}function Ne({query:s,onFollowUp:r}){const{mode:o,aiAvailable:i,isLoading:l,isStreaming:c,streamingContent:m,streamingThinking:t,currentResponse:x,error:C,setLoading:w,setStreaming:k,appendStreamContent:z,addThinkingStep:R,resetStream:g,setCurrentResponse:h,setError:f}=$(),[j,p]=d.useState(!0),[E,b]=d.useState(!1),u=d.useCallback(async()=>{if(!(!s||!i)){g(),w(!0),f(null),h(null);try{k(!0);const y=Q.queryStreamFetch({text:s,mode:o});let a=null;for await(const n of y)switch(n.type){case"token":n.content&&z(n.content);break;case"thinking":n.thinking&&R(n.thinking);break;case"done":n.response&&(a=n.response);break;case"error":f(n.error||"An error occurred");break}a&&h(a)}catch(y){f(y instanceof Error?y.message:"Failed to get AI response")}finally{w(!1),k(!1),b(!0)}}},[s,o,i]);if(d.useEffect(()=>{s&&i&&!E&&u()},[s,i,E,u]),d.useEffect(()=>{b(!1),g(),h(null)},[s]),!i)return null;const N=()=>{u()},A=()=>{u()},v=x||{text:m,mode:o,citations:[],follow_ups:[],session_id:"",sources_used:0,thinking_steps:t};return e.jsxs("div",{className:"ai-summary",children:[e.jsxs("div",{className:"ai-summary-header",children:[e.jsxs("button",{type:"button",onClick:()=>p(!j),className:"ai-summary-toggle",children:[e.jsx(L,{size:18,className:"ai-summary-icon"}),e.jsx("span",{className:"ai-summary-title",children:"AI Overview"}),j?e.jsx(M,{size:16}):e.jsx(T,{size:16})]}),e.jsxs("div",{className:"ai-summary-controls",children:[e.jsx(oe,{size:"sm",onChange:A}),e.jsx("button",{type:"button",onClick:N,disabled:l||c,className:"ai-refresh-button",title:"Regenerate",children:e.jsx(ae,{size:14,className:l?"animate-spin":""})})]})]}),j&&e.jsx("div",{className:"ai-summary-content",children:C?e.jsxs("div",{className:"ai-error",children:[e.jsx("p",{children:C}),e.jsx("button",{type:"button",onClick:N,children:"Try again"})]}):l&&!m?e.jsxs("div",{className:"ai-loading",children:[e.jsxs("div",{className:"ai-loading-dots",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]}),e.jsx("p",{children:"Generating AI overview..."})]}):v.text||m?e.jsx(de,{response:v,streamingContent:c?m:void 0,streamingThinking:c?t:void 0,isStreaming:c,onFollowUp:r}):null})]})}function ve({sheet:s}){const[r,o]=d.useState(new Set([0])),i=l=>{const c=new Set(r);c.has(l)?c.delete(l):c.add(l),o(c)};return e.jsxs("div",{className:"bg-[#f8f9fa] border border-[#dadce0] rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ne,{size:18,className:"text-[#1a73e8]"}),e.jsx("h3",{className:"font-medium text-[#202124]",children:s.title})]}),s.description&&e.jsx("p",{className:"text-sm text-[#70757a] mb-3",children:s.description}),e.jsx("div",{className:"space-y-2",children:s.sections.map((l,c)=>e.jsxs("div",{className:"border border-[#e8eaed] rounded bg-white",children:[e.jsxs("button",{type:"button",onClick:()=>i(c),className:"w-full flex items-center justify-between px-3 py-2 text-sm font-medium text-[#202124] hover:bg-[#f1f3f4]",children:[e.jsx("span",{children:l.title}),r.has(c)?e.jsx(M,{size:16,className:"text-[#70757a]"}):e.jsx(T,{size:16,className:"text-[#70757a]"})]}),r.has(c)&&e.jsx("div",{className:"px-3 pb-3 space-y-2",children:l.items.map((m,t)=>e.jsxs("div",{className:"flex gap-3 text-sm",children:[e.jsx("code",{className:"px-2 py-0.5 bg-[#f1f3f4] rounded text-[#1a73e8] font-mono text-xs flex-shrink-0",children:m.code}),e.jsx("span",{className:"text-[#5f6368]",children:m.description})]},t))})]},c))})]})}function ye({searches:s,onSearch:r}){return!s||s.length===0?null:e.jsxs("div",{className:"bg-[#f8f9fa] border border-[#dadce0] rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(D,{size:18,className:"text-[#1a73e8]"}),e.jsx("h3",{className:"font-medium text-[#202124]",children:"Related Searches"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.map((o,i)=>e.jsxs("button",{type:"button",onClick:()=>r(o),className:"flex items-center gap-2 px-3 py-2 text-sm text-left text-[#1a0dab] hover:bg-[#e8f0fe] rounded transition-colors",children:[e.jsx(D,{size:14,className:"text-[#70757a] flex-shrink-0"}),e.jsx("span",{className:"truncate",children:o})]},i))})]})}const P=[{value:"",label:"Any time"},{value:"day",label:"Past 24 hours"},{value:"week",label:"Past week"},{value:"month",label:"Past month"},{value:"year",label:"Past year"}];function ze(){const[s,r]=O(),o=V(),i=s.get("q")||"",l=parseInt(s.get("page")||"1",10),c=s.get("time")||"",[m]=d.useState("all"),[t,x]=d.useState(null),[C,w]=d.useState(!1),[k,z]=d.useState(null),[R,g]=d.useState(!1),[h,f]=d.useState(null),j=d.useRef(null),{settings:p,addRecentSearch:E}=q(),{aiAvailable:b}=$();d.useEffect(()=>{const a=n=>{j.current&&!j.current.contains(n.target)&&g(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),d.useEffect(()=>{if(!i)return;(async()=>{w(!0),z(null),f(null);try{const n=await U.search(i,{page:l,per_page:p.results_per_page,time:c,safe:p.safe_search,region:p.region,lang:p.language});if(n.redirect)if(n.redirect.startsWith("http"))f({url:n.redirect,name:n.bang?.name||"External site"}),x(null);else{o(n.redirect);return}else if(n.category){o(`/${n.category}?q=${encodeURIComponent(n.query)}`);return}else x(n);E(i)}catch(n){z(n instanceof Error?n.message:"Search failed")}finally{w(!1)}})()},[i,l,c,p]);const u=a=>{r({q:a})},N=a=>{r({q:i,page:String(a)}),window.scrollTo({top:0,behavior:"smooth"})},A=a=>{r(a?{q:i,time:a}:{q:i}),g(!1)},v=t?Math.ceil(t.total_results/p.results_per_page):0,y=P.find(a=>a.value===c)?.label||"Any time";return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("header",{className:"sticky top-0 bg-white z-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(I,{to:"/",children:e.jsx("span",{className:"text-3xl font-bold",style:{background:"linear-gradient(90deg, #4285F4, #EA4335, #FBBC05, #34A853)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Search"})}),e.jsx("div",{className:"flex-1 max-w-xl",children:e.jsx(H,{initialValue:i,size:"sm",onSearch:u})}),b&&e.jsx(I,{to:"/ai/sessions",className:"p-2 text-[#5f6368] hover:bg-[#f1f3f4] rounded-full transition-colors",title:"AI Research Sessions",children:e.jsx(L,{size:20})}),e.jsx(I,{to:"/settings",className:"p-2 text-[#5f6368] hover:bg-[#f1f3f4] rounded-full transition-colors",children:e.jsx(re,{size:20})})]}),e.jsxs("div",{className:"search-tabs mt-2",style:{paddingLeft:0},children:[e.jsx("button",{type:"button",className:`search-tab ${m==="all"?"active":""}`,onClick:()=>o(`/search?q=${encodeURIComponent(i)}`),children:"All"}),b&&e.jsxs("button",{type:"button",className:`search-tab ${m==="ai"?"active":""}`,onClick:()=>o(`/ai?q=${encodeURIComponent(i)}`),children:[e.jsx(L,{size:16}),"AI"]}),e.jsxs("button",{type:"button",className:`search-tab ${m==="images"?"active":""}`,onClick:()=>o(`/images?q=${encodeURIComponent(i)}`),children:[e.jsx(ie,{size:16}),"Images"]}),e.jsxs("button",{type:"button",className:`search-tab ${m==="videos"?"active":""}`,onClick:()=>o(`/videos?q=${encodeURIComponent(i)}`),children:[e.jsx(le,{size:16}),"Videos"]}),e.jsxs("button",{type:"button",className:`search-tab ${m==="news"?"active":""}`,onClick:()=>o(`/news?q=${encodeURIComponent(i)}`),children:[e.jsx(ce,{size:16}),"News"]}),e.jsxs("div",{className:"time-filter ml-auto",ref:j,children:[e.jsxs("button",{type:"button",className:"time-filter-button",onClick:()=>g(!R),children:[y,e.jsx(T,{size:16})]}),R&&e.jsx("div",{className:"time-filter-dropdown",children:P.map(a=>e.jsx("button",{type:"button",className:`time-filter-option ${c===a.value?"active":""}`,onClick:()=>A(a.value),children:a.label},a.value))})]})]})]})}),e.jsx("main",{children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex gap-8",children:[e.jsx("div",{className:"flex-1 max-w-2xl",children:C?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}):h?e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"bg-[#f8f9fa] border border-[#dadce0] rounded-lg p-6 text-center",children:[e.jsx(F,{size:32,className:"mx-auto mb-4 text-[#1a73e8]"}),e.jsxs("h2",{className:"text-lg font-medium text-[#202124] mb-2",children:["Redirecting to ",h.name]}),e.jsx("p",{className:"text-sm text-[#5f6368] mb-4",children:"You're about to leave Mizu Search"}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsxs("a",{href:h.url,className:"px-4 py-2 bg-[#1a73e8] text-white rounded-lg hover:bg-[#1557b0] transition-colors",rel:"noopener noreferrer",children:["Continue to ",h.name]}),e.jsx("button",{type:"button",onClick:()=>{f(null),o("/")},className:"px-4 py-2 border border-[#dadce0] rounded-lg hover:bg-[#f1f3f4] transition-colors text-[#5f6368]",children:"Go Back"})]}),e.jsx("p",{className:"text-xs text-[#9aa0a6] mt-4 break-all",children:h.url})]})}):k?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-red-600",children:k})}):t?e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-[#70757a] mb-4",children:["About ",t.total_results.toLocaleString()," results (",t.search_time_ms.toFixed(2)," ms)"]}),t.corrected_query&&e.jsxs("p",{className:"text-sm mb-4",children:["Showing results for"," ",e.jsx("button",{type:"button",onClick:()=>u(t.corrected_query),className:"font-medium text-[#1a73e8] hover:underline",children:t.corrected_query})]}),b&&i&&e.jsx("div",{className:"mb-6",children:e.jsx(Ne,{query:i,onFollowUp:a=>u(a)})}),t.widgets?.filter(a=>a.type==="cheat_sheet").map((a,n)=>e.jsx(ve,{sheet:a.content},n)),t.instant_answer&&e.jsx("div",{className:"mb-4",children:e.jsx(he,{answer:t.instant_answer})}),(t.results||[]).map(a=>e.jsx(me,{result:a},a.id)),(()=>{const a=t.widgets?.find(S=>S.type==="related_searches"),n=a?a.content:t.related_searches||[];return n.length>0?e.jsx(ye,{searches:n,onSearch:u}):null})(),v>1&&e.jsxs("div",{className:"pagination",children:[l>1&&e.jsx("button",{type:"button",className:"pagination-item",onClick:()=>N(l-1),children:"<"}),(()=>{let n=Math.max(1,l-Math.floor(5));const S=Math.min(v,n+10-1);return S-n+1<10&&(n=Math.max(1,S-10+1)),Array.from({length:S-n+1},(_,W)=>n+W).map(_=>e.jsx("button",{type:"button",className:`pagination-item ${l===_?"active":""}`,onClick:()=>N(_),children:_},_))})(),l<v&&e.jsx("button",{type:"button",className:"pagination-item",onClick:()=>N(l+1),children:">"})]})]}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"Enter a search query"})})}),t?.knowledge_panel&&e.jsx("div",{className:"hidden lg:block w-80",children:e.jsx(be,{panel:t.knowledge_panel})})]})})})]})}export{ze as default};
