import{j as e}from"./markdown-DRpjVqyA.js";import{u as me,r as a}from"./react-vendor-DqWpB-k-.js";import{S as he}from"./SearchHeader-B2KRDaM8.js";import{s as q}from"./index-CmWeGl3w.js";import{u as fe}from"./useInfiniteScroll-UVndtYbB.js";import{X as K,C as Q,L as xe,G as be,V as E,P as B,A as pe,c as W,d as ge,e as je,a as we,b as ye,E as G}from"./ui-CyDAUWlq.js";function ve(s){if(!s)return null;try{const l=new URL(s);return l.hostname.includes("youtube.com")||l.hostname.includes("youtube-nocookie.com")?(l.searchParams.set("autoplay","1"),l.searchParams.set("mute","1"),l.searchParams.set("controls","0"),l.searchParams.set("modestbranding","1"),l.searchParams.set("rel","0"),l.toString()):l.hostname.includes("vimeo.com")||l.hostname.includes("player.vimeo.com")?(l.searchParams.set("autoplay","1"),l.searchParams.set("muted","1"),l.searchParams.set("controls","0"),l.searchParams.set("background","1"),l.toString()):l.hostname.includes("dailymotion.com")?(l.searchParams.set("autoplay","1"),l.searchParams.set("mute","1"),l.searchParams.set("controls","0"),l.toString()):(l.searchParams.set("autoplay","1"),l.searchParams.set("mute","1"),l.toString())}catch{return null}}function H({video:s,isVisible:l,onMuteToggle:i,isMuted:r=!0}){const[n,d]=a.useState(!1),[h,f]=a.useState(!1),m=a.useRef(null),x=a.useRef(null),o=ve(s.embed_url),b=!!o;if(a.useEffect(()=>(l&&b?m.current=setTimeout(()=>{d(!0)},400):(m.current&&(clearTimeout(m.current),m.current=null),d(!1),f(!1)),()=>{m.current&&clearTimeout(m.current)}),[l,b]),!b||!n)return null;const k=o&&(()=>{try{const u=new URL(o);return u.hostname.includes("youtube")?u.searchParams.set("mute",r?"1":"0"):u.hostname.includes("vimeo")?u.searchParams.set("muted",r?"1":"0"):u.hostname.includes("dailymotion")&&u.searchParams.set("mute",r?"1":"0"),u.toString()}catch{return o}})();return e.jsxs("div",{className:"absolute inset-0 z-10",children:[!h&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:e.jsx("div",{className:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"})}),e.jsx("iframe",{ref:x,src:k||void 0,className:`w-full h-full ${h?"opacity-100":"opacity-0"}`,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",title:`Preview: ${s.title}`,onLoad:()=>f(!0)}),h&&i&&e.jsx("button",{type:"button",onClick:u=>{u.stopPropagation(),i(!r)},className:"absolute bottom-2 left-2 p-1.5 bg-black/70 hover:bg-black/90 rounded-full text-white transition-colors z-20","aria-label":r?"Unmute":"Mute",children:r?e.jsx(ge,{size:16}):e.jsx(je,{size:16})})]})}const Ne=[{value:"",label:"Any duration"},{value:"short",label:"Short (< 4 min)"},{value:"medium",label:"Medium (4-20 min)"},{value:"long",label:"Long (> 20 min)"}],Se=[{value:"",label:"Any time"},{value:"hour",label:"Past hour"},{value:"day",label:"Past 24 hours"},{value:"week",label:"Past week"},{value:"month",label:"Past month"},{value:"year",label:"Past year"}],ke=[{value:"",label:"All sources"},{value:"youtube",label:"YouTube"},{value:"vimeo",label:"Vimeo"},{value:"dailymotion",label:"Dailymotion"},{value:"google_videos",label:"Google"},{value:"bing_videos",label:"Bing"},{value:"peertube",label:"PeerTube"}],Pe=[{value:"",label:"Any quality"},{value:"hd",label:"HD"}];function Y(s){if(!s)return"";const l=Math.floor(s/60),i=s%60;if(l>=60){const r=Math.floor(l/60),n=l%60;return`${r}:${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}return`${l}:${i.toString().padStart(2,"0")}`}function L(s){return s?s>=1e6?`${(s/1e6).toFixed(1)}M views`:s>=1e3?`${(s/1e3).toFixed(1)}K views`:`${s} views`:""}function M(s){if(!s)return"";const l=new Date(s),r=new Date().getTime()-l.getTime(),n=Math.floor(r/(1e3*60*60*24));return n<1?"Today":n<7?`${n} day${n>1?"s":""} ago`:n<30?`${Math.floor(n/7)} week${Math.floor(n/7)>1?"s":""} ago`:n<365?`${Math.floor(n/30)} month${Math.floor(n/30)>1?"s":""} ago`:`${Math.floor(n/365)} year${Math.floor(n/365)>1?"s":""} ago`}function C({label:s,value:l,options:i,onChange:r,isActive:n}){const[d,h]=a.useState(!1),f=a.useRef(null);a.useEffect(()=>{const o=b=>{f.current&&!f.current.contains(b.target)&&h(!1)};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]);const m=i.find(o=>o.value===l),x=n&&m?m.label:s;return e.jsxs("div",{className:"relative flex-shrink-0",ref:f,children:[e.jsxs("button",{type:"button",onClick:()=>h(!d),className:`
          flex items-center gap-1 px-3 py-1.5 text-sm rounded-full border transition-colors whitespace-nowrap
          ${n?"bg-[#e8f0fe] border-[#e8f0fe] text-[#1a73e8]":"bg-white border-[#dadce0] text-[#3c4043] hover:bg-[#f1f3f4]"}
        `,children:[x,e.jsx(Q,{size:14,className:`transition-transform ${d?"rotate-180":""}`})]}),d&&e.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white rounded-lg shadow-lg border border-[#e8eaed] py-1 z-50 min-w-[160px]",children:i.map(o=>e.jsxs("button",{type:"button",onClick:()=>{r(o.value),h(!1)},className:`
                w-full flex items-center gap-2 px-3 py-2 text-sm text-left transition-colors
                ${o.value===l?"bg-[#e8f0fe] text-[#1a73e8]":"text-[#3c4043] hover:bg-[#f1f3f4]"}
              `,children:[o.value===l&&e.jsx(W,{size:14}),e.jsx("span",{className:o.value===l?"":"ml-[22px]",children:o.label})]},o.value))})]})}function _e({label:s,isActive:l,onToggle:i}){return e.jsxs("button",{type:"button",onClick:i,className:`
        flex items-center gap-1 px-3 py-1.5 text-sm rounded-full border transition-colors whitespace-nowrap flex-shrink-0
        ${l?"bg-[#e8f0fe] border-[#e8f0fe] text-[#1a73e8]":"bg-white border-[#dadce0] text-[#3c4043] hover:bg-[#f1f3f4]"}
      `,children:[l&&e.jsx(W,{size:14}),s]})}function Ce(s){if(s.source_domain){const l=s.source_domain.replace(/^www\./,"");return l.includes("youtube")?"YouTube":l.includes("vimeo")?"Vimeo":l.includes("dailymotion")?"Dailymotion":l.includes("twitch")?"Twitch":l.includes("peertube")?"PeerTube":l}return s.engine?s.engine.charAt(0).toUpperCase()+s.engine.slice(1):"source"}function Te({video:s,onClose:l,onPrevious:i,onNext:r,hasPrevious:n,hasNext:d}){const h=a.useRef(null);a.useEffect(()=>{const x=o=>{o.key==="Escape"?l():o.key==="ArrowLeft"&&n?i():o.key==="ArrowRight"&&d&&r()};return document.addEventListener("keydown",x),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",x),document.body.style.overflow=""}},[l,i,r,n,d]);const f=x=>{x.target===h.current&&l()},m=Ce(s);return e.jsxs("div",{ref:h,onClick:f,className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",children:[e.jsx("button",{type:"button",onClick:l,className:"absolute top-4 right-4 p-2 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10","aria-label":"Close",children:e.jsx(K,{size:28})}),n&&e.jsx("button",{type:"button",onClick:i,className:"absolute left-4 top-1/2 -translate-y-1/2 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10","aria-label":"Previous video",children:e.jsx(we,{size:36})}),d&&e.jsx("button",{type:"button",onClick:r,className:"absolute right-4 top-1/2 -translate-y-1/2 p-3 text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors z-10","aria-label":"Next video",children:e.jsx(ye,{size:36})}),e.jsxs("div",{className:"w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto rounded-lg",children:[e.jsx("div",{className:"bg-black",children:s.embed_url?e.jsx("div",{className:"relative w-full",style:{paddingBottom:"56.25%"},children:e.jsx("iframe",{src:s.embed_url,className:"absolute inset-0 w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,title:s.title})}):e.jsx("div",{className:"relative w-full",style:{paddingBottom:"56.25%"},children:e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-[#1a1a1a]",children:[s.thumbnail_url&&e.jsx("img",{src:s.thumbnail_url,alt:s.title,className:"absolute inset-0 w-full h-full object-cover opacity-30"}),e.jsxs("div",{className:"relative z-10 text-center p-8",children:[e.jsx(E,{size:64,className:"text-white/50 mx-auto mb-4"}),e.jsx("p",{className:"text-white/70 mb-4",children:"This video cannot be embedded"}),e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-6 py-3 bg-[#1a73e8] text-white rounded-full hover:bg-[#1557b0] transition-colors",children:[e.jsx(G,{size:18}),"Watch on ",m]})]})]})})}),e.jsxs("div",{className:"bg-white p-6",children:[e.jsx("h2",{className:"text-xl font-medium text-[#202124] leading-snug",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 text-sm text-[#5f6368]",children:[s.channel&&e.jsx("span",{className:"font-medium text-[#202124]",children:s.channel}),s.channel&&(s.views||s.published_at)&&e.jsx("span",{className:"text-[#70757a]",children:"-"}),s.views&&e.jsx("span",{children:L(s.views)}),s.views&&s.published_at&&e.jsx("span",{className:"text-[#70757a]",children:"-"}),s.published_at&&e.jsx("span",{children:M(s.published_at)})]}),s.description&&e.jsx("p",{className:"mt-4 text-sm text-[#4d5156] leading-relaxed",children:s.description}),e.jsx("div",{className:"mt-4 pt-4 border-t border-[#e8eaed]",children:e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 text-sm text-[#1a73e8] hover:underline",children:[e.jsx(G,{size:14}),"Open on ",m]})})]})]})]})}function Fe(){const[s,l]=me(),i=s.get("q")||"",[r,n]=a.useState([]),[d,h]=a.useState(!1),[f,m]=a.useState(null),[x,o]=a.useState(1),[b,k]=a.useState(()=>localStorage.getItem("videos_view_mode")||"list"),[u,A]=a.useState(""),[g,F]=a.useState(""),[j,I]=a.useState(""),[w,V]=a.useState(""),[y,R]=a.useState(!1),[P,X]=a.useState(!1),[O,J]=a.useState(null),[v,Z]=a.useState(null),[D,T]=a.useState(!0),[N,S]=a.useState(null),[ee,te]=a.useState(!1),se=a.useRef(null),_=a.useCallback(t=>{J(t),Z(t),t!==v&&T(!0)},[v]),U=30,$=a.useCallback(()=>{const t={per_page:U};return u&&(t.duration=u),g&&(t.time=g),j&&(t.source=j),w&&(t.quality=w),y&&(t.cc=!0),t},[u,g,j,w,y]),le=u||g||j||w||y,ae=()=>{A(""),F(""),I(""),V(""),R(!1)};a.useEffect(()=>{localStorage.setItem("videos_view_mode",b)},[b]);const re=a.useCallback(async()=>{if(!i||d)return;const t=x+1;try{const c=$();c.page=t;const p=await q.searchVideos(i,c);p.results.length===0?z(!1):(n(de=>[...de,...p.results]),o(t))}catch{z(!1)}},[i,x,d,$]),{isLoading:ne,hasMore:ie,setHasMore:z,reset:oe}=fe(re,{threshold:300,enabled:r.length>0&&!d});a.useEffect(()=>{if(!i){n([]);return}(async()=>{h(!0),m(null),oe(),o(1);try{const c=$(),p=await q.searchVideos(i,c);n(p.results||[]),z((p.results?.length||0)>=U)}catch(c){m(c instanceof Error?c.message:"Search failed")}finally{h(!1)}})()},[i,u,g,j,w,y]),a.useEffect(()=>{const t=()=>{te(window.scrollY>500)};return window.addEventListener("scroll",t,{passive:!0}),()=>window.removeEventListener("scroll",t)},[]);const ce=t=>{l({q:t})},ue=()=>{window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(he,{query:i,activeTab:"videos",onSearch:ce,tabsRight:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",className:`flex items-center gap-1 px-3 py-1.5 text-sm rounded-full transition-colors ${P?"bg-[#e8f0fe] text-[#1a73e8]":"text-[#5f6368] hover:bg-[#f1f3f4]"}`,onClick:()=>X(!P),children:["Filters",e.jsx(Q,{size:16,className:`transition-transform ${P?"rotate-180":""}`})]}),e.jsxs("div",{className:"flex items-center border border-[#dadce0] rounded-full overflow-hidden",children:[e.jsx("button",{type:"button",onClick:()=>k("list"),className:`p-2 transition-colors ${b==="list"?"bg-[#e8f0fe] text-[#1a73e8]":"text-[#5f6368] hover:bg-[#f1f3f4]"}`,title:"List view",children:e.jsx(xe,{size:18})}),e.jsx("button",{type:"button",onClick:()=>k("grid"),className:`p-2 transition-colors ${b==="grid"?"bg-[#e8f0fe] text-[#1a73e8]":"text-[#5f6368] hover:bg-[#f1f3f4]"}`,title:"Grid view",children:e.jsx(be,{size:18})})]})]}),belowTabs:P?e.jsx("div",{className:"border-t border-[#e8eaed] bg-[#f8f9fa]",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-2",children:e.jsxs("div",{ref:se,className:"flex items-center gap-2 overflow-x-auto scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[e.jsx(C,{label:"Any duration",value:u,options:Ne,onChange:A,isActive:!!u}),e.jsx(C,{label:"Any time",value:g,options:Se,onChange:F,isActive:!!g}),e.jsx(C,{label:"All sources",value:j,options:ke,onChange:I,isActive:!!j}),e.jsx(C,{label:"Any quality",value:w,options:Pe,onChange:V,isActive:!!w}),e.jsx(_e,{label:"CC",isActive:y,onToggle:()=>R(!y)}),le&&e.jsxs("button",{type:"button",onClick:ae,className:"flex items-center gap-1 px-3 py-1.5 text-sm text-[#1a73e8] hover:bg-[#e8f0fe] rounded-full transition-colors whitespace-nowrap flex-shrink-0",children:[e.jsx(K,{size:14}),"Clear all"]})]})})}):void 0}),e.jsx("main",{children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:d&&r.length===0?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}):f?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-red-600",children:f})}):r.length>0?e.jsxs(e.Fragment,{children:[b==="list"?e.jsx("div",{className:"space-y-6",children:r.map((t,c)=>e.jsxs("button",{type:"button",onClick:()=>S(c),className:"flex gap-4 p-3 rounded-lg hover:bg-[#f8f9fa] transition-colors w-full text-left cursor-pointer",onMouseEnter:()=>_(c),onMouseLeave:()=>_(null),children:[e.jsxs("div",{className:"relative flex-shrink-0 w-80 h-44 bg-[#f1f3f4] rounded-lg overflow-hidden",children:[t.thumbnail_url?e.jsx("img",{src:t.thumbnail_url,alt:t.title,className:"w-full h-full object-cover",onError:p=>{p.currentTarget.style.display="none"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(E,{size:48,className:"text-[#9aa0a6]"})}),e.jsx(H,{video:t,isVisible:v===c,isMuted:D,onMuteToggle:T}),O===c&&!t.embed_url&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 transition-opacity",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-black/70 flex items-center justify-center",children:e.jsx(B,{size:28,className:"text-white ml-1",fill:"white"})})}),(t.duration||t.duration_seconds)&&v!==c&&e.jsx("span",{className:"absolute bottom-2 right-2 bg-black/80 text-white text-xs px-1.5 py-0.5 rounded",children:t.duration||Y(t.duration_seconds)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-[#1a0dab] text-lg font-medium line-clamp-2 hover:underline",children:t.title}),e.jsxs("div",{className:"text-sm text-[#70757a] mt-2 flex items-center gap-2",children:[e.jsx("span",{children:t.channel||t.source_domain||t.engine}),t.views&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsx("span",{children:L(t.views)})]}),t.published_at&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsx("span",{children:M(t.published_at)})]})]}),t.description&&e.jsx("p",{className:"text-sm text-[#4d5156] mt-3 line-clamp-2",children:t.description})]})]},`${t.id}-${c}`))}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:r.map((t,c)=>e.jsxs("button",{type:"button",onClick:()=>S(c),className:"block rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow bg-white border border-[#dadce0] text-left cursor-pointer",onMouseEnter:()=>_(c),onMouseLeave:()=>_(null),children:[e.jsxs("div",{className:"relative aspect-video bg-[#f1f3f4]",children:[t.thumbnail_url?e.jsx("img",{src:t.thumbnail_url,alt:t.title,className:"w-full h-full object-cover",onError:p=>{p.currentTarget.style.display="none"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(E,{size:48,className:"text-[#9aa0a6]"})}),e.jsx(H,{video:t,isVisible:v===c,isMuted:D,onMuteToggle:T}),O===c&&!t.embed_url&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 transition-opacity",children:e.jsx("div",{className:"w-14 h-14 rounded-full bg-black/70 flex items-center justify-center",children:e.jsx(B,{size:24,className:"text-white ml-0.5",fill:"white"})})}),(t.duration||t.duration_seconds)&&v!==c&&e.jsx("span",{className:"absolute bottom-2 right-2 bg-black/80 text-white text-xs px-1.5 py-0.5 rounded",children:t.duration||Y(t.duration_seconds)})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-[#202124] text-sm font-medium line-clamp-2",children:t.title}),e.jsxs("div",{className:"text-xs text-[#70757a] mt-2",children:[e.jsx("p",{children:t.channel||t.source_domain||t.engine}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[t.views&&e.jsx("span",{children:L(t.views)}),t.views&&t.published_at&&e.jsx("span",{children:"-"}),t.published_at&&e.jsx("span",{children:M(t.published_at)})]})]})]})]},`${t.id}-${c}`))}),ne&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"w-6 h-6 border-2 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}),!ie&&r.length>0&&e.jsx("div",{className:"text-center py-8 text-[#70757a]",children:"No more videos"})]}):i?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"No videos found"})}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"Search for videos"})})})}),ee&&e.jsx("button",{type:"button",onClick:ue,className:"fixed bottom-6 right-6 p-3 bg-[#1a73e8] text-white rounded-full shadow-lg hover:bg-[#1557b0] transition-colors z-40",children:e.jsx(pe,{size:20})}),N!==null&&r[N]&&e.jsx(Te,{video:r[N],onClose:()=>S(null),onPrevious:()=>S(t=>t!==null&&t>0?t-1:t),onNext:()=>S(t=>t!==null&&t<r.length-1?t+1:t),hasPrevious:N>0,hasNext:N<r.length-1}),e.jsx("style",{children:`
        .scrollbar-hide::-webkit-scrollbar {
          display: none;
        }
      `})]})}export{Fe as default};
