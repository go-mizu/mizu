import{j as e}from"./markdown-DRpjVqyA.js";import{u as G,a as H,r,L as $}from"./react-vendor-DqWpB-k-.js";import{s as M,S as W}from"./index-B9sQUvT8.js";import{u as K}from"./useInfiniteScroll-UVndtYbB.js";import{S as Y,I as J,V as b,N as Q,L as X,G as Z,C as ee,P as C,A as se}from"./ui-DSv63oDG.js";const te=[{value:"",label:"Any duration"},{value:"short",label:"Short (< 4 min)"},{value:"medium",label:"Medium (4-20 min)"},{value:"long",label:"Long (> 20 min)"}],ae=[{value:"",label:"Relevance"},{value:"date",label:"Date"},{value:"views",label:"Views"}];function E(l){if(!l)return"";const i=Math.floor(l/60),o=l%60;if(i>=60){const n=Math.floor(i/60),t=i%60;return`${n}:${t.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}return`${i}:${o.toString().padStart(2,"0")}`}function L(l){return l?l>=1e6?`${(l/1e6).toFixed(1)}M views`:l>=1e3?`${(l/1e3).toFixed(1)}K views`:`${l} views`:""}function T(l){if(!l)return"";const i=new Date(l),n=new Date().getTime()-i.getTime(),t=Math.floor(n/(1e3*60*60*24));return t<1?"Today":t<7?`${t} day${t>1?"s":""} ago`:t<30?`${Math.floor(t/7)} week${Math.floor(t/7)>1?"s":""} ago`:t<365?`${Math.floor(t/30)} month${Math.floor(t/30)>1?"s":""} ago`:`${Math.floor(t/365)} year${Math.floor(t/365)>1?"s":""} ago`}function ce(){const[l,i]=G(),o=H(),n=l.get("q")||"",[t,m]=r.useState([]),[u,g]=r.useState(!1),[j,N]=r.useState(null),[w,v]=r.useState(1),[c,y]=r.useState(()=>localStorage.getItem("videos_view_mode")||"list"),[S,k]=r.useState(!1),[z,F]=r.useState(""),[I,V]=r.useState(""),[_,h]=r.useState(null),[P,D]=r.useState(!1),x=r.useRef(null),f=30;r.useEffect(()=>{localStorage.setItem("videos_view_mode",c)},[c]);const R=r.useCallback(async()=>{if(!n||u)return;const s=w+1;try{const a=await M.searchVideos(n,{page:s,per_page:f});a.results.length===0?p(!1):(m(d=>[...d,...a.results]),v(s))}catch{p(!1)}},[n,w,u]),{isLoading:A,hasMore:O,setHasMore:p,reset:q}=K(R,{threshold:300,enabled:t.length>0&&!u});r.useEffect(()=>{if(!n){m([]);return}(async()=>{g(!0),N(null),q(),v(1);try{const a=await M.searchVideos(n,{per_page:f});m(a.results||[]),p((a.results?.length||0)>=f)}catch(a){N(a instanceof Error?a.message:"Search failed")}finally{g(!1)}})()},[n]),r.useEffect(()=>{const s=()=>{D(window.scrollY>500)};return window.addEventListener("scroll",s,{passive:!0}),()=>window.removeEventListener("scroll",s)},[]),r.useEffect(()=>{const s=a=>{x.current&&!x.current.contains(a.target)&&k(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const B=s=>{i({q:s})},U=()=>{window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("header",{className:"sticky top-0 bg-white z-40 border-b border-[#e8eaed]",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx($,{to:"/",children:e.jsx("span",{className:"text-3xl font-bold",style:{background:"linear-gradient(90deg, #4285F4, #EA4335, #FBBC05, #34A853)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"Search"})}),e.jsx("div",{className:"flex-1 max-w-xl",children:e.jsx(W,{initialValue:n,size:"sm",onSearch:B})}),e.jsx($,{to:"/settings",className:"p-2 text-[#5f6368] hover:bg-[#f1f3f4] rounded-full transition-colors",children:e.jsx(Y,{size:20})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"search-tabs",style:{paddingLeft:0},children:[e.jsx("button",{type:"button",className:"search-tab",onClick:()=>o(`/search?q=${encodeURIComponent(n)}`),children:"All"}),e.jsxs("button",{type:"button",className:"search-tab",onClick:()=>o(`/images?q=${encodeURIComponent(n)}`),children:[e.jsx(J,{size:16}),"Images"]}),e.jsxs("button",{type:"button",className:"search-tab active",children:[e.jsx(b,{size:16}),"Videos"]}),e.jsxs("button",{type:"button",className:"search-tab",onClick:()=>o(`/news?q=${encodeURIComponent(n)}`),children:[e.jsx(Q,{size:16}),"News"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center border border-[#dadce0] rounded-full overflow-hidden",children:[e.jsx("button",{type:"button",onClick:()=>y("list"),className:`p-2 transition-colors ${c==="list"?"bg-[#e8f0fe] text-[#1a73e8]":"text-[#5f6368] hover:bg-[#f1f3f4]"}`,title:"List view",children:e.jsx(X,{size:18})}),e.jsx("button",{type:"button",onClick:()=>y("grid"),className:`p-2 transition-colors ${c==="grid"?"bg-[#e8f0fe] text-[#1a73e8]":"text-[#5f6368] hover:bg-[#f1f3f4]"}`,title:"Grid view",children:e.jsx(Z,{size:18})})]}),e.jsxs("div",{className:"relative",ref:x,children:[e.jsxs("button",{type:"button",className:"flex items-center gap-1 px-3 py-1.5 text-sm text-[#5f6368] hover:bg-[#f1f3f4] rounded-full transition-colors",onClick:()=>k(!S),children:["Filters",e.jsx(ee,{size:16})]}),S&&e.jsx("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-[#e8eaed] p-4 z-50",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#202124] mb-2",children:"Duration"}),e.jsx("select",{value:z,onChange:s=>F(s.target.value),className:"w-full px-3 py-2 border border-[#dadce0] rounded-lg text-sm focus:outline-none focus:border-[#1a73e8]",children:te.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[#202124] mb-2",children:"Sort by"}),e.jsx("select",{value:I,onChange:s=>V(s.target.value),className:"w-full px-3 py-2 border border-[#dadce0] rounded-lg text-sm focus:outline-none focus:border-[#1a73e8]",children:ae.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]})]})})]})]})]})]})}),e.jsx("main",{children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:u&&t.length===0?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}):j?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-red-600",children:j})}):t.length>0?e.jsxs(e.Fragment,{children:[c==="list"?e.jsx("div",{className:"space-y-6",children:t.map((s,a)=>e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex gap-4 p-3 rounded-lg hover:bg-[#f8f9fa] transition-colors",onMouseEnter:()=>h(a),onMouseLeave:()=>h(null),children:[e.jsxs("div",{className:"relative flex-shrink-0 w-80 h-44 bg-[#f1f3f4] rounded-lg overflow-hidden",children:[s.thumbnail_url?e.jsx("img",{src:s.thumbnail_url,alt:s.title,className:"w-full h-full object-cover",onError:d=>{d.currentTarget.style.display="none"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(b,{size:48,className:"text-[#9aa0a6]"})}),_===a&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 transition-opacity",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-black/70 flex items-center justify-center",children:e.jsx(C,{size:28,className:"text-white ml-1",fill:"white"})})}),(s.duration||s.duration_seconds)&&e.jsx("span",{className:"absolute bottom-2 right-2 bg-black/80 text-white text-xs px-1.5 py-0.5 rounded",children:s.duration||E(s.duration_seconds)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-[#1a0dab] text-lg font-medium line-clamp-2 hover:underline",children:s.title}),e.jsxs("div",{className:"text-sm text-[#70757a] mt-2 flex items-center gap-2",children:[e.jsx("span",{children:s.channel||s.source_domain||s.engine}),s.views&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{children:L(s.views)})]}),s.published_at&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{children:T(s.published_at)})]})]}),s.description&&e.jsx("p",{className:"text-sm text-[#4d5156] mt-3 line-clamp-2",children:s.description})]})]},`${s.id}-${a}`))}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:t.map((s,a)=>e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"block rounded-lg overflow-hidden hover:shadow-lg transition-shadow bg-white border border-[#e8eaed]",onMouseEnter:()=>h(a),onMouseLeave:()=>h(null),children:[e.jsxs("div",{className:"relative aspect-video bg-[#f1f3f4]",children:[s.thumbnail_url?e.jsx("img",{src:s.thumbnail_url,alt:s.title,className:"w-full h-full object-cover",onError:d=>{d.currentTarget.style.display="none"}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(b,{size:48,className:"text-[#9aa0a6]"})}),_===a&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 transition-opacity",children:e.jsx("div",{className:"w-14 h-14 rounded-full bg-black/70 flex items-center justify-center",children:e.jsx(C,{size:24,className:"text-white ml-0.5",fill:"white"})})}),(s.duration||s.duration_seconds)&&e.jsx("span",{className:"absolute bottom-2 right-2 bg-black/80 text-white text-xs px-1.5 py-0.5 rounded",children:s.duration||E(s.duration_seconds)})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"text-[#202124] text-sm font-medium line-clamp-2",children:s.title}),e.jsxs("div",{className:"text-xs text-[#70757a] mt-2",children:[e.jsx("p",{children:s.channel||s.source_domain||s.engine}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[s.views&&e.jsx("span",{children:L(s.views)}),s.views&&s.published_at&&e.jsx("span",{children:"•"}),s.published_at&&e.jsx("span",{children:T(s.published_at)})]})]})]})]},`${s.id}-${a}`))}),A&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"w-6 h-6 border-3 border-[#1a73e8] border-t-transparent rounded-full animate-spin"})}),!O&&t.length>0&&e.jsx("div",{className:"text-center py-8 text-[#70757a]",children:"No more videos"})]}):n?e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"No videos found"})}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-[#70757a]",children:"Search for videos"})})})}),P&&e.jsx("button",{type:"button",onClick:U,className:"fixed bottom-6 right-6 p-3 bg-[#1a73e8] text-white rounded-full shadow-lg hover:bg-[#1557b0] transition-colors z-40",children:e.jsx(se,{size:20})})]})}export{ce as default};
