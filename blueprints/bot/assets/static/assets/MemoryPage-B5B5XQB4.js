import{a,j as s}from"./markdown-Bs6XdLEX.js";import{u as v,I as d}from"./index-CaXNju9V.js";import"./react-vendor-ZmPOmYi1.js";function b({gw:n}){const[t,m]=a.useState(""),[i,p]=a.useState([]),[l,x]=a.useState(null),[c,h]=a.useState(!1),[u,j]=a.useState(!1),{toast:f}=v(),r=a.useCallback(()=>{n.rpc("memory.stats").then(e=>{x({files:e.files,chunks:e.chunks})}).catch(()=>{})},[n]);a.useEffect(()=>{r()},[r]);function o(){t.trim()&&(h(!0),j(!0),n.rpc("memory.search",{query:t.trim(),limit:20}).then(e=>{p(e.results||[])}).catch(e=>{f("Search failed: "+e.message,"error")}).finally(()=>h(!1)))}return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"card",children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[s.jsxs("div",{children:[s.jsx("div",{className:"card-title",children:"Memory"}),s.jsx("div",{className:"card-sub",children:"Search indexed workspace files and session transcripts."})]}),s.jsxs("button",{className:"btn btn--sm",onClick:r,children:[s.jsx(d,{name:"refresh"}),s.jsx("span",{children:"Refresh Stats"})]})]}),l&&s.jsxs("div",{className:"chip-row",style:{marginTop:12},children:[s.jsxs("span",{className:"chip",children:[l.files," files indexed"]}),s.jsxs("span",{className:"chip",children:[l.chunks," chunks"]})]}),s.jsxs("div",{style:{display:"flex",gap:8,marginTop:16},children:[s.jsx("div",{className:"field",style:{flex:1},children:s.jsx("input",{type:"text",placeholder:"Search memory...",value:t,onChange:e=>m(e.target.value),onKeyDown:e=>{e.key==="Enter"&&o()}})}),s.jsxs("button",{className:"btn primary",onClick:o,disabled:c||!t.trim(),children:[c?s.jsx("div",{className:"spinner",style:{width:16,height:16}}):s.jsx(d,{name:"search"}),s.jsx("span",{children:"Search"})]})]})]}),u&&s.jsxs("div",{className:"card",style:{marginTop:16},children:[s.jsxs("div",{className:"card-title",children:["Results ",i.length>0&&`(${i.length})`]}),c?s.jsx("div",{className:"empty-state",children:s.jsx("div",{className:"spinner"})}):i.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("div",{className:"empty-state-icon",children:s.jsx(d,{name:"search",size:36})}),s.jsxs("div",{children:['No results found for "',t,'"']})]}):s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12,marginTop:12},children:i.map((e,y)=>s.jsxs("div",{className:"card",style:{padding:"12px 16px"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[s.jsx("div",{className:"mono",style:{fontSize:13,fontWeight:600},children:e.path}),s.jsxs("div",{className:"chip-row",children:[s.jsx("span",{className:"chip",children:e.source}),s.jsxs("span",{className:"chip",children:["L",e.startLine,"-",e.endLine]}),s.jsxs("span",{className:"chip chip-ok",children:[(e.score*100).toFixed(0),"%"]})]})]}),s.jsx("pre",{className:"code-block",style:{margin:0,fontSize:12,maxHeight:200,overflow:"auto"},children:e.snippet})]},y))})]})]})}export{b as MemoryPage};
