import{b as l,j as s,H as p}from"./index-Cw4N14fR.js";import{h as D,r,L as B}from"./react-vendor-bJoUFh3v.js";import{B as C}from"./BookCard-BlpznVRs.js";import{C as E,B as z,U as L,G as $,D as F}from"./ui-Fk1kDDOZ.js";import"./ShelfButton-W543rZE7.js";import"./middleware-WYGlAF-S.js";function T(){const{id:c}=D(),[e,x]=r.useState(null),[o,j]=r.useState([]),[h,f]=r.useState(!0),[g,N]=r.useState(null),[i,b]=r.useState(""),[k,w]=r.useState(!1),[d,v]=r.useState(!1),[m,y]=r.useState(0),n=Number(c);r.useEffect(()=>{if(!c)return;(async()=>{f(!0),N(null);try{const[a,u]=await Promise.all([l.getAuthor(n),l.getAuthorBooks(n)]);x(a),j(u.books),v(u.has_more),y(u.total)}catch(a){N(a instanceof Error?a.message:"Failed to load author")}finally{f(!1)}})()},[c,n]),r.useEffect(()=>{if(!d||h)return;const t=setInterval(async()=>{try{const a=await l.getAuthorBooks(n);j(a.books),v(a.has_more),y(a.total),a.has_more||clearInterval(t)}catch{}},8e3);return()=>clearInterval(t)},[d,h,n]);const A=async()=>{if(i.trim()){w(!0);try{const t=await l.importSourceAuthor(i.trim());x(a=>a?{...a,...t}:t),b("")}catch{}finally{w(!1)}}};if(h)return s.jsxs(s.Fragment,{children:[s.jsx(p,{}),s.jsx("div",{className:"loading-spinner",children:s.jsx("div",{className:"spinner"})})]});if(g||!e)return s.jsxs(s.Fragment,{children:[s.jsx(p,{}),s.jsx("div",{className:"page-container",children:s.jsxs("div",{className:"empty-state",children:[s.jsx("h3",{children:"Author not found"}),s.jsx("p",{children:g||"This author does not exist."}),s.jsx(B,{to:"/browse",className:"btn btn-secondary",children:"Browse books"})]})})]});const S=()=>{const t=[];return e.birth_date&&t.push(`Born ${e.birth_date}`),e.death_date&&t.push(`Died ${e.death_date}`),t.join(" â€¢ ")},_=e.genres?e.genres.split(", ").filter(Boolean):[],I=e.influences?e.influences.split(", ").filter(Boolean):[];return s.jsxs(s.Fragment,{children:[s.jsx(p,{}),s.jsxs("div",{className:"page-container fade-in",children:[s.jsxs("div",{className:"author-layout",children:[s.jsx("div",{className:"author-photo-wrap",children:e.photo_url?s.jsx("img",{src:e.photo_url,alt:e.name,className:"author-photo"}):s.jsx("div",{className:"author-photo-placeholder",children:e.name.charAt(0)})}),s.jsxs("div",{className:"author-content",children:[s.jsx("h1",{className:"author-name",children:e.name}),(e.birth_date||e.death_date)&&s.jsxs("p",{className:"author-date-row",children:[s.jsx(E,{size:14}),S()]}),e.bio&&s.jsx("div",{className:"author-bio",children:e.bio}),s.jsxs("div",{className:"author-stats-row",children:[s.jsxs("span",{className:"meta-with-icon",children:[s.jsx(z,{size:14}),e.works_count," book",e.works_count!==1?"s":""]}),e.followers>0&&s.jsxs("span",{className:"meta-with-icon",children:[s.jsx(L,{size:14}),e.followers.toLocaleString()," followers"]})]}),_.length>0&&s.jsx("div",{className:"genre-list",children:_.map(t=>s.jsx(B,{to:`/genre/${encodeURIComponent(t)}`,className:"genre-tag",children:t},t))}),I.length>0&&s.jsxs("div",{className:"author-note",children:[s.jsx("strong",{children:"Influences:"})," ",I.join(", ")]}),e.website&&s.jsx("div",{className:"author-link-row",children:s.jsxs("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"meta-link",children:[s.jsx($,{size:13}),"Author website"]})}),e.source_id&&s.jsx("div",{className:"author-link-row",children:s.jsx("a",{href:`https://www.goodreads.com/author/show/${e.source_id}`,target:"_blank",rel:"noopener noreferrer",className:"meta-link",children:"View source profile"})}),!e.source_id&&s.jsxs("div",{className:"author-import-row",children:[s.jsx("input",{type:"text",value:i,onChange:t=>b(t.target.value),placeholder:"Source author ID",className:"form-input author-import-input"}),s.jsxs("button",{className:"btn btn-secondary btn-sm",onClick:A,disabled:k||!i.trim(),children:[s.jsx(F,{size:14}),k?"Importing...":"Import"]})]})]})]}),s.jsxs("section",{children:[s.jsx("div",{className:"section-header",children:s.jsxs("span",{className:"section-title",children:["Books by ",e.name,o.length>0&&s.jsxs("span",{className:"section-count",children:[o.length,m>o.length?` of ${m}`:""]})]})}),o.length>0?s.jsxs("div",{children:[o.map(t=>s.jsx(C,{book:t},t.id)),d&&s.jsxs("div",{className:"loading-more-bar",children:[s.jsx("div",{className:"spinner spinner-sm"}),s.jsxs("span",{children:["Loading more books (",o.length," of ",m,")..."]})]})]}):s.jsxs("div",{className:"empty-state",children:[s.jsx("h3",{children:"No books found"}),s.jsx("p",{children:"No books by this author are in the library yet."})]})]})]})]})}export{T as default};
