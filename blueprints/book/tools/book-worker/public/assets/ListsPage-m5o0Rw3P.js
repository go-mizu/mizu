import{b as g,j as s,H as G}from"./index-nVKRkTIH.js";import{r as i,L as x}from"./react-vendor-bJoUFh3v.js";import{m as E,S as $,B as A,U as O,n as R}from"./ui-Fk1kDDOZ.js";function Q(){const[a,C]=i.useState([]),[j,T]=i.useState([]),[h,w]=i.useState(""),[F,p]=i.useState(!0),[l,N]=i.useState(""),[f,v]=i.useState(!1),[m,c]=i.useState(null),[L,_]=i.useState([]),S=e=>{p(!0),g.getLists(e).then(({lists:t,tags:B})=>{C(t),T(B)}).catch(()=>{}).finally(()=>p(!1))};i.useEffect(()=>{S(),g.getGenres().then(_).catch(()=>{})},[]);const b=e=>{const t=h===e?"":e;w(t),N(""),c(null),S(t||void 0)},y=i.useCallback(e=>{if(!e.trim()){c(null);return}v(!0),g.searchLists(e).then(c).catch(()=>c([])).finally(()=>v(!1))},[]);i.useEffect(()=>{if(!l.trim()){c(null);return}const e=setTimeout(()=>y(l),400);return()=>clearTimeout(e)},[l,y]);const r=i.useMemo(()=>{if(m)return m;if(!l.trim())return a;const e=l.toLowerCase();return a.filter(t=>t.title.toLowerCase().includes(e)||(t.description||"").toLowerCase().includes(e)||(t.tag||"").toLowerCase().includes(e))},[a,l,m]),k=r.filter(e=>!e.source_url),o=r.filter(e=>e.source_url),d={};for(const e of o){const t=e.tag||"other";d[t]||(d[t]=[]),d[t].push(e)}const z=Object.keys(d).sort(),n=!!l.trim();return s.jsxs(s.Fragment,{children:[s.jsx(G,{}),s.jsxs("div",{className:"page-container",children:[s.jsxs("div",{className:"listopia-header",children:[s.jsx("h1",{className:"page-title page-title-lg",children:"Listopia"}),s.jsx("p",{className:"page-subtitle",children:"Curated book lists voted by millions of readers"}),s.jsxs("div",{className:"listopia-search",children:[f?s.jsx(E,{size:16,className:"listopia-search-icon spin"}):s.jsx($,{size:16,className:"listopia-search-icon"}),s.jsx("input",{className:"form-input listopia-search-input",value:l,onChange:e=>N(e.target.value),placeholder:"Search lists (e.g. fantasy, thriller, 2024)..."})]})]}),j.length>0&&!n&&s.jsxs("div",{className:"list-tag-bar",children:[s.jsx("button",{className:`list-tag-pill ${h?"":"active"}`,onClick:()=>b(""),children:"All"}),j.map(e=>s.jsx("button",{className:`list-tag-pill ${h===e?"active":""}`,onClick:()=>b(e),children:e},e))]}),F?s.jsx("div",{className:"loading-spinner",children:s.jsx("div",{className:"spinner"})}):r.length===0?s.jsx("div",{className:"empty-state",children:f?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"loading-spinner",children:s.jsx("div",{className:"spinner"})}),s.jsxs("p",{children:['Searching Goodreads for "',l,'"...']})]}):n?s.jsxs(s.Fragment,{children:[s.jsxs("h3",{children:['No lists found for "',l,'"']}),s.jsx("p",{children:"Try a different search term like a genre or topic."})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{children:"No lists yet"}),s.jsx("p",{children:"Lists are being imported. Please refresh in a moment."})]})}):s.jsxs(s.Fragment,{children:[n&&s.jsxs("p",{className:"page-subtitle",style:{marginBottom:16},children:[r.length," list",r.length!==1?"s":""," found",m&&" from Goodreads"]}),k.length>0&&s.jsxs("section",{className:"list-section",children:[!n&&s.jsx("h2",{className:"list-section-heading",children:"My Lists"}),s.jsx("div",{className:"list-grid",children:k.map(e=>s.jsx(u,{list:e},e.id))})]}),n?o.length>0&&s.jsx("section",{className:"list-section",children:s.jsx("div",{className:"list-grid",children:o.map(e=>s.jsx(u,{list:e},e.id))})}):h?o.length>0&&s.jsx("section",{className:"list-section",children:s.jsx("div",{className:"list-grid",children:o.map(e=>s.jsx(u,{list:e},e.id))})}):z.map(e=>s.jsxs("section",{className:"list-section",children:[s.jsx("h2",{className:"list-section-heading",children:e}),s.jsx("div",{className:"list-grid",children:d[e].map(t=>s.jsx(u,{list:t},t.id))})]},e))]}),L.length>0&&!n&&s.jsxs("section",{className:"list-section",style:{marginTop:36},children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{className:"list-section-heading",children:"Browse by Genre"}),s.jsx(x,{to:"/browse",className:"section-link",children:"View all"})]}),s.jsx("div",{className:"genre-list",children:L.slice(0,24).map(e=>s.jsxs(x,{to:`/genre/${e.slug}`,className:"genre-tag",children:[e.name,s.jsx("span",{className:"genre-count",children:e.book_count})]},e.slug))})]})]})]})}function u({list:a}){return s.jsxs(x,{to:`/list/${a.id}`,className:"local-list-card",children:[s.jsx("h3",{className:"local-list-title",children:a.title}),a.description&&s.jsx("p",{className:"local-list-description",children:a.description}),s.jsxs("div",{className:"local-list-meta",children:[s.jsxs("span",{className:"source-meta-item",children:[s.jsx(A,{size:12})," ",a.item_count," books"]}),a.voter_count>0&&s.jsxs("span",{className:"source-meta-item",children:[s.jsx(O,{size:12})," ",a.voter_count.toLocaleString()," voters"]}),a.tag&&s.jsxs("span",{className:"source-meta-item list-tag-badge",children:[s.jsx(R,{size:10})," ",a.tag]})]})]})}export{Q as default};
