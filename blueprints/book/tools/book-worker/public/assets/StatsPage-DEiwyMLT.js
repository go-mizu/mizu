import{b as p,j as s,H as u,S as _}from"./index-C0ggNRUQ.js";import{r as c}from"./react-vendor-bJoUFh3v.js";import{B as o}from"./BookCard-CLZy17Rd.js";import{p as k}from"./ui-DGMHXml3.js";import"./ShelfButton-C8sue-27.js";import"./middleware-WYGlAF-S.js";const j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(){const d=new Date().getFullYear(),[l,b]=c.useState(d),[a,h]=c.useState(null),[g,m]=c.useState(!0);c.useEffect(()=>{m(!0),p.getStatsByYear(l).then(h).catch(()=>h(null)).finally(()=>m(!1))},[l]);const N=Array.from({length:5},(e,t)=>d-t),x=a?.books_per_month?Math.max(1,...Object.values(a.books_per_month)):1;return s.jsxs(s.Fragment,{children:[s.jsx(u,{}),s.jsxs("div",{className:"page-container",children:[s.jsx("div",{className:"section-header",children:s.jsxs("h1",{className:"section-title section-title-with-icon",children:[s.jsx(k,{size:24}),"Year in Books"]})}),s.jsx("div",{className:"tabs tabs-spaced",children:N.map(e=>s.jsx("button",{className:`tab ${e===l?"active":""}`,onClick:()=>b(e),children:e},e))}),g?s.jsx("div",{className:"loading-spinner",children:s.jsx("div",{className:"spinner"})}):a?s.jsxs("div",{className:"fade-in",children:[s.jsxs("div",{className:"stats-summary-grid",children:[s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:a.total_books}),s.jsx("div",{className:"stat-label",children:"Books Read"})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:a.total_pages.toLocaleString()}),s.jsx("div",{className:"stat-label",children:"Pages Read"})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:a.average_rating.toFixed(1)}),s.jsx("div",{className:"stat-label",children:"Avg Rating"})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:a.total_books>0?Math.round(a.total_pages/a.total_books):0}),s.jsx("div",{className:"stat-label",children:"Avg Pages"})]})]}),s.jsxs("div",{className:"stats-section",children:[s.jsx("h2",{className:"section-title",children:"Books by Month"}),s.jsx("div",{className:"bar-chart bar-chart-spaced",children:j.map((e,t)=>{const n=String(t+1),i=a.books_per_month?.[n]||0,r=x>0?i/x*100:0;return s.jsxs("div",{className:"bar",style:{height:`${Math.max(r,2)}%`},children:[s.jsx("span",{className:"bar-label",children:e}),i>0&&s.jsx("span",{className:"bar-value",children:i})]},e)})})]}),a.pages_per_month&&Object.values(a.pages_per_month).some(e=>e>0)&&s.jsxs("div",{className:"stats-section",children:[s.jsx("h2",{className:"section-title",children:"Pages by Month"}),s.jsx("div",{className:"bar-chart bar-chart-spaced",children:j.map((e,t)=>{const n=String(t+1),i=a.pages_per_month?.[n]||0,r=Math.max(1,...Object.values(a.pages_per_month)),v=r>0?i/r*100:0;return s.jsxs("div",{className:"bar",style:{height:`${Math.max(v,2)}%`},children:[s.jsx("span",{className:"bar-label",children:e}),i>0&&s.jsx("span",{className:"bar-value",children:i.toLocaleString()})]},e)})})]}),s.jsxs("div",{className:"stats-section",children:[s.jsx("h2",{className:"section-title",children:"Rating Distribution"}),s.jsx("div",{className:"stats-rating-list",children:[5,4,3,2,1].map(e=>{const t=a.rating_distribution?.[String(e)]||0,n=Math.max(1,...Object.values(a.rating_distribution||{})),i=n>0?t/n*100:0;return s.jsxs("div",{className:"stats-rating-row",children:[s.jsx("div",{className:"stats-rating-stars",children:s.jsx(_,{rating:e,size:14})}),s.jsx("div",{className:"stats-rating-track",children:s.jsx("div",{className:"stats-rating-fill",style:{width:`${i}%`}})}),s.jsx("span",{className:"stats-rating-count",children:t})]},e)})})]}),a.genre_breakdown&&Object.keys(a.genre_breakdown).length>0&&s.jsxs("div",{className:"stats-section",children:[s.jsx("h2",{className:"section-title",children:"Genres"}),s.jsx("div",{className:"genre-list",children:Object.entries(a.genre_breakdown).sort(([,e],[,t])=>t-e).slice(0,20).map(([e,t])=>s.jsxs("span",{className:"genre-tag",children:[e," (",t,")"]},e))})]}),s.jsxs("div",{className:"stats-notable-grid",children:[a.shortest_book&&s.jsxs("div",{children:[s.jsx("h3",{className:"stats-notable-label",children:"Shortest Book"}),s.jsx(o,{book:a.shortest_book})]}),a.longest_book&&s.jsxs("div",{children:[s.jsx("h3",{className:"stats-notable-label",children:"Longest Book"}),s.jsx(o,{book:a.longest_book})]}),a.highest_rated&&s.jsxs("div",{children:[s.jsx("h3",{className:"stats-notable-label",children:"Highest Rated"}),s.jsx(o,{book:a.highest_rated})]})]})]}):s.jsxs("div",{className:"empty-state",children:[s.jsxs("h3",{children:["No reading data for ",l]}),s.jsx("p",{children:"Start reading and tracking books to see your stats."})]})]})]})}export{O as default};
