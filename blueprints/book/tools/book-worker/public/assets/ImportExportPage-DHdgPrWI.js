import{j as e,H as D,b as n}from"./index-_5h7tsLS.js";import{r as t}from"./react-vendor-bJoUFh3v.js";import{g as y,F as R,q as S,B as E,s as V,D as k}from"./ui-hgVKSatf.js";function A(){const[C,c]=t.useState(!1),[p,d]=t.useState(null),[m,o]=t.useState(null),[w,l]=t.useState(!1),u=t.useRef(null),[a,h]=t.useState(""),[i,x]=t.useState(!1),[g,f]=t.useState(null),[j,N]=t.useState(null),b=async s=>{if(!s.name.endsWith(".csv")){o("Please upload a CSV file");return}c(!0),o(null),d(null);try{const r=await n.importCSV(s);d(r)}catch{o("Failed to import CSV file")}finally{c(!1)}},I=s=>{s.preventDefault(),l(!1);const r=s.dataTransfer.files[0];r&&b(r)},z=s=>{const r=s.target.files?.[0];r&&b(r)},v=async()=>{if(a.trim()){x(!0),N(null),f(null);try{const s=await n.importSourceBook(a.trim());f({title:s.title}),h("")}catch{N("Failed to import from the catalog source. Check the URL and try again.")}finally{x(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(D,{}),e.jsxs("div",{className:"page-container page-narrow-wide",children:[e.jsx("h1",{className:"page-title page-title-lg",children:"Import & Export"}),e.jsxs("section",{className:"import-section",children:[e.jsxs("h2",{className:"section-title section-title-with-icon",children:[e.jsx(y,{size:20}),"Import Library"]}),e.jsx("p",{className:"page-subtitle",children:"Upload a CSV file containing your book library. The CSV should include columns like Title, Author, ISBN, Rating, and Shelf."}),e.jsxs("div",{className:`dropzone${w?" active":""}`,onDragOver:s=>{s.preventDefault(),l(!0)},onDragLeave:()=>l(!1),onDrop:I,onClick:()=>u.current?.click(),children:[e.jsx(R,{size:36,className:"dropzone-icon"}),e.jsxs("p",{className:"dropzone-title",children:["Drop your CSV file here, or ",e.jsx("span",{className:"dropzone-link",children:"click to browse"})]}),e.jsx("p",{className:"dropzone-subtitle",children:"Supports standard book library CSV format"}),e.jsx("input",{ref:u,type:"file",accept:".csv",className:"hidden",onChange:z})]}),C&&e.jsxs("div",{className:"import-status-row",children:[e.jsx("div",{className:"spinner spinner-sm"})," Importing..."]}),p&&e.jsxs("div",{className:"import-status-row success",children:[e.jsx(S,{size:16})," Successfully imported ",p.imported," books"]}),m&&e.jsx("div",{className:"import-status-row error",children:m})]}),e.jsxs("section",{className:"import-section",children:[e.jsxs("h2",{className:"section-title section-title-with-icon",children:[e.jsx(E,{size:20}),"Import from Catalog URL"]}),e.jsx("p",{className:"page-subtitle",children:"Paste a supported book URL to import all book details including ratings, description, genres, and reviews."}),e.jsxs("div",{className:"catalog-import-row",children:[e.jsx("input",{type:"text",value:a,onChange:s=>h(s.target.value),onKeyDown:s=>s.key==="Enter"&&v(),placeholder:"https://example.com/book/...",className:"form-input",disabled:i}),e.jsxs("button",{className:"btn btn-primary",onClick:v,disabled:i||!a.trim(),children:[i?e.jsx(V,{size:16,className:"spin"}):e.jsx(y,{size:16}),i?"Importing...":"Import"]})]}),g&&e.jsxs("div",{className:"import-status-row success",children:[e.jsx(S,{size:16}),' Imported "',g.title,'" successfully']}),j&&e.jsx("div",{className:"import-status-row error",children:j})]}),e.jsxs("section",{className:"import-section",children:[e.jsxs("h2",{className:"section-title section-title-with-icon",children:[e.jsx(k,{size:20}),"Export Library"]}),e.jsx("p",{className:"page-subtitle",children:"Download your library as a CSV file. Includes all books, ratings, reviews, shelves, and reading dates."}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>n.exportCSV(),children:[e.jsx(k,{size:16})," Export as CSV"]})]})]})]})}export{A as default};
