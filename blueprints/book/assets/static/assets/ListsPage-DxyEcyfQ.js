import{b as p,j as s,H as G}from"./index-Cw4N14fR.js";import{r as i,L as N}from"./react-vendor-bJoUFh3v.js";import{m as E,S as $,B as A,U as O,n as R}from"./ui-Fk1kDDOZ.js";function Q(){const[t,h]=i.useState([]),[m,j]=i.useState([]),[u,_]=i.useState(""),[w,f]=i.useState(!0),[l,v]=i.useState(""),[L,b]=i.useState(!1),[g,n]=i.useState(null),[S,z]=i.useState([]),y=e=>{f(!0),p.getLists(e).then(({lists:a,tags:F})=>{h(a),j(F)}).catch(()=>{}).finally(()=>f(!1))};i.useEffect(()=>{y(),p.getGenres().then(z).catch(()=>{})},[]);const k=e=>{const a=u===e?"":e;_(a),v(""),n(null),y(a||void 0)},C=i.useCallback(e=>{if(!e.trim()){n(null);return}b(!0),p.searchLists(e).then(n).catch(()=>n([])).finally(()=>b(!1))},[]);i.useEffect(()=>{if(!l.trim()){n(null);return}const e=setTimeout(()=>C(l),400);return()=>clearTimeout(e)},[l,C]);const r=i.useMemo(()=>{if(g)return g;if(!l.trim())return t;const e=l.toLowerCase();return t.filter(a=>a.title.toLowerCase().includes(e)||(a.description||"").toLowerCase().includes(e)||(a.tag||"").toLowerCase().includes(e))},[t,l,g]),T=r.filter(e=>!e.source_url),o=r.filter(e=>e.source_url),d={};for(const e of o){const a=e.tag||"other";d[a]||(d[a]=[]),d[a].push(e)}const B=Object.keys(d).sort(),c=!!l.trim();return s.jsxs(s.Fragment,{children:[s.jsx(G,{}),s.jsxs("div",{className:"page-container",children:[s.jsxs("div",{className:"listopia-header",children:[s.jsx("h1",{className:"page-title page-title-lg",children:"Listopia"}),s.jsx("p",{className:"page-subtitle",children:"Curated book lists voted by millions of readers"}),s.jsxs("div",{className:"listopia-search",children:[L?s.jsx(E,{size:16,className:"listopia-search-icon spin"}):s.jsx($,{size:16,className:"listopia-search-icon"}),s.jsx("input",{className:"form-input listopia-search-input",value:l,onChange:e=>v(e.target.value),placeholder:"Search lists (e.g. fantasy, thriller, 2024)..."})]})]}),m.length>0&&!c&&s.jsxs("div",{className:"list-tag-bar",children:[s.jsx("button",{className:`list-tag-pill ${u?"":"active"}`,onClick:()=>k(""),children:"All"}),m.map(e=>s.jsx("button",{className:`list-tag-pill ${u===e?"active":""}`,onClick:()=>k(e),children:e},e))]}),w?s.jsx("div",{className:"loading-spinner",children:s.jsx("div",{className:"spinner"})}):r.length===0?s.jsx("div",{className:"empty-state",children:L?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"loading-spinner",children:s.jsx("div",{className:"spinner"})}),s.jsxs("p",{children:['Searching Goodreads for "',l,'"...']})]}):c?s.jsxs(s.Fragment,{children:[s.jsxs("h3",{children:['No lists found for "',l,'"']}),s.jsx("p",{children:"Try a different search term like a genre or topic."})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{children:"No lists yet"}),s.jsx("p",{children:"Lists are being imported. Please refresh in a moment."})]})}):s.jsxs(s.Fragment,{children:[c&&s.jsxs("p",{className:"page-subtitle",style:{marginBottom:16},children:[r.length," list",r.length!==1?"s":""," found",g&&" from Goodreads"]}),T.length>0&&s.jsxs("section",{className:"list-section",children:[!c&&s.jsx("h2",{className:"list-section-heading",children:"My Lists"}),s.jsx("div",{className:"list-grid",children:T.map(e=>s.jsx(x,{list:e},e.id))})]}),c?o.length>0&&s.jsx("section",{className:"list-section",children:s.jsx("div",{className:"list-grid",children:o.map(e=>s.jsx(x,{list:e},e.id))})}):u?o.length>0&&s.jsx("section",{className:"list-section",children:s.jsx("div",{className:"list-grid",children:o.map(e=>s.jsx(x,{list:e},e.id))})}):B.map(e=>s.jsxs("section",{className:"list-section",children:[s.jsx("h2",{className:"list-section-heading",children:e}),s.jsx("div",{className:"list-grid",children:d[e].map(a=>s.jsx(x,{list:a},a.id))})]},e))]}),S.length>0&&!c&&s.jsxs("section",{className:"list-section",style:{marginTop:36},children:[s.jsxs("div",{className:"section-header",children:[s.jsx("h2",{className:"list-section-heading",children:"Browse by Genre"}),s.jsx(N,{to:"/browse",className:"section-link",children:"View all"})]}),s.jsx("div",{className:"genre-list",children:S.slice(0,24).map(e=>s.jsxs(N,{to:`/genre/${e.slug}`,className:"genre-tag",children:[e.name,s.jsx("span",{className:"genre-count",children:e.book_count})]},e.slug))})]})]})]})}function x({list:t}){const h=t.cover_urls?t.cover_urls.split("||").filter(Boolean).slice(0,5):[];return s.jsxs(N,{to:`/list/${t.id}`,className:"local-list-card",children:[h.length>0&&s.jsx("div",{className:"list-cover-strip",children:h.map((m,j)=>s.jsx("img",{src:m,alt:"",className:"list-cover-thumb",loading:"lazy"},j))}),s.jsx("h3",{className:"local-list-title",children:t.title}),t.description&&s.jsx("p",{className:"local-list-description",children:t.description}),s.jsxs("div",{className:"local-list-meta",children:[s.jsxs("span",{className:"source-meta-item",children:[s.jsx(A,{size:12})," ",t.item_count," books"]}),t.voter_count>0&&s.jsxs("span",{className:"source-meta-item",children:[s.jsx(O,{size:12})," ",t.voter_count.toLocaleString()," voters"]}),t.tag&&s.jsxs("span",{className:"source-meta-item list-tag-badge",children:[s.jsx(R,{size:10})," ",t.tag]})]})]})}export{Q as default};
