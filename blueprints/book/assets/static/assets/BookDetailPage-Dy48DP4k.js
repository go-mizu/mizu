import{j as e,S as q,b as o,H as ae,B as qe}from"./index-CR0Xjtpx.js";import{r as a,h as Ve,L as Re}from"./react-vendor-bJoUFh3v.js";import{u as ne,S as Je}from"./ShelfButton-RoCdupez.js";import{B as Ke}from"./BookGrid-DUWYRpzv.js";import{B as O,c as Xe,C as Be,H as Ze,G as ze,F as Ie,U as et,Q as tt,E as st,d as it}from"./ui-D_Yei50m.js";import"./middleware-WYGlAF-S.js";function Y(r){return r?new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function at({review:r,onEdit:s,onDelete:c}){const[i,d]=a.useState(r),[h,x]=a.useState(!1),[b,V]=a.useState(!1),[p,S]=a.useState([]),[z,I]=a.useState(!1),[F,L]=a.useState(""),[T,P]=a.useState(!1),[m,_]=a.useState(!1);a.useEffect(()=>{d(r),x(!1),_(!1)},[r]);const W=i.source==="imported",j=i.reviewer_name||(i.source==="user"?"You":i.book?.title?i.book.title.charAt(0).toUpperCase():"R"),M=j.charAt(0).toUpperCase(),k=async()=>{if(!(m||T)){P(!0);try{const l=await o.likeReview(i.id);d({...i,likes_count:l.likes_count}),_(!0)}catch{}finally{P(!1)}}},y=async()=>{I(!0);try{const l=await o.getReviewComments(i.id);S(l.comments||[])}catch{}finally{I(!1)}},N=()=>{const l=!b;V(l),l&&p.length===0&&y()},H=async()=>{const l=F.trim();if(l)try{const f=await o.createReviewComment(i.id,{text:l,author_name:"You"});S([f,...p]),L(""),d({...i,comments_count:(i.comments_count||0)+1})}catch{}},C=async l=>{try{await o.deleteReviewComment(i.id,l),S(p.filter(f=>f.id!==l)),d({...i,comments_count:Math.max(0,(i.comments_count||0)-1)})}catch{}};return e.jsxs("div",{className:"review-card",children:[e.jsxs("div",{className:"review-header",children:[e.jsx("div",{className:"review-avatar",children:M}),e.jsxs("div",{className:"review-main",children:[e.jsxs("div",{className:"review-name-row",children:[e.jsx("span",{className:"review-name",children:j}),W&&e.jsx("span",{className:"review-badge",children:"Imported"})]}),e.jsx(q,{rating:i.rating}),e.jsxs("div",{className:"review-meta",children:[Y(i.created_at),i.likes_count?` · ${i.likes_count} likes`:"",i.comments_count?` · ${i.comments_count} comments`:""]})]}),i.source==="user"&&(s||c)&&e.jsxs("div",{className:"review-owner-actions",children:[s&&e.jsx("button",{className:"link-button",onClick:()=>s(i),children:"Edit"}),c&&e.jsx("button",{className:"link-button",onClick:()=>c(i),children:"Delete"})]})]}),i.text&&i.is_spoiler&&!h?e.jsxs("div",{className:"review-spoiler",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Spoiler"})," · This review contains spoilers."]}),e.jsx("button",{className:"link-button",onClick:()=>x(!0),children:"Reveal"})]}):i.text?e.jsx("div",{className:"review-text",children:i.text}):null,e.jsxs("div",{className:"review-actions",children:[e.jsx("button",{className:"link-button",onClick:k,disabled:T||m,children:m?"Liked":"Like"}),e.jsx("button",{className:"link-button",onClick:N,children:"Comment"})]}),(i.started_at||i.finished_at)&&e.jsxs("div",{className:"review-read-dates",children:[i.started_at&&e.jsxs(e.Fragment,{children:["Started ",Y(i.started_at)]}),i.started_at&&i.finished_at&&e.jsx(e.Fragment,{children:" · "}),i.finished_at&&e.jsxs(e.Fragment,{children:["Finished ",Y(i.finished_at)]})]}),b&&e.jsxs("div",{className:"review-comments",children:[e.jsxs("div",{className:"comment-form",children:[e.jsx("input",{className:"form-input",placeholder:"Add a comment...",value:F,onChange:l=>L(l.target.value)}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:H,disabled:!F.trim(),children:"Post"})]}),z?e.jsx("div",{className:"comment-loading",children:"Loading comments..."}):p.length>0?p.map(l=>e.jsxs("div",{className:"comment-item",children:[e.jsxs("div",{children:[e.jsx("strong",{children:l.author_name})," ",l.text]}),e.jsxs("div",{className:"comment-meta",children:[e.jsx("span",{children:Y(l.created_at)}),l.author_name==="You"&&e.jsx("button",{className:"link-button",onClick:()=>C(l.id),children:"Delete"})]})]},l.id)):e.jsx("div",{className:"comment-empty",children:"No comments yet."})]})]})}function nt({book:r}){const s=r.rating_dist||[0,0,0,0,0],c=s.reduce((d,h)=>d+h,0)||1,i=["5","4","3","2","1"];return e.jsxs("div",{style:{marginBottom:24},children:[e.jsx("h3",{style:{fontFamily:"'Merriweather', Georgia, serif",fontSize:14,fontWeight:700,color:"var(--gr-brown)",marginBottom:12},children:"Rating distribution"}),s.map((d,h)=>{const x=c>0?d/c*100:0;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,fontSize:13},children:[e.jsx("span",{style:{width:16,textAlign:"right",color:"var(--gr-light)",fontWeight:700},children:i[h]}),e.jsx("div",{style:{flex:1,height:10,background:"#eee",borderRadius:2,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${x}%`,background:"var(--gr-star)",borderRadius:2,transition:"width 0.4s ease"}})}),e.jsxs("span",{style:{width:60,textAlign:"right",color:"var(--gr-light)",fontSize:12},children:[d.toLocaleString()," (",Math.round(x),"%)"]})]},h)})]})}function rt({book:r}){return!r.currently_reading&&!r.want_to_read?null:e.jsxs("div",{style:{display:"flex",gap:20,padding:"12px 0",borderTop:"1px solid #eee",borderBottom:"1px solid #eee",marginBottom:16,fontSize:13,color:"var(--gr-light)"},children:[r.currently_reading>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(st,{size:14}),e.jsxs("span",{children:[e.jsx("strong",{style:{color:"var(--gr-text)"},children:r.currently_reading.toLocaleString()})," currently reading"]})]}),r.want_to_read>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(it,{size:14}),e.jsxs("span",{children:[e.jsx("strong",{style:{color:"var(--gr-text)"},children:r.want_to_read.toLocaleString()})," want to read"]})]})]})}function lt({text:r}){const[s,c]=a.useState(!1),i=400;return r.length<=i?e.jsx("div",{style:{fontSize:15,lineHeight:1.7,color:"var(--gr-text)",marginBottom:24},children:r}):e.jsxs("div",{style:{fontSize:15,lineHeight:1.7,color:"var(--gr-text)",marginBottom:24},children:[s?r:r.slice(0,i)+"...",e.jsx("button",{onClick:()=>c(!s),style:{background:"none",border:"none",color:"var(--gr-teal)",cursor:"pointer",fontWeight:700,fontSize:14,marginLeft:4,padding:0},children:s?"less":"more"})]})}function ut(){const{id:r}=Ve(),[s,c]=a.useState(null),[i,d]=a.useState([]),[h,x]=a.useState(0),[b,V]=a.useState([]),[p,S]=a.useState([]),[z,I]=a.useState([]),[F,L]=a.useState(!0),[T,P]=a.useState(null),[m,_]=a.useState("reviews"),[W,j]=a.useState(!1),[M,k]=a.useState(""),[y,N]=a.useState(0),[H,C]=a.useState(!1),[l,f]=a.useState(""),[J,U]=a.useState(""),[$,A]=a.useState(null),[D,K]=a.useState(null),[re,Fe]=a.useState("popular"),[X,Le]=a.useState(0),[Z,Te]=a.useState("all"),[ee,Pe]=a.useState("all"),[le,Ae]=a.useState(""),[oe,De]=a.useState(!1),[Ee,ce]=a.useState(!1),[de,ge]=a.useState(!1),[te,he]=a.useState(""),[me,ue]=a.useState(""),[xe,pe]=a.useState(!1),[ve,fe]=a.useState(!1),[w,We]=a.useState([]),je=ne(t=>t.addRecentBook),se=ne(t=>t.setCurrentBook),Me=ne(t=>t.setShelves),v=Number(r),ye=t=>{if(!t)return"";const n=new Date(t);return Number.isNaN(n.getTime())?"":n.toISOString().slice(0,10)},He=()=>({sort:re,rating:X>0?X:void 0,source:Z==="all"?void 0:Z,has_text:ee==="all"?void 0:ee==="with",q:le.trim()||void 0,include_spoilers:oe}),E=async t=>{ce(!0);try{const n=await o.getReviews(t,He());return d(n.reviews),x(n.total),n.reviews}finally{ce(!1)}};a.useEffect(()=>r?((async()=>{L(!0),P(null);try{const[n,u,R]=await Promise.all([o.getBook(v),o.getSimilar(v),o.getShelves()]),g=await E(v);c(n),V(u),We(R),Me(R),je(n),se(n),o.getBookQuotes(v).then(S).catch(()=>{}),o.getProgress(v).then(I).catch(()=>{}),g.length===0&&(fe(!0),o.enrichBook(v).then(B=>{c(B),E(v).catch(()=>{}),o.getBookQuotes(v).then(S).catch(()=>{})}).catch(()=>{}).finally(()=>fe(!1)))}catch(n){P(n instanceof Error?n.message:"Failed to load book")}finally{L(!1)}})(),()=>se(null)):void 0,[r,v,je,se]),a.useEffect(()=>{if(!$&&s?.user_shelf&&w.length>0){const t=w.find(n=>n.slug===s.user_shelf);t&&A(t.id)}},[s?.user_shelf,w,$]);const Ue=async t=>{if(s)try{await o.createReview(s.id,{rating:t}),c({...s,user_rating:t}),E(s.id).catch(()=>{})}catch{}},$e=async()=>{if(!(!s||y===0)){ge(!0);try{const t={rating:y,text:M,is_spoiler:H,started_at:l||void 0,finished_at:J||void 0},n=D?await o.updateReview(D,t):await o.createReview(s.id,t);d(g=>{const B=g.findIndex(Q=>Q.id===n.id);if(B>=0){const Q=[...g];return Q[B]=n,Q}return[n,...g]}),D||x(g=>g+1);const u=w.find(g=>g.slug==="read"),R=$||(J&&u?u.id:null);if(R){await o.addToShelf(R,s.id);const g=w.find(B=>B.id===R)?.slug;g&&c({...s,user_shelf:g})}E(s.id).catch(()=>{}),j(!1),k(""),N(0),C(!1),f(""),U(""),A(null),K(null),c({...s,user_rating:y})}catch{}finally{ge(!1)}}},Ge=async()=>{if(!s)return;const t=parseInt(te);if(!(!t||t<=0)){pe(!0);try{const n=s.page_count>0?t/s.page_count*100:0,u=await o.updateProgress(s.id,{page:t,percent:Math.min(100,n),note:me||void 0});I([u,...z]),he(""),ue("")}catch{}finally{pe(!1)}}},we=t=>{if(K(t.id),N(t.rating),k(t.text||""),C(!!t.is_spoiler),f(ye(t.started_at)),U(ye(t.finished_at)),s?.user_shelf){const n=w.find(u=>u.slug===s.user_shelf);A(n?n.id:null)}j(!0)},Qe=async t=>{if(s)try{await o.deleteReview(t.id),d(n=>n.filter(u=>u.id!==t.id)),x(n=>Math.max(0,n-1)),c({...s,user_rating:0})}catch{}};if(F)return e.jsxs(e.Fragment,{children:[e.jsx(ae,{}),e.jsx("div",{className:"loading-spinner",children:e.jsx("div",{className:"spinner"})})]});if(T||!s)return e.jsxs(e.Fragment,{children:[e.jsx(ae,{}),e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"empty-state",children:[e.jsx("h3",{children:"Book not found"}),e.jsx("p",{children:T||"This book does not exist."}),e.jsx(Re,{to:"/browse",className:"btn btn-secondary",children:"Browse books"})]})})]});const be=s.subjects||[],Se=s.characters||[],_e=s.settings||[],ke=s.literary_awards||[],G=z.length>0?z[0]:null,Oe=s.rating_dist&&s.rating_dist.some(t=>t>0),Ye=h||s.reviews_count||i.length,ie=i.find(t=>t.source==="user"),Ne=w.filter(t=>t.is_exclusive),Ce=s.editions_count??0;return e.jsxs(e.Fragment,{children:[e.jsx(ae,{}),e.jsxs("div",{className:"page-container fade-in",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"200px 1fr",gap:32,marginBottom:40},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16},children:[e.jsx(qe,{book:s,size:"lg"}),e.jsx(Je,{book:s}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:13,color:"var(--gr-light)",marginBottom:4},children:"Rate this book"}),e.jsx(q,{rating:s.user_rating||0,interactive:!0,onChange:Ue})]}),s.page_count>0&&e.jsxs("div",{style:{width:"100%",padding:12,background:"var(--gr-cream)",borderRadius:8},children:[e.jsx("div",{style:{fontSize:12,fontWeight:700,color:"var(--gr-brown)",marginBottom:8},children:"Track Progress"}),G&&e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("div",{className:"progress-bar",style:{height:6},children:e.jsx("div",{className:"progress-fill",style:{width:`${Math.min(100,G.percent)}%`}})}),e.jsxs("div",{style:{fontSize:11,color:"var(--gr-light)",marginTop:4},children:["Page ",G.page," of ",s.page_count," (",Math.round(G.percent),"%)"]})]}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("input",{type:"number",min:"1",max:s.page_count,value:te,onChange:t=>he(t.target.value),placeholder:"Page #",className:"form-input",style:{fontSize:12,padding:"4px 8px",flex:1}}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:Ge,disabled:xe||!te,style:{fontSize:11,padding:"4px 8px"},children:xe?"...":"Update"})]}),e.jsx("input",{type:"text",value:me,onChange:t=>ue(t.target.value),placeholder:"Add a note (optional)",className:"form-input",style:{fontSize:11,padding:"4px 8px",marginTop:4,width:"100%"}})]})]}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontFamily:"'Merriweather', Georgia, serif",fontSize:28,fontWeight:900,color:"var(--gr-brown)",margin:"0 0 4px",lineHeight:1.3},children:s.title}),s.series&&e.jsx("div",{style:{fontSize:14,color:"var(--gr-light)",marginBottom:8,fontStyle:"italic"},children:s.series}),e.jsxs("p",{className:"book-author",style:{fontSize:16,marginBottom:12},children:["by"," ",e.jsx("span",{style:{color:"var(--gr-text)"},children:s.author_names})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[e.jsx(q,{rating:s.average_rating}),e.jsx("span",{style:{fontWeight:700,fontSize:16},children:s.average_rating?.toFixed(2)})]}),e.jsxs("div",{style:{fontSize:13,color:"var(--gr-light)",marginBottom:16,display:"flex",gap:12},children:[e.jsxs("span",{children:[s.ratings_count?.toLocaleString()," ratings"]}),s.reviews_count>0&&e.jsxs("span",{children:[s.reviews_count.toLocaleString()," reviews"]})]}),e.jsx(rt,{book:s}),s.description&&e.jsx(lt,{text:s.description}),be.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginBottom:20},children:be.map(t=>e.jsx(Re,{to:`/genre/${encodeURIComponent(t)}`,className:"genre-tag",children:t},t))}),Se.length>0&&e.jsxs("div",{style:{marginBottom:14},children:[e.jsx("div",{style:{fontSize:13,color:"var(--gr-light)",marginBottom:6},children:"Characters"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:Se.map(t=>e.jsx("span",{className:"genre-tag",children:t},t))})]}),_e.length>0&&e.jsxs("div",{style:{marginBottom:14},children:[e.jsx("div",{style:{fontSize:13,color:"var(--gr-light)",marginBottom:6},children:"Setting"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:_e.map(t=>e.jsx("span",{className:"genre-tag",children:t},t))})]}),ke.length>0&&e.jsxs("div",{style:{marginBottom:14,fontSize:13,color:"var(--gr-light)"},children:[e.jsx("strong",{style:{color:"var(--gr-text)"},children:"Literary awards:"})," ",ke.join(", ")]}),Oe&&e.jsx(nt,{book:s}),e.jsxs("div",{style:{padding:16,background:"var(--gr-cream)",borderRadius:8,marginBottom:24},children:[e.jsx("h3",{style:{fontFamily:"'Merriweather', Georgia, serif",fontSize:14,fontWeight:700,color:"var(--gr-brown)",marginBottom:12},children:"Book details & editions"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10,fontSize:14},children:[s.format&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(O,{size:14}),e.jsxs("span",{children:[s.format,s.page_count>0?`, ${s.page_count} pages`:""]})]}),!s.format&&s.page_count>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(O,{size:14}),e.jsxs("span",{children:[s.page_count," pages"]})]}),s.publisher&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(Xe,{size:14}),e.jsx("span",{children:s.publisher})]}),s.original_title&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(O,{size:14}),e.jsxs("span",{children:["Original title: ",s.original_title]})]}),s.first_published&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(Be,{size:14}),e.jsxs("span",{children:["First published ",s.first_published]})]}),!s.first_published&&s.publish_year>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(Be,{size:14}),e.jsxs("span",{children:["Published ",s.publish_year]})]}),s.isbn13&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(Ze,{size:14}),e.jsxs("span",{children:["ISBN ",s.isbn13]})]}),s.language&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(ze,{size:14}),e.jsx("span",{children:s.language})]}),s.edition_language&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(ze,{size:14}),e.jsxs("span",{children:["Edition language: ",s.edition_language]})]}),Ce>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(O,{size:14}),e.jsxs("span",{children:[Ce.toLocaleString()," editions"]})]}),s.asin&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(Ie,{size:14}),e.jsxs("span",{children:["ASIN ",s.asin]})]}),s.source_id&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(et,{size:14}),e.jsx("a",{href:s.source_url,target:"_blank",rel:"noopener noreferrer",style:{color:"var(--gr-teal)",textDecoration:"none"},children:"View source page"})]}),s.ol_key&&!s.source_id&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,color:"var(--gr-light)"},children:[e.jsx(Ie,{size:14}),e.jsx("span",{children:s.ol_key})]})]})]})]})]}),e.jsxs("div",{className:"tabs",children:[e.jsxs("button",{className:`tab ${m==="reviews"?"active":""}`,onClick:()=>_("reviews"),children:["Community Reviews (",Ye,")"]}),e.jsxs("button",{className:`tab ${m==="similar"?"active":""}`,onClick:()=>_("similar"),children:["Similar Books (",b.length,")"]}),e.jsxs("button",{className:`tab ${m==="quotes"?"active":""}`,onClick:()=>_("quotes"),children:["Quotes (",p.length,")"]})]}),m==="reviews"&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:8,marginBottom:14,padding:12,background:"var(--gr-cream)",borderRadius:8},children:[e.jsxs("select",{className:"form-input",value:re,onChange:t=>Fe(t.target.value),children:[e.jsx("option",{value:"popular",children:"Popular"}),e.jsx("option",{value:"newest",children:"Newest"}),e.jsx("option",{value:"oldest",children:"Oldest"}),e.jsx("option",{value:"rating_desc",children:"Highest rating"}),e.jsx("option",{value:"rating_asc",children:"Lowest rating"})]}),e.jsxs("select",{className:"form-input",value:X,onChange:t=>Le(Number(t.target.value)),children:[e.jsx("option",{value:0,children:"All ratings"}),e.jsx("option",{value:5,children:"5 stars"}),e.jsx("option",{value:4,children:"4 stars"}),e.jsx("option",{value:3,children:"3 stars"}),e.jsx("option",{value:2,children:"2 stars"}),e.jsx("option",{value:1,children:"1 star"})]}),e.jsxs("select",{className:"form-input",value:Z,onChange:t=>Te(t.target.value),children:[e.jsx("option",{value:"all",children:"All sources"}),e.jsx("option",{value:"imported",children:"Imported"}),e.jsx("option",{value:"user",children:"My reviews"})]}),e.jsxs("select",{className:"form-input",value:ee,onChange:t=>Pe(t.target.value),children:[e.jsx("option",{value:"all",children:"Any text"}),e.jsx("option",{value:"with",children:"With text"}),e.jsx("option",{value:"without",children:"Ratings only"})]}),e.jsx("input",{type:"search",className:"form-input",placeholder:"Search review text",value:le,onChange:t=>Ae(t.target.value)}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>E(s.id),children:"Apply filters"}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13},children:[e.jsx("input",{type:"checkbox",checked:oe,onChange:t=>De(t.target.checked)}),"Show spoilers"]})]}),h>0&&e.jsxs("div",{style:{fontSize:12,color:"var(--gr-light)",marginBottom:12},children:["Showing ",i.length," of ",h," reviews"]}),!W&&e.jsx("button",{className:"btn btn-primary",style:{marginBottom:20},onClick:()=>{ie?we(ie):j(!0)},children:ie?"Edit your review":"Write a review"}),W&&e.jsxs("div",{style:{padding:20,background:"var(--gr-cream)",borderRadius:8,marginBottom:24},children:[e.jsx("h3",{style:{fontFamily:"'Merriweather', Georgia, serif",fontSize:16,color:"var(--gr-brown)",marginBottom:12},children:D?"Edit your review":"Write your review"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Your rating"}),e.jsx(q,{rating:y,interactive:!0,onChange:N,size:24})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Review (optional)"}),e.jsx("textarea",{className:"form-input",placeholder:"What did you think?",value:M,onChange:t=>k(t.target.value)})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:14},children:[e.jsx("input",{type:"checkbox",checked:H,onChange:t=>C(t.target.checked)}),"Contains spoilers"]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Started reading"}),e.jsx("input",{type:"date",className:"form-input",value:l,onChange:t=>f(t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Finished reading"}),e.jsx("input",{type:"date",className:"form-input",value:J,onChange:t=>U(t.target.value)})]})]}),Ne.length>0&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Reading status"}),e.jsxs("select",{className:"form-input",value:$??"",onChange:t=>A(t.target.value?Number(t.target.value):null),children:[e.jsx("option",{value:"",children:"No status"}),Ne.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-primary",onClick:$e,disabled:de||y===0,children:de?"Saving...":D?"Save review":"Post review"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>{j(!1),k(""),N(0),C(!1),f(""),U(""),A(null),K(null)},children:"Cancel"})]})]}),ve&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:16,fontSize:14,color:"var(--gr-light)"},children:[e.jsx("div",{className:"spinner",style:{width:16,height:16,borderWidth:2}}),"Fetching imported community reviews..."]}),Ee&&e.jsx("div",{style:{marginBottom:12,fontSize:13,color:"var(--gr-light)"},children:"Loading reviews..."}),i.length>0?i.map(t=>e.jsx(at,{review:t,onEdit:t.source==="user"?we:void 0,onDelete:t.source==="user"?Qe:void 0},t.id)):ve?null:e.jsxs("div",{className:"empty-state",children:[e.jsx("h3",{children:"No reviews yet"}),e.jsx("p",{children:"Be the first to review this book!"})]})]}),m==="similar"&&e.jsx("div",{children:b.length>0?e.jsx(Ke,{books:b}):e.jsxs("div",{className:"empty-state",children:[e.jsx("h3",{children:"No similar books found"}),e.jsx("p",{children:"Check back later for recommendations."})]})}),m==="quotes"&&e.jsx("div",{children:p.length>0?p.map(t=>e.jsx("div",{style:{padding:20,borderLeft:"3px solid var(--gr-orange)",background:"var(--gr-cream)",borderRadius:"0 8px 8px 0",marginBottom:16},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[e.jsx(tt,{size:16,style:{color:"var(--gr-orange)",flexShrink:0,marginTop:2}}),e.jsxs("div",{children:[e.jsxs("p",{style:{fontSize:15,lineHeight:1.7,color:"var(--gr-text)",fontStyle:"italic",margin:"0 0 8px"},children:["“",t.text,"”"]}),e.jsxs("p",{style:{fontSize:13,color:"var(--gr-light)",margin:0},children:["— ",t.author_name]}),t.likes_count>0&&e.jsxs("p",{style:{fontSize:12,color:"var(--gr-light)",margin:"4px 0 0"},children:[t.likes_count," likes"]})]})]})},t.id)):e.jsxs("div",{className:"empty-state",children:[e.jsx("h3",{children:"No quotes yet"}),e.jsx("p",{children:"Add memorable quotes from this book."})]})})]})]})}export{ut as default};
