import{b as n,j as e,H as F,A as I}from"./index-D7mXrCI9.js";import{r as t,L as A}from"./react-vendor-bJoUFh3v.js";import{D as O,P as H,B as R,U}from"./ui-D_Yei50m.js";function J(){const[x,l]=t.useState([]),[E,W]=t.useState(!0),[M,a]=t.useState(!1),[c,g]=t.useState(""),[f,j]=t.useState(""),[d,y]=t.useState([]),[b,v]=t.useState(!1),[m,S]=t.useState(!1),[p,L]=t.useState(null),[N,u]=t.useState(""),[k,h]=t.useState(""),[C,T]=t.useState(""),[i,w]=t.useState("");t.useEffect(()=>{n.getLists().then(l).catch(()=>{}).finally(()=>W(!1))},[]);const _=()=>{c.trim()&&n.createList({title:c,description:f}).then(s=>{l(r=>[...r,s]),a(!1),g(""),j("")}).catch(()=>{})},z=()=>{if(u(""),d.length>0){S(!m);return}v(!0),S(!0),n.browseSourceLists(C).then(y).catch(s=>{s instanceof I?u(s.message):u("Failed to browse source lists")}).finally(()=>v(!1))},P=()=>{y([]),z()},B=async s=>{const r=s.trim();if(r){h(""),L(r);try{const o=await n.importSourceList(r);l(D=>[...D,o]),i.trim()===r&&w("")}catch(o){o instanceof I?h(o.message):h("Failed to import source list")}finally{L(null)}}};return e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{className:"section-title",children:"Listopia"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:z,children:[e.jsx(O,{size:16})," ",m?"Hide":"Browse"," Source Lists"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>a(!0),children:[e.jsx(H,{size:16})," Create List"]})]})]}),m&&e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:10,flexWrap:"wrap"},children:[e.jsx("input",{className:"form-input",value:C,onChange:s=>T(s.target.value),placeholder:"Optional tag (e.g. fantasy)",style:{maxWidth:260}}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:P,disabled:b,children:"Refresh"})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12,flexWrap:"wrap"},children:[e.jsx("input",{className:"form-input",value:i,onChange:s=>w(s.target.value),placeholder:"Paste source list URL",style:{minWidth:320,flex:1}}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>B(i),disabled:!i.trim()||!!p,children:"Import URL"})]}),e.jsx("h2",{style:{fontFamily:"'Merriweather', Georgia, serif",fontSize:16,color:"var(--gr-brown)",marginBottom:12},children:"Popular Source Lists"}),N&&e.jsx("p",{style:{color:"#9b1c1c",fontSize:13,marginBottom:10},children:N}),k&&e.jsx("p",{style:{color:"#9b1c1c",fontSize:13,marginBottom:10},children:k}),b?e.jsx("div",{className:"loading-spinner",children:e.jsx("div",{className:"spinner"})}):d.length===0?e.jsx("p",{style:{color:"var(--gr-light)",fontSize:14},children:"No lists found."}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:12},children:d.map((s,r)=>e.jsxs("div",{style:{padding:16,border:"1px solid var(--gr-border)",borderRadius:8,display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},children:[e.jsxs("div",{style:{minWidth:0},children:[e.jsx("div",{style:{fontWeight:700,fontSize:14,color:"var(--gr-brown)",marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.title}),e.jsxs("div",{style:{fontSize:12,color:"var(--gr-light)",display:"flex",gap:12},children:[s.tag&&e.jsxs("span",{children:["#",s.tag]}),s.book_count>0&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:3},children:[e.jsx(R,{size:11})," ",s.book_count.toLocaleString()," books"]}),s.voter_count>0&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:3},children:[e.jsx(U,{size:11})," ",s.voter_count.toLocaleString()," voters"]})]})]}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>B(s.url),disabled:p===s.url,style:{flexShrink:0},children:p===s.url?"...":"Import"})]},r))})]}),E?e.jsx("div",{className:"loading-spinner",children:e.jsx("div",{className:"spinner"})}):x.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("h3",{children:"No lists yet"}),e.jsx("p",{children:"Create your first book list or import from a source list URL."}),e.jsx("button",{className:"btn btn-primary",onClick:()=>a(!0),children:"Create List"})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:12},children:x.map(s=>e.jsxs(A,{to:`/list/${s.id}`,style:{display:"block",padding:16,border:"1px solid var(--gr-border)",borderRadius:8,textDecoration:"none",color:"inherit",transition:"background 0.15s"},onMouseEnter:r=>r.currentTarget.style.background="var(--gr-cream)",onMouseLeave:r=>r.currentTarget.style.background="",children:[e.jsx("h3",{style:{fontFamily:"'Merriweather', Georgia, serif",fontWeight:700,fontSize:15,color:"var(--gr-brown)",margin:"0 0 4px"},children:s.title}),s.description&&e.jsx("p",{style:{fontSize:13,color:"var(--gr-light)",marginBottom:8,overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:s.description}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,fontSize:12,color:"var(--gr-light)"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:3},children:[e.jsx(R,{size:12})," ",s.item_count," books"]}),s.voter_count>0&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:3},children:[e.jsx(U,{size:12})," ",s.voter_count.toLocaleString()," voters"]})]})]},s.id))}),M&&e.jsx("div",{className:"modal-overlay",onClick:()=>a(!1),children:e.jsxs("div",{className:"modal",onClick:s=>s.stopPropagation(),children:[e.jsx("h2",{children:"Create New List"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Title"}),e.jsx("input",{className:"form-input",value:c,onChange:s=>g(s.target.value),placeholder:"Best Books of 2024"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{className:"form-input",value:f,onChange:s=>j(s.target.value),placeholder:"A curated list of..."})]}),e.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>a(!1),children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:_,children:"Create"})]})]})})]})]})}export{J as default};
