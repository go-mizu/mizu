import{j as e,H as w,b as n}from"./index-D7mXrCI9.js";import{r as s}from"./react-vendor-bJoUFh3v.js";import{e as y,F as E,o as S,B as V,q as z,D as C}from"./ui-D_Yei50m.js";function A(){const[k,c]=s.useState(!1),[m,d]=s.useState(null),[x,i]=s.useState(null),[I,o]=s.useState(!1),p=s.useRef(null),[a,u]=s.useState(""),[l,g]=s.useState(!1),[h,f]=s.useState(null),[b,j]=s.useState(null),N=async t=>{if(!t.name.endsWith(".csv")){i("Please upload a CSV file");return}c(!0),i(null),d(null);try{const r=await n.importCSV(t);d(r)}catch{i("Failed to import CSV file")}finally{c(!1)}},D=t=>{t.preventDefault(),o(!1);const r=t.dataTransfer.files[0];r&&N(r)},R=t=>{const r=t.target.files?.[0];r&&N(r)},v=async()=>{if(a.trim()){g(!0),j(null),f(null);try{const t=await n.importSourceBook(a.trim());f({title:t.title}),u("")}catch{j("Failed to import from the catalog source. Check the URL and try again.")}finally{g(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx(w,{}),e.jsxs("div",{className:"page-container",style:{maxWidth:700,margin:"0 auto"},children:[e.jsx("h1",{className:"font-serif text-2xl font-bold text-gr-brown mb-8",children:"Import & Export"}),e.jsxs("div",{className:"mb-10",children:[e.jsxs("h2",{className:"section-title mb-4",children:[e.jsx(y,{size:20,className:"inline mr-2"}),"Import Library"]}),e.jsx("p",{className:"text-sm text-gr-light mb-4",children:"Upload a CSV file containing your book library. The CSV should include columns like Title, Author, ISBN, Rating, and Shelf."}),e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-10 text-center transition-colors cursor-pointer ${I?"border-gr-teal bg-gr-cream":"border-gr-border hover:border-gr-teal"}`,onDragOver:t=>{t.preventDefault(),o(!0)},onDragLeave:()=>o(!1),onDrop:D,onClick:()=>p.current?.click(),children:[e.jsx(E,{size:36,className:"mx-auto text-gr-light mb-3"}),e.jsxs("p",{className:"text-sm text-gr-text mb-1",children:["Drop your CSV file here, or ",e.jsx("span",{className:"text-gr-teal font-bold",children:"click to browse"})]}),e.jsx("p",{className:"text-xs text-gr-light",children:"Supports standard book library CSV format"}),e.jsx("input",{ref:p,type:"file",accept:".csv",className:"hidden",onChange:R})]}),k&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-sm text-gr-light",children:[e.jsx("div",{className:"spinner",style:{width:16,height:16}})," Importing..."]}),m&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-sm text-gr-green",children:[e.jsx(S,{size:16})," Successfully imported ",m.imported," books"]}),x&&e.jsx("div",{className:"mt-4 text-sm text-red-600",children:x})]}),e.jsxs("div",{className:"mb-10",children:[e.jsxs("h2",{className:"section-title mb-4",children:[e.jsx(V,{size:20,className:"inline mr-2"}),"Import from Catalog URL"]}),e.jsx("p",{className:"text-sm text-gr-light mb-4",children:"Paste a supported book URL to import all book details including ratings, description, genres, and reviews."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:a,onChange:t=>u(t.target.value),onKeyDown:t=>t.key==="Enter"&&v(),placeholder:"https://example.com/book/...",className:"flex-1 px-3 py-2 border border-gr-border rounded-md text-sm focus:outline-none focus:border-gr-teal",disabled:l}),e.jsxs("button",{className:"btn btn-primary",onClick:v,disabled:l||!a.trim(),children:[l?e.jsx(z,{size:16,className:"animate-spin"}):e.jsx(y,{size:16}),l?"Importing...":"Import"]})]}),h&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-sm text-gr-green",children:[e.jsx(S,{size:16}),' Imported "',h.title,'" successfully']}),b&&e.jsx("div",{className:"mt-4 text-sm text-red-600",children:b})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"section-title mb-4",children:[e.jsx(C,{size:20,className:"inline mr-2"}),"Export Library"]}),e.jsx("p",{className:"text-sm text-gr-light mb-4",children:"Download your library as a CSV file. Includes all books, ratings, reviews, shelves, and reading dates."}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>n.exportCSV(),children:[e.jsx(C,{size:16})," Export as CSV"]})]})]})]})}export{A as default};
