import{b as N,j as s,H as p,S as v}from"./index-C-ixEFdY.js";import{r as n}from"./react-vendor-bJoUFh3v.js";import{B as c}from"./BookCard-CEOB1_wh.js";import{l as u}from"./ui-RIRksdBL.js";import"./ShelfButton-DeyYxMQ2.js";import"./middleware-WYGlAF-S.js";const k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(){const o=new Date().getFullYear(),[l,x]=n.useState(o),[e,d]=n.useState(null),[g,m]=n.useState(!0);n.useEffect(()=>{m(!0),N.getStatsByYear(l).then(d).catch(()=>d(null)).finally(()=>m(!1))},[l]);const b=Array.from({length:5},(a,t)=>o-t),h=e?.books_per_month?Math.max(1,...Object.values(e.books_per_month)):1;return s.jsxs(s.Fragment,{children:[s.jsx(p,{}),s.jsxs("div",{className:"page-container",children:[s.jsx("div",{className:"section-header",children:s.jsxs("h1",{className:"section-title",children:[s.jsx(u,{size:24,className:"inline mr-2"}),"Year in Books"]})}),s.jsx("div",{className:"tabs mb-6",children:b.map(a=>s.jsx("button",{className:`tab ${a===l?"active":""}`,onClick:()=>x(a),children:a},a))}),g?s.jsx("div",{className:"loading-spinner",children:s.jsx("div",{className:"spinner"})}):e?s.jsxs("div",{className:"fade-in",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:e.total_books}),s.jsx("div",{className:"stat-label",children:"Books Read"})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:e.total_pages.toLocaleString()}),s.jsx("div",{className:"stat-label",children:"Pages Read"})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:e.average_rating.toFixed(1)}),s.jsx("div",{className:"stat-label",children:"Avg Rating"})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:e.total_books>0?Math.round(e.total_pages/e.total_books):0}),s.jsx("div",{className:"stat-label",children:"Avg Pages"})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h2",{className:"section-title mb-4",children:"Books by Month"}),s.jsx("div",{className:"bar-chart",style:{paddingBottom:24},children:k.map((a,t)=>{const r=String(t+1),i=e.books_per_month?.[r]||0,j=h>0?i/h*100:0;return s.jsxs("div",{className:"bar",style:{height:`${Math.max(j,2)}%`},children:[s.jsx("span",{className:"bar-label",children:a}),i>0&&s.jsx("span",{className:"absolute -top-5 left-1/2 -translate-x-1/2 text-xs font-bold text-gr-brown",children:i})]},a)})})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h2",{className:"section-title mb-4",children:"Rating Distribution"}),s.jsx("div",{className:"space-y-2",children:[5,4,3,2,1].map(a=>{const t=e.rating_distribution?.[String(a)]||0,r=Math.max(1,...Object.values(e.rating_distribution||{})),i=r>0?t/r*100:0;return s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center gap-1 w-24",children:s.jsx(v,{rating:a,size:14})}),s.jsx("div",{className:"flex-1 h-5 bg-gray-100 rounded",children:s.jsx("div",{className:"h-full bg-gr-orange rounded",style:{width:`${i}%`}})}),s.jsx("span",{className:"text-sm text-gr-light w-8 text-right",children:t})]},a)})})]}),e.genre_breakdown&&Object.keys(e.genre_breakdown).length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsx("h2",{className:"section-title mb-4",children:"Genres"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(e.genre_breakdown).sort(([,a],[,t])=>t-a).slice(0,20).map(([a,t])=>s.jsxs("span",{className:"genre-tag",children:[a," (",t,")"]},a))})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.shortest_book&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-bold text-gr-light uppercase mb-2",children:"Shortest Book"}),s.jsx(c,{book:e.shortest_book})]}),e.longest_book&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-bold text-gr-light uppercase mb-2",children:"Longest Book"}),s.jsx(c,{book:e.longest_book})]}),e.highest_rated&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-bold text-gr-light uppercase mb-2",children:"Highest Rated"}),s.jsx(c,{book:e.highest_rated})]})]})]}):s.jsxs("div",{className:"empty-state",children:[s.jsxs("h3",{children:["No reading data for ",l]}),s.jsx("p",{children:"Start reading and tracking books to see your stats."})]})]})]})}export{M as default};
