import{b as N,j as s,H as v,S as u}from"./index-CR0Xjtpx.js";import{r}from"./react-vendor-bJoUFh3v.js";import{B as c}from"./BookCard-CXzI_kTH.js";import{m as p}from"./ui-D_Yei50m.js";import"./ShelfButton-RoCdupez.js";import"./middleware-WYGlAF-S.js";const k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(){const o=new Date().getFullYear(),[n,x]=r.useState(o),[a,d]=r.useState(null),[j,h]=r.useState(!0);r.useEffect(()=>{h(!0),N.getStatsByYear(n).then(d).catch(()=>d(null)).finally(()=>h(!1))},[n]);const b=Array.from({length:5},(e,t)=>o-t),m=a?.books_per_month?Math.max(1,...Object.values(a.books_per_month)):1;return s.jsxs(s.Fragment,{children:[s.jsx(v,{}),s.jsxs("div",{className:"page-container",children:[s.jsx("div",{className:"section-header",children:s.jsxs("h1",{className:"section-title section-title-with-icon",children:[s.jsx(p,{size:24}),"Year in Books"]})}),s.jsx("div",{className:"tabs tabs-spaced",children:b.map(e=>s.jsx("button",{className:`tab ${e===n?"active":""}`,onClick:()=>x(e),children:e},e))}),j?s.jsx("div",{className:"loading-spinner",children:s.jsx("div",{className:"spinner"})}):a?s.jsxs("div",{className:"fade-in",children:[s.jsxs("div",{className:"stats-summary-grid",children:[s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:a.total_books}),s.jsx("div",{className:"stat-label",children:"Books Read"})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:a.total_pages.toLocaleString()}),s.jsx("div",{className:"stat-label",children:"Pages Read"})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:a.average_rating.toFixed(1)}),s.jsx("div",{className:"stat-label",children:"Avg Rating"})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("div",{className:"stat-number",children:a.total_books>0?Math.round(a.total_pages/a.total_books):0}),s.jsx("div",{className:"stat-label",children:"Avg Pages"})]})]}),s.jsxs("div",{className:"stats-section",children:[s.jsx("h2",{className:"section-title",children:"Books by Month"}),s.jsx("div",{className:"bar-chart bar-chart-spaced",children:k.map((e,t)=>{const l=String(t+1),i=a.books_per_month?.[l]||0,g=m>0?i/m*100:0;return s.jsxs("div",{className:"bar",style:{height:`${Math.max(g,2)}%`},children:[s.jsx("span",{className:"bar-label",children:e}),i>0&&s.jsx("span",{className:"bar-value",children:i})]},e)})})]}),s.jsxs("div",{className:"stats-section",children:[s.jsx("h2",{className:"section-title",children:"Rating Distribution"}),s.jsx("div",{className:"stats-rating-list",children:[5,4,3,2,1].map(e=>{const t=a.rating_distribution?.[String(e)]||0,l=Math.max(1,...Object.values(a.rating_distribution||{})),i=l>0?t/l*100:0;return s.jsxs("div",{className:"stats-rating-row",children:[s.jsx("div",{className:"stats-rating-stars",children:s.jsx(u,{rating:e,size:14})}),s.jsx("div",{className:"stats-rating-track",children:s.jsx("div",{className:"stats-rating-fill",style:{width:`${i}%`}})}),s.jsx("span",{className:"stats-rating-count",children:t})]},e)})})]}),a.genre_breakdown&&Object.keys(a.genre_breakdown).length>0&&s.jsxs("div",{className:"stats-section",children:[s.jsx("h2",{className:"section-title",children:"Genres"}),s.jsx("div",{className:"genre-list",children:Object.entries(a.genre_breakdown).sort(([,e],[,t])=>t-e).slice(0,20).map(([e,t])=>s.jsxs("span",{className:"genre-tag",children:[e," (",t,")"]},e))})]}),s.jsxs("div",{className:"stats-notable-grid",children:[a.shortest_book&&s.jsxs("div",{children:[s.jsx("h3",{className:"stats-notable-label",children:"Shortest Book"}),s.jsx(c,{book:a.shortest_book})]}),a.longest_book&&s.jsxs("div",{children:[s.jsx("h3",{className:"stats-notable-label",children:"Longest Book"}),s.jsx(c,{book:a.longest_book})]}),a.highest_rated&&s.jsxs("div",{children:[s.jsx("h3",{className:"stats-notable-label",children:"Highest Rated"}),s.jsx(c,{book:a.highest_rated})]})]})]}):s.jsxs("div",{className:"empty-state",children:[s.jsxs("h3",{children:["No reading data for ",n]}),s.jsx("p",{children:"Start reading and tracking books to see your stats."})]})]})]})}export{M as default};
