{{define "page/view.html"}}
{{template "layout/app.html" .}}
{{end}}

{{define "view-content"}}
<article class="article">
    {{if .Infoboxes}}
    <aside class="infobox">
        {{range .Infoboxes}}
        {{if .Name}}
        <div class="infobox-title">{{.Name}}</div>
        {{end}}
        {{range .Items}}
        <div class="infobox-row">
            <div class="infobox-label">{{.Label}}</div>
            <div class="infobox-value">{{.Value}}</div>
        </div>
        {{end}}
        {{end}}
    </aside>
    {{end}}

    <header class="article-header">
        <h1 class="article-title">{{.Page.Title}}</h1>
        <div class="article-meta">
            <span class="article-meta-item">
                <svg class="meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                </svg>
                {{.Page.WikiName}}
            </span>
            <span class="article-meta-sep">&middot;</span>
            <span class="article-meta-item">
                <svg class="meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"/>
                </svg>
                {{.Page.InLanguage}}
            </span>
            {{if .Page.DateModifiedRel}}
            <span class="article-meta-sep">&middot;</span>
            <span class="article-meta-item" title="{{.Page.DateModifiedFmt}}">
                <svg class="meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                    <path d="M16 2v4M8 2v4M3 10h18"/>
                </svg>
                {{.Page.DateModifiedRel}}
            </span>
            {{else if .Page.DateModified}}
            <span class="article-meta-sep">&middot;</span>
            <span class="article-meta-item">
                <svg class="meta-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                    <path d="M16 2v4M8 2v4M3 10h18"/>
                </svg>
                {{.Page.DateModified}}
            </span>
            {{end}}
        </div>
        {{if .Page.URL}}
        <a href="{{.Page.URL}}" class="article-source" target="_blank" rel="noopener">
            View on Wikipedia
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6M15 3h6v6M10 14L21 3"/>
            </svg>
        </a>
        {{end}}
    </header>

    <div class="article-content">
        {{if .HTML}}
        {{.HTML}}
        {{else}}
        <div class="article-text">{{.Page.Text}}</div>
        {{end}}
    </div>

    {{if .Page.WikidataID}}
    <footer class="article-footer">
        <div class="article-info">
            <h3 class="info-title">Article Info</h3>
            <dl class="info-list">
                <dt>Wikidata ID</dt>
                <dd>
                    <a href="https://www.wikidata.org/wiki/{{.Page.WikidataID}}" target="_blank" rel="noopener">
                        {{.Page.WikidataID}}
                    </a>
                </dd>
                {{if .Page.PageID}}
                <dt>Page ID</dt>
                <dd>{{.Page.PageID}}</dd>
                {{end}}
                {{if .Page.BytesHTML}}
                <dt>HTML Size</dt>
                <dd>{{.Page.BytesHTML}} bytes</dd>
                {{end}}
            </dl>
        </div>
    </footer>
    {{end}}
</article>

<style>
.article {
    max-width: 100%;
}

/* Infobox - Wikipedia-style floating panel */
.infobox {
    float: right;
    clear: right;
    width: 280px;
    margin: 0 0 1rem 1.5rem;
    padding: 0;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    font-size: 0.875rem;
    overflow: hidden;
}

.infobox-title {
    padding: 0.75rem 1rem;
    font-weight: 600;
    font-size: 1rem;
    text-align: center;
    background: var(--bg-alt);
    border-bottom: 1px solid var(--border);
    color: var(--fg);
}

.infobox-row {
    display: flex;
    border-bottom: 1px solid var(--border);
}

.infobox-row:last-child {
    border-bottom: none;
}

.infobox-label {
    flex: 0 0 40%;
    padding: 0.5rem 0.75rem;
    font-weight: 500;
    color: var(--fg-muted);
    background: var(--bg-alt);
    word-break: break-word;
}

.infobox-value {
    flex: 1;
    padding: 0.5rem 0.75rem;
    color: var(--fg);
    word-break: break-word;
}

@media (max-width: 768px) {
    .infobox {
        float: none;
        width: 100%;
        margin: 0 0 1.5rem 0;
    }
}

.article-header {
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid var(--border);
}

.article-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--fg);
    margin: 0 0 0.75rem 0;
    line-height: 1.2;
}

.article-meta {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: var(--fg-muted);
    margin-bottom: 1rem;
}

.article-meta-item {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
}

.meta-icon {
    width: 16px;
    height: 16px;
    opacity: 0.7;
}

.article-meta-sep {
    color: var(--border);
}

.article-source {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.375rem 0.75rem;
    font-size: 0.8125rem;
    font-weight: 500;
    color: var(--accent);
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    transition: all 0.15s ease;
}

.article-source:hover {
    background: var(--surface-hover);
    text-decoration: none;
}

.article-source svg {
    width: 14px;
    height: 14px;
}

.article-content {
    font-size: 1rem;
    line-height: 1.75;
    color: var(--fg);
}

.article-text {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-family: var(--font-sans);
}

.article-content h2 {
    font-size: 1.5rem;
    font-weight: 600;
    margin: 2rem 0 1rem 0;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--border);
}

.article-content h3 {
    font-size: 1.25rem;
    font-weight: 600;
    margin: 1.5rem 0 0.75rem 0;
}

.article-content h4 {
    font-size: 1.125rem;
    font-weight: 600;
    margin: 1.25rem 0 0.5rem 0;
}

.article-content p {
    margin: 0 0 1rem 0;
}

.article-content ul,
.article-content ol {
    margin: 0 0 1rem 0;
    padding-left: 1.5rem;
}

.article-content li {
    margin: 0.25rem 0;
}

.article-content blockquote {
    margin: 1rem 0;
    padding: 0.75rem 1rem;
    border-left: 3px solid var(--accent);
    background: var(--surface);
    font-style: italic;
}

.article-content code {
    padding: 0.125rem 0.375rem;
    font-family: var(--font-mono);
    font-size: 0.875em;
    background: var(--surface);
    border-radius: var(--radius-sm);
}

.article-content pre {
    margin: 1rem 0;
    padding: 1rem;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    overflow-x: auto;
}

.article-content pre code {
    padding: 0;
    background: none;
}

.article-content table {
    width: 100%;
    margin: 1rem 0;
    border-collapse: collapse;
}

.article-content th,
.article-content td {
    padding: 0.5rem 0.75rem;
    border: 1px solid var(--border);
    text-align: left;
}

.article-content th {
    background: var(--surface);
    font-weight: 600;
}

.article-footer {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border);
}

.article-info {
    padding: 1rem;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
}

.info-title {
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--fg-muted);
    margin: 0 0 0.75rem 0;
}

.info-list {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 0.375rem 1rem;
    font-size: 0.875rem;
    margin: 0;
}

.info-list dt {
    color: var(--fg-muted);
}

.info-list dd {
    margin: 0;
    color: var(--fg);
}

@media (max-width: 640px) {
    .article-title {
        font-size: 1.5rem;
    }

    .article-meta {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.375rem;
    }

    .article-meta-sep {
        display: none;
    }
}
</style>
{{end}}
