import{a as r}from"./client-CvoVCtJO.js";const f={getOverview:()=>r.get("/api/database/overview"),getTableStats:(e="public")=>r.get(`/api/database/tables/stats?schema=${e}`),listIndexes:(e,a)=>{const t=new URLSearchParams;e&&t.set("schema",e),a&&t.set("table",a);const s=t.toString();return r.get(`/api/database/indexes${s?"?"+s:""}`)},createIndex:e=>r.post("/api/database/indexes",e),dropIndex:(e,a)=>r.delete(`/api/database/indexes/${e}/${a}`),enableTableRLS:(e,a)=>r.post(`/api/database/tables/${e}/${a}/rls/enable`,{}),disableTableRLS:(e,a)=>r.post(`/api/database/tables/${e}/${a}/rls/disable`,{}),listSchemas:()=>r.get("/api/database/schemas"),createSchema:e=>r.post("/api/database/schemas",{name:e}),listTables:(e="public")=>r.get(`/api/database/tables?schema=${e}`),getTable:(e,a)=>r.get(`/api/database/tables/${e}/${a}`),createTable:e=>r.post("/api/database/tables",e),dropTable:(e,a)=>r.delete(`/api/database/tables/${e}/${a}`),listColumns:(e,a)=>r.get(`/api/database/tables/${e}/${a}/columns`),addColumn:(e,a,t)=>r.post(`/api/database/tables/${e}/${a}/columns`,t),alterColumn:(e,a,t,s)=>r.put(`/api/database/tables/${e}/${a}/columns/${t}`,s),dropColumn:(e,a,t)=>r.delete(`/api/database/tables/${e}/${a}/columns/${t}`),listPolicies:(e,a)=>r.get(`/api/database/policies/${e}/${a}`),createPolicy:e=>r.post("/api/database/policies",e),dropPolicy:(e,a,t)=>r.delete(`/api/database/policies/${e}/${a}/${t}`),listExtensions:()=>r.get("/api/database/extensions"),enableExtension:e=>r.post("/api/database/extensions",{name:e}),executeQuery:(e,a)=>r.post("/api/database/query",{query:e,role:a==null?void 0:a.role,explain:a==null?void 0:a.explain}),getQueryHistory:(e=100,a=0)=>r.get(`/api/database/query/history?limit=${e}&offset=${a}`),clearQueryHistory:()=>r.delete("/api/database/query/history"),listSnippets:()=>r.get("/api/database/snippets"),getSnippet:e=>r.get(`/api/database/snippets/${e}`),createSnippet:e=>r.post("/api/database/snippets",e),updateSnippet:(e,a)=>r.put(`/api/database/snippets/${e}`,a),deleteSnippet:e=>r.delete(`/api/database/snippets/${e}`),listFolders:()=>r.get("/api/database/snippets/folders"),createFolder:e=>r.post("/api/database/snippets/folders",e),updateFolder:(e,a)=>r.put(`/api/database/snippets/folders/${e}`,a),deleteFolder:e=>r.delete(`/api/database/snippets/folders/${e}`),selectTable:(e,a)=>{const t=a?`/rest/v1/${e}?${a}`:`/rest/v1/${e}`;return r.get(t)},insertRow:(e,a)=>r.post(`/rest/v1/${e}`,a,{headers:{Prefer:"return=representation"}}),updateRow:(e,a,t)=>r.patch(`/rest/v1/${e}?${a}`,t,{headers:{Prefer:"return=representation"}}),deleteRow:(e,a)=>r.delete(`/rest/v1/${e}?${a}`),getTableData:async(e,a,t)=>{const s=new URLSearchParams;t!=null&&t.limit&&s.set("limit",String(t.limit)),t!=null&&t.offset&&s.set("offset",String(t.offset)),t!=null&&t.order&&s.set("order",t.order),t!=null&&t.select&&s.set("select",t.select),t!=null&&t.includeCount&&s.set("count","true"),t!=null&&t.filters&&Object.entries(t.filters).forEach(([c,p])=>{s.set(c,p)});const l=s.toString(),n=`/api/database/tables/${e}/${a}/data${l?"?"+l:""}`,i=localStorage.getItem("supabase_service_key")||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJsb2NhbGJhc2UiLCJyb2xlIjoic2VydmljZV9yb2xlIiwiaWF0IjoxNzA0MDY3MjAwLCJleHAiOjE4NjE4MzM2MDB9.service_role_key_signature",d=await fetch(n,{headers:{"Content-Type":"application/json",apikey:i,Authorization:`Bearer ${i}`}});if(!d.ok)throw new Error(`Failed to fetch table data: ${d.statusText}`);const b=await d.json(),u=d.headers.get("X-Total-Count");return{data:b,totalCount:u?parseInt(u,10):void 0}},exportTableData:(e,a,t="json",s)=>{const l=new URLSearchParams;return l.set("format",t),s&&Object.entries(s).forEach(([n,i])=>{l.set(n,i)}),`/api/database/tables/${e}/${a}/export?${l.toString()}`},bulkOperation:(e,a,t,s,l)=>r.post(`/api/database/tables/${e}/${a}/bulk`,{operation:t,ids:s,column:(l==null?void 0:l.column)||"id",data:l==null?void 0:l.data})};export{f as d};
