import{j as e,S as c,X as cr,T as s,B as v,G as o,a8 as Ce,e as x,q as b,V as br,s as ke,d as we,D as k,a as C,M as w,A as S,H as y,C as ur,a3 as xr,b as m,O as Se,_ as ze,r as M,a2 as yr,p as Te,J as Re,g as vr,f as Fe,t as hr}from"./vendor-mantine-aKbh6G_O.js";import{r as t}from"./vendor-react-CA6k1jPF.js";import{F as mr}from"./vendor-monaco-D2wf_90s.js";import{f as u}from"./functions-BDE2KpTN.js";import{V as gr,W as O,a$ as jr,b0 as pr,r as Ie,b1 as fr,Y as Cr,am as kr,_ as X,d as De,g as Be,p as Le,aH as Ne,u as wr,au as Pe,ao as Sr,H as zr,J as Tr,ai as Rr,I as Fr,a_ as Ir,j as Dr,aq as Br,O as Lr,b2 as Nr,b3 as Pr,h as _r}from"./vendor-icons-BYOfSTr6.js";import{af as Er,ag as Mr,ah as Or,ai as Ar,aj as Wr,ak as Hr,al as Ur}from"./vendor-charts-X2wGYlzF.js";import"./client-CvoVCtJO.js";const Jr={wave:e.jsx(_r,{size:20}),"credit-card":e.jsx(Pr,{size:20}),robot:e.jsx(Nr,{size:20}),mail:e.jsx(Lr,{size:20}),upload:e.jsx(Br,{size:20}),shield:e.jsx(Dr,{size:20}),clock:e.jsx(Ir,{size:20}),database:e.jsx(Fr,{size:20})};function Zr(){const[A,_e]=t.useState([]),[l,N]=t.useState(null),[Ee,Me]=t.useState(!0),[z,Z]=t.useState(""),[W,Q]=t.useState(""),[ee,H]=t.useState(!1),[Oe,re]=t.useState(!1),[T,Ae]=t.useState("code"),[R,We]=t.useState([]),[He,U]=t.useState(!1),[F,te]=t.useState(""),[I,se]=t.useState(""),[Ue,J]=t.useState(!1),[V,ae]=t.useState(""),[Je,D]=t.useState(!1),[B,le]=t.useState(""),[L,oe]=t.useState(null),[q,ne]=t.useState(!0),[Ve,qe]=t.useState([]),[ie,de]=t.useState(!1),[K,Ke]=t.useState("POST"),[p,P]=t.useState([{key:"Content-Type",value:"application/json"}]),[_,$e]=t.useState(`{
  "name": "World"
}`),[f,$]=t.useState(null),[Ge,ce]=t.useState(!1),[be,Ye]=t.useState([]),[ue,xe]=t.useState(!1),[g,Xe]=t.useState(null),[Ze,ye]=t.useState(!1),[G,Qe]=t.useState("24h"),[ve,er]=t.useState([]),[rr,he]=t.useState(!1),i=A.find(r=>r.id===l),h=t.useCallback(async()=>{try{const r=await u.listFunctions();_e(r),r.length>0&&!l&&N(r[0].id)}catch(r){console.error("Failed to load functions:",r)}finally{Me(!1)}},[l]),me=t.useCallback(async r=>{try{const a=await u.getSource(r);Z(a.source_code),Q(a.source_code),H(a.is_draft)}catch(a){console.error("Failed to load source:",a)}},[]),Y=t.useCallback(async r=>{xe(!0);try{const a=await u.getLogs(r,{limit:100});Ye(a.logs||[])}catch(a){console.error("Failed to load logs:",a)}finally{xe(!1)}},[]),ge=t.useCallback(async(r,a)=>{ye(!0);try{const d=await u.getMetrics(r,a);Xe(d)}catch(d){console.error("Failed to load metrics:",d)}finally{ye(!1)}},[]),E=t.useCallback(async r=>{he(!0);try{const a=await u.listDeployments(r);er(a||[])}catch(a){console.error("Failed to load deployments:",a)}finally{he(!1)}},[]),je=t.useCallback(async()=>{try{const r=await u.listTemplates();qe(r.templates||[])}catch(r){console.error("Failed to load templates:",r)}},[]),j=t.useCallback(async()=>{try{const r=await u.listSecrets();We(r||[])}catch(r){console.error("Failed to load secrets:",r)}},[]);t.useEffect(()=>{h(),je(),j()},[h,je,j]),t.useEffect(()=>{l&&(me(l),T==="logs"?Y(l):T==="metrics"?ge(l,G):T==="deployments"&&E(l))},[l,T,G,me,Y,ge,E]);const tr=t.useCallback(r=>{r!==void 0&&(Z(r),H(r!==W))},[W]),sr=t.useCallback(async()=>{if(l){re(!0);try{await u.deployFunction(l,{source_code:z}),Q(z),H(!1),await h(),await E(l)}catch(r){console.error("Failed to deploy:",r)}finally{re(!1)}}},[l,z,h,E]),ar=t.useCallback(async()=>{if(B.trim())try{const r=await u.createFunction({name:B.trim().replace(/\s+/g,"-").toLowerCase(),verify_jwt:q,template_id:L||void 0});D(!1),le(""),oe(null),ne(!0),await h(),N(r.id)}catch(r){console.error("Failed to create function:",r)}},[B,q,L,h]),pe=t.useCallback(async r=>{if(confirm("Are you sure you want to delete this function?"))try{await u.deleteFunction(r),l===r&&N(null),await h()}catch(a){console.error("Failed to delete function:",a)}},[l,h]),lr=t.useCallback(async()=>{if(l){ce(!0),$(null);try{const r={};p.forEach(n=>{n.key&&n.value&&(r[n.key]=n.value)});let a;try{a=JSON.parse(_)}catch{a=_}const d=await u.testFunction(l,{method:K,path:"/",headers:r,body:a});$(d)}catch(r){console.error("Test failed:",r),$({error:"Test failed"})}finally{ce(!1)}}},[l,K,p,_]),or=t.useCallback(async()=>{if(!(!F.trim()||!I.trim()))try{await u.createSecret({name:F.trim(),value:I.trim()}),te(""),se(""),await j()}catch(r){console.error("Failed to create secret:",r)}},[F,I,j]),nr=t.useCallback(async r=>{try{await u.deleteSecret(r),await j()}catch(a){console.error("Failed to delete secret:",a)}},[j]),ir=t.useCallback(async()=>{const r=V.split(`
`).filter(d=>d.trim()),a=[];for(const d of r){const[n,...fe]=d.split("=");n&&fe.length>0&&a.push({name:n.trim(),value:fe.join("=").trim()})}if(a.length!==0)try{await u.bulkUpdateSecrets({secrets:a}),ae(""),J(!1),await j()}catch(d){console.error("Failed to bulk update secrets:",d)}},[V,j]),dr=t.useCallback(async()=>{if(!(!l||!i))try{const r=await u.downloadFunction(l),a=new Blob([r],{type:"application/typescript"}),d=URL.createObjectURL(a),n=document.createElement("a");n.href=d,n.download=`${i.slug}.ts`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(d)}catch(r){console.error("Failed to download function:",r)}},[l,i]);return Ee?e.jsxs(c,{align:"center",justify:"center",h:400,children:[e.jsx(cr,{size:"lg"}),e.jsx(s,{style:{color:"var(--lb-text-secondary)"},children:"Loading functions..."})]}):e.jsxs(v,{h:"calc(100vh - 60px)",children:[e.jsxs(o,{justify:"space-between",mb:"md",children:[e.jsx(Ce,{order:3,style:{color:"var(--lb-text-primary)"},children:"Edge Functions"}),e.jsxs(o,{children:[e.jsx(x,{variant:"subtle",leftSection:e.jsx(gr,{size:16}),onClick:()=>U(!0),style:{color:"var(--lb-text-secondary)",transition:"var(--lb-transition-fast)"},children:"Manage Secrets"}),e.jsx(x,{leftSection:e.jsx(O,{size:16}),onClick:()=>D(!0),style:{background:"var(--lb-brand)",borderRadius:"var(--lb-radius-md)",transition:"var(--lb-transition-fast)"},className:"lb-btn-primary",children:"Create function"})]})]}),e.jsxs(o,{align:"flex-start",gap:"md",wrap:"nowrap",style:{height:"calc(100% - 50px)"},children:[e.jsxs(b,{withBorder:!0,p:"xs",w:260,h:"100%",style:{flexShrink:0,display:"flex",flexDirection:"column",background:"var(--lb-bg-secondary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)"},children:[e.jsx(s,{size:"xs",fw:600,mb:"xs",px:"xs",style:{color:"var(--lb-text-muted)"},children:"FUNCTIONS"}),e.jsx(br,{style:{flex:1},children:e.jsx(c,{gap:2,children:A.length===0?e.jsx(s,{size:"sm",ta:"center",py:"lg",style:{color:"var(--lb-text-secondary)"},children:"No functions yet"}):A.map(r=>e.jsx(b,{p:"xs",withBorder:l===r.id,style:{cursor:"pointer",background:l===r.id?"var(--lb-bg-tertiary)":"transparent",borderColor:l===r.id?"var(--lb-border-strong)":"transparent",borderRadius:"var(--lb-radius-sm)",transition:"var(--lb-transition-fast)"},onClick:()=>N(r.id),children:e.jsxs(o,{gap:"xs",wrap:"nowrap",children:[e.jsx(ke,{size:"xs",radius:"xl",color:r.status==="active"?"green":"gray",variant:"filled",style:{background:r.status==="active"?"var(--lb-success)":"var(--lb-text-muted)"},children:e.jsx(v,{w:6,h:6,style:{borderRadius:"50%",background:"currentColor"}})}),e.jsxs(v,{style:{flex:1,minWidth:0},children:[e.jsx(s,{size:"sm",fw:500,truncate:!0,style:{color:"var(--lb-text-primary)"},children:r.name}),e.jsxs(s,{size:"xs",style:{color:"var(--lb-text-tertiary)"},children:["v",r.version]})]}),r.verify_jwt?e.jsx(we,{label:"JWT Required",children:e.jsx(jr,{size:14,style:{opacity:.5,color:"var(--lb-text-muted)"}})}):e.jsx(we,{label:"Public",children:e.jsx(pr,{size:14,style:{opacity:.5,color:"var(--lb-text-muted)"}})})]})},r.id))})}),e.jsx(k,{my:"sm",style:{borderColor:"var(--lb-border-muted)"}}),e.jsx(s,{size:"xs",fw:600,mb:"xs",px:"xs",style:{color:"var(--lb-text-muted)"},children:"SECRETS"}),e.jsxs(c,{gap:2,children:[R.slice(0,3).map(r=>e.jsx(s,{size:"xs",px:"xs",style:{color:"var(--lb-text-secondary)"},children:r.name},r.id)),R.length>3&&e.jsxs(s,{size:"xs",px:"xs",style:{color:"var(--lb-text-tertiary)"},children:["+",R.length-3," more"]}),e.jsx(x,{variant:"subtle",size:"xs",onClick:()=>U(!0),fullWidth:!0,style:{color:"var(--lb-text-secondary)",transition:"var(--lb-transition-fast)"},children:"Manage secrets"})]})]}),i?e.jsxs(b,{withBorder:!0,p:0,style:{flex:1,height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",background:"var(--lb-bg-secondary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)"},children:[e.jsxs(o,{justify:"space-between",p:"sm",style:{borderBottom:"1px solid var(--lb-border-default)"},children:[e.jsxs(o,{children:[e.jsx(Ce,{order:4,style:{color:"var(--lb-text-primary)"},children:i.name}),e.jsx(C,{color:i.status==="active"?"green":"gray",variant:"light",style:{background:i.status==="active"?"var(--lb-success-bg)":"var(--lb-bg-tertiary)",color:i.status==="active"?"var(--lb-success-text)":"var(--lb-text-secondary)"},children:i.status}),ee&&e.jsx(C,{color:"yellow",variant:"light",style:{background:"var(--lb-warning-bg)",color:"var(--lb-warning-text)"},children:"Unsaved changes"})]}),e.jsxs(o,{children:[e.jsx(x,{variant:"subtle",leftSection:e.jsx(Ie,{size:16}),onClick:()=>de(!ie),style:{color:"var(--lb-text-secondary)",transition:"var(--lb-transition-fast)"},children:"Test"}),e.jsx(x,{leftSection:e.jsx(fr,{size:16}),loading:Oe,onClick:sr,disabled:!ee&&z===W,style:{background:"var(--lb-brand)",borderRadius:"var(--lb-radius-md)",transition:"var(--lb-transition-fast)"},className:"lb-btn-primary",children:"Deploy"}),e.jsxs(w,{shadow:"md",width:200,children:[e.jsx(w.Target,{children:e.jsx(S,{variant:"subtle",style:{color:"var(--lb-text-secondary)"},children:e.jsx(Cr,{size:16})})}),e.jsxs(w.Dropdown,{style:{background:"var(--lb-bg-secondary)",borderColor:"var(--lb-border-default)"},children:[e.jsx(w.Item,{leftSection:e.jsx(kr,{size:16}),onClick:dr,style:{color:"var(--lb-text-primary)"},children:"Download"}),e.jsx(w.Divider,{style:{borderColor:"var(--lb-border-muted)"}}),e.jsx(w.Item,{leftSection:e.jsx(X,{size:16}),color:"red",onClick:()=>pe(i.id),style:{color:"var(--lb-error)"},children:"Delete function"})]})]})]})]}),e.jsxs(y,{value:T,onChange:Ae,style:{flex:1,display:"flex",flexDirection:"column"},children:[e.jsxs(y.List,{px:"sm",style:{borderColor:"var(--lb-border-default)"},children:[e.jsx(y.Tab,{value:"code",leftSection:e.jsx(De,{size:14}),style:{color:"var(--lb-text-secondary)"},children:"Code"}),e.jsx(y.Tab,{value:"logs",leftSection:e.jsx(Be,{size:14}),style:{color:"var(--lb-text-secondary)"},children:"Logs"}),e.jsx(y.Tab,{value:"metrics",leftSection:e.jsx(Le,{size:14}),style:{color:"var(--lb-text-secondary)"},children:"Metrics"}),e.jsx(y.Tab,{value:"deployments",leftSection:e.jsx(Ne,{size:14}),style:{color:"var(--lb-text-secondary)"},children:"Deployments"}),e.jsx(y.Tab,{value:"settings",leftSection:e.jsx(wr,{size:14}),style:{color:"var(--lb-text-secondary)"},children:"Settings"})]}),e.jsx(y.Panel,{value:"code",style:{flex:1,position:"relative"},children:e.jsxs(v,{style:{position:"absolute",inset:0,display:"flex"},children:[e.jsx(v,{style:{flex:1,position:"relative"},children:e.jsx(mr,{height:"100%",language:"typescript",theme:"vs-dark",value:z,onChange:tr,options:{minimap:{enabled:!1},fontSize:13,lineNumbers:"on",scrollBeyondLastLine:!1,wordWrap:"on",automaticLayout:!0,padding:{top:10}}})}),e.jsx(ur,{in:ie,transitionDuration:200,children:e.jsxs(b,{w:400,h:"100%",p:"md",style:{borderLeft:"1px solid var(--lb-border-default)",display:"flex",flexDirection:"column",background:"var(--lb-bg-secondary)"},children:[e.jsxs(o,{justify:"space-between",mb:"md",children:[e.jsx(s,{fw:600,style:{color:"var(--lb-text-primary)"},children:"Test Function"}),e.jsx(S,{variant:"subtle",onClick:()=>de(!1),style:{color:"var(--lb-text-secondary)"},children:e.jsx(Pe,{size:16})})]}),e.jsxs(c,{gap:"sm",style:{flex:1,overflow:"auto"},children:[e.jsxs(o,{gap:"xs",children:[e.jsx(xr,{w:100,value:K,onChange:r=>Ke(r||"POST"),data:["GET","POST","PUT","PATCH","DELETE"],styles:{input:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)"}}}),e.jsx(m,{flex:1,value:`/functions/v1/${i.slug}`,readOnly:!0,styles:{input:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)"}}})]}),e.jsx(k,{label:"Headers",labelPosition:"left",style:{borderColor:"var(--lb-border-muted)"}}),p.map((r,a)=>e.jsxs(o,{gap:"xs",children:[e.jsx(m,{placeholder:"Key",value:r.key,onChange:d=>{const n=[...p];n[a].key=d.target.value,P(n)},style:{flex:1},styles:{input:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)"}}}),e.jsx(m,{placeholder:"Value",value:r.value,onChange:d=>{const n=[...p];n[a].value=d.target.value,P(n)},style:{flex:1},styles:{input:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)"}}}),e.jsx(S,{variant:"subtle",color:"red",onClick:()=>{P(p.filter((d,n)=>n!==a))},style:{color:"var(--lb-error)"},children:e.jsx(Pe,{size:14})})]},a)),e.jsx(x,{variant:"subtle",size:"xs",leftSection:e.jsx(O,{size:14}),onClick:()=>P([...p,{key:"",value:""}]),style:{color:"var(--lb-text-secondary)",transition:"var(--lb-transition-fast)"},children:"Add header"}),e.jsx(k,{label:"Body",labelPosition:"left",style:{borderColor:"var(--lb-border-muted)"}}),e.jsx(Se,{value:_,onChange:r=>$e(r.target.value),minRows:4,styles:{input:{fontFamily:"monospace",fontSize:12,background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)"}}}),e.jsx(x,{fullWidth:!0,leftSection:e.jsx(Ie,{size:16}),loading:Ge,onClick:lr,style:{background:"var(--lb-brand)",borderRadius:"var(--lb-radius-md)",transition:"var(--lb-transition-fast)"},className:"lb-btn-primary",children:"Run function"}),f&&e.jsxs(e.Fragment,{children:[e.jsx(k,{label:"Response",labelPosition:"left",style:{borderColor:"var(--lb-border-muted)"}}),e.jsxs(b,{p:"xs",withBorder:!0,style:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-sm)"},children:[e.jsxs(o,{gap:"xs",mb:"xs",children:[e.jsx(C,{color:f.status<400?"green":"red",variant:"light",style:{background:f.status<400?"var(--lb-success-bg)":"var(--lb-error-bg)",color:f.status<400?"var(--lb-success-text)":"var(--lb-error-text)"},children:f.status}),e.jsxs(s,{size:"xs",style:{color:"var(--lb-text-tertiary)"},children:[f.duration_ms,"ms"]})]}),e.jsx(ze,{block:!0,style:{fontSize:11,maxHeight:200,overflow:"auto",background:"var(--lb-bg-primary)"},children:JSON.stringify(f.body,null,2)})]})]})]})]})})]})}),e.jsx(y.Panel,{value:"logs",style:{flex:1},children:e.jsxs(v,{p:"md",h:"100%",style:{overflow:"auto"},children:[e.jsxs(o,{justify:"space-between",mb:"md",children:[e.jsx(s,{fw:500,style:{color:"var(--lb-text-primary)"},children:"Execution Logs"}),e.jsx(x,{variant:"subtle",size:"xs",leftSection:e.jsx(Sr,{size:14}),onClick:()=>Y(l),loading:ue,style:{color:"var(--lb-text-secondary)",transition:"var(--lb-transition-fast)"},children:"Refresh"})]}),ue?e.jsx(c,{gap:"xs",children:[1,2,3,4,5].map(r=>e.jsx(M,{height:40,style:{borderRadius:"var(--lb-radius-sm)"}},r))}):be.length===0?e.jsxs(c,{align:"center",py:"xl",children:[e.jsx(Be,{size:48,style:{opacity:.3,color:"var(--lb-text-muted)"}}),e.jsx(s,{style:{color:"var(--lb-text-secondary)"},children:"No logs yet"}),e.jsx(s,{size:"xs",style:{color:"var(--lb-text-tertiary)"},children:"Logs will appear here when the function is invoked"})]}):e.jsx(c,{gap:4,children:be.map(r=>e.jsxs(b,{p:"xs",withBorder:!0,style:{background:r.level==="error"?"var(--lb-error-bg)":"var(--lb-bg-tertiary)",borderColor:r.level==="error"?"var(--lb-error)":"var(--lb-border-default)",borderRadius:"var(--lb-radius-sm)",opacity:r.level==="debug"?.7:1},children:[e.jsxs(o,{gap:"xs",children:[e.jsx(C,{size:"xs",color:r.level==="error"?"red":r.level==="warn"?"yellow":r.level==="debug"?"gray":"blue",variant:"filled",style:{background:r.level==="error"?"var(--lb-error)":r.level==="warn"?"var(--lb-warning)":r.level==="debug"?"var(--lb-text-muted)":"var(--lb-info)"},children:r.level.toUpperCase()}),e.jsx(s,{size:"xs",style:{color:"var(--lb-text-tertiary)"},children:new Date(r.timestamp).toLocaleTimeString()}),r.status_code&&e.jsx(C,{size:"xs",variant:"outline",style:{borderColor:"var(--lb-border-default)",color:"var(--lb-text-secondary)"},children:r.status_code}),r.duration_ms&&e.jsxs(s,{size:"xs",style:{color:"var(--lb-text-tertiary)"},children:[r.duration_ms,"ms"]})]}),e.jsx(s,{size:"sm",mt:4,style:{fontFamily:"monospace",color:"var(--lb-text-primary)"},children:r.message})]},r.id))})]})}),e.jsx(y.Panel,{value:"metrics",style:{flex:1},children:e.jsxs(v,{p:"md",h:"100%",style:{overflow:"auto"},children:[e.jsxs(o,{justify:"space-between",mb:"lg",children:[e.jsx(s,{fw:500,style:{color:"var(--lb-text-primary)"},children:"Function Metrics"}),e.jsx(yr,{size:"xs",value:G,onChange:Qe,data:[{label:"1h",value:"1h"},{label:"24h",value:"24h"},{label:"7d",value:"7d"},{label:"30d",value:"30d"}],styles:{root:{background:"var(--lb-bg-tertiary)"}}})]}),Ze?e.jsxs(c,{gap:"md",children:[e.jsx(M,{height:100,style:{borderRadius:"var(--lb-radius-md)"}}),e.jsx(M,{height:200,style:{borderRadius:"var(--lb-radius-md)"}})]}):g?e.jsxs(c,{gap:"lg",children:[e.jsxs(Te,{cols:3,children:[e.jsxs(b,{withBorder:!0,p:"md",style:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)"},children:[e.jsx(s,{size:"xs",tt:"uppercase",style:{color:"var(--lb-text-muted)"},children:"Total Invocations"}),e.jsx(s,{size:"xl",fw:600,style:{color:"var(--lb-text-primary)"},children:g.invocations.total.toLocaleString()})]}),e.jsxs(b,{withBorder:!0,p:"md",style:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)"},children:[e.jsx(s,{size:"xs",tt:"uppercase",style:{color:"var(--lb-text-muted)"},children:"Success Rate"}),e.jsxs(s,{size:"xl",fw:600,style:{color:g.invocations.error>0?"var(--lb-warning)":"var(--lb-success)"},children:[g.invocations.total>0?Math.round(g.invocations.success/g.invocations.total*100):100,"%"]})]}),e.jsxs(b,{withBorder:!0,p:"md",style:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)"},children:[e.jsx(s,{size:"xs",tt:"uppercase",style:{color:"var(--lb-text-muted)"},children:"Avg Latency"}),e.jsxs(s,{size:"xl",fw:600,style:{color:"var(--lb-text-primary)"},children:[g.latency.avg,"ms"]})]})]}),e.jsxs(b,{withBorder:!0,p:"md",style:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)"},children:[e.jsx(s,{fw:500,mb:"md",style:{color:"var(--lb-text-primary)"},children:"Invocations Over Time"}),e.jsx(v,{h:250,children:e.jsx(Er,{width:"100%",height:"100%",children:e.jsxs(Mr,{data:g.invocations.by_hour,children:[e.jsx(Or,{strokeDasharray:"3 3",stroke:"var(--lb-border-muted)"}),e.jsx(Ar,{dataKey:"hour",tickFormatter:r=>new Date(r).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),stroke:"var(--lb-text-muted)",fontSize:11}),e.jsx(Wr,{stroke:"var(--lb-text-muted)",fontSize:11}),e.jsx(Hr,{contentStyle:{background:"var(--lb-bg-secondary)",border:"1px solid var(--lb-border-default)",borderRadius:"var(--lb-radius-sm)"}}),e.jsx(Ur,{type:"monotone",dataKey:"count",stroke:"var(--lb-brand)",fill:"var(--lb-brand)",fillOpacity:.2})]})})})]})]}):e.jsxs(c,{align:"center",py:"xl",children:[e.jsx(Le,{size:48,style:{opacity:.3,color:"var(--lb-text-muted)"}}),e.jsx(s,{style:{color:"var(--lb-text-secondary)"},children:"No metrics data yet"})]})]})}),e.jsx(y.Panel,{value:"deployments",style:{flex:1},children:e.jsxs(v,{p:"md",h:"100%",style:{overflow:"auto"},children:[e.jsx(s,{fw:500,mb:"md",style:{color:"var(--lb-text-primary)"},children:"Deployment History"}),rr?e.jsx(c,{gap:"xs",children:[1,2,3].map(r=>e.jsx(M,{height:60,style:{borderRadius:"var(--lb-radius-md)"}},r))}):ve.length===0?e.jsxs(c,{align:"center",py:"xl",children:[e.jsx(Ne,{size:48,style:{opacity:.3,color:"var(--lb-text-muted)"}}),e.jsx(s,{style:{color:"var(--lb-text-secondary)"},children:"No deployments yet"}),e.jsx(s,{size:"xs",style:{color:"var(--lb-text-tertiary)"},children:"Deploy your function to see version history"})]}):e.jsx(c,{gap:"xs",children:ve.map((r,a)=>e.jsx(b,{withBorder:!0,p:"md",style:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)"},children:e.jsxs(o,{justify:"space-between",children:[e.jsxs(o,{children:[e.jsx(C,{color:r.status==="deployed"?"green":r.status==="deploying"?"blue":r.status==="failed"?"red":"gray",variant:"light",style:{background:r.status==="deployed"?"var(--lb-success-bg)":r.status==="deploying"?"var(--lb-info-bg)":r.status==="failed"?"var(--lb-error-bg)":"var(--lb-bg-tertiary)",color:r.status==="deployed"?"var(--lb-success-text)":r.status==="deploying"?"var(--lb-info-text)":r.status==="failed"?"var(--lb-error-text)":"var(--lb-text-secondary)"},children:r.status}),e.jsxs(s,{fw:500,style:{color:"var(--lb-text-primary)"},children:["Version ",r.version]}),a===0&&e.jsx(C,{variant:"outline",size:"xs",style:{borderColor:"var(--lb-brand)",color:"var(--lb-brand)"},children:"Current"})]}),e.jsx(s,{size:"xs",style:{color:"var(--lb-text-tertiary)"},children:new Date(r.deployed_at).toLocaleString()})]})},r.id))})]})}),e.jsx(y.Panel,{value:"settings",style:{flex:1},children:e.jsx(v,{p:"md",maw:600,children:e.jsxs(c,{gap:"lg",children:[e.jsxs(b,{withBorder:!0,p:"md",style:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)"},children:[e.jsx(s,{fw:500,mb:"md",style:{color:"var(--lb-text-primary)"},children:"Function Settings"}),e.jsxs(c,{gap:"md",children:[e.jsx(m,{label:"Function Name",value:i.name,disabled:!0,styles:{label:{color:"var(--lb-text-secondary)"},input:{background:"var(--lb-bg-secondary)",borderColor:"var(--lb-border-default)"}}}),e.jsx(m,{label:"Slug",value:i.slug,disabled:!0,description:"URL path for invoking the function",styles:{label:{color:"var(--lb-text-secondary)"},description:{color:"var(--lb-text-tertiary)"},input:{background:"var(--lb-bg-secondary)",borderColor:"var(--lb-border-default)"}}}),e.jsx(m,{label:"Entrypoint",value:i.entrypoint,disabled:!0,styles:{label:{color:"var(--lb-text-secondary)"},input:{background:"var(--lb-bg-secondary)",borderColor:"var(--lb-border-default)"}}}),e.jsx(Re,{label:"Require JWT verification",description:"When enabled, requests must include a valid JWT token",checked:i.verify_jwt,onChange:async r=>{await u.updateFunction(i.id,{verify_jwt:r.target.checked}),await h()},styles:{label:{color:"var(--lb-text-primary)"},description:{color:"var(--lb-text-tertiary)"}}})]})]}),e.jsxs(b,{withBorder:!0,p:"md",style:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)"},children:[e.jsx(s,{fw:500,mb:"md",style:{color:"var(--lb-text-primary)"},children:"Endpoint"}),e.jsxs(o,{children:[e.jsxs(ze,{style:{flex:1,background:"var(--lb-bg-secondary)",color:"var(--lb-text-primary)"},children:[window.location.origin,"/functions/v1/",i.slug]}),e.jsx(vr,{value:`${window.location.origin}/functions/v1/${i.slug}`,children:({copied:r,copy:a})=>e.jsx(S,{variant:"subtle",onClick:a,style:{color:r?"var(--lb-success)":"var(--lb-text-secondary)"},children:r?e.jsx(zr,{size:16}):e.jsx(Tr,{size:16})})})]})]}),e.jsxs(b,{withBorder:!0,p:"md",style:{background:"var(--lb-error-bg)",borderColor:"var(--lb-error)",borderRadius:"var(--lb-radius-md)"},children:[e.jsx(s,{fw:500,mb:"md",style:{color:"var(--lb-error-text)"},children:"Danger Zone"}),e.jsx(x,{color:"red",variant:"outline",leftSection:e.jsx(X,{size:16}),onClick:()=>pe(i.id),style:{borderColor:"var(--lb-error)",color:"var(--lb-error)",transition:"var(--lb-transition-fast)"},children:"Delete function"})]})]})})})]})]}):e.jsx(b,{withBorder:!0,p:"xl",style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",background:"var(--lb-bg-secondary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)"},children:e.jsxs(c,{align:"center",children:[e.jsx(Rr,{size:64,style:{opacity:.3,color:"var(--lb-text-muted)"}}),e.jsx(s,{size:"lg",style:{color:"var(--lb-text-secondary)"},children:"Select a function or create a new one"}),e.jsx(x,{leftSection:e.jsx(O,{size:16}),onClick:()=>D(!0),style:{background:"var(--lb-brand)",borderRadius:"var(--lb-radius-md)",transition:"var(--lb-transition-fast)"},className:"lb-btn-primary",children:"Create function"})]})})]}),e.jsx(Fe,{opened:Je,onClose:()=>D(!1),title:"Create Edge Function",size:"lg",styles:{header:{background:"var(--lb-bg-secondary)",borderBottom:"1px solid var(--lb-border-default)"},title:{color:"var(--lb-text-primary)",fontWeight:600},body:{background:"var(--lb-bg-secondary)"},content:{borderRadius:"var(--lb-radius-lg)"}},children:e.jsxs(c,{gap:"md",children:[e.jsx(m,{label:"Function name",placeholder:"my-function",value:B,onChange:r=>le(r.target.value),description:"Use lowercase letters, numbers, and hyphens",styles:{label:{color:"var(--lb-text-primary)"},description:{color:"var(--lb-text-tertiary)"},input:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)"}}}),e.jsx(Re,{label:"Require JWT verification",description:"Requests must include a valid JWT token",checked:q,onChange:r=>ne(r.target.checked),styles:{label:{color:"var(--lb-text-primary)"},description:{color:"var(--lb-text-tertiary)"}}}),e.jsx(k,{label:"Start from template",labelPosition:"center",style:{borderColor:"var(--lb-border-muted)"}}),e.jsx(Te,{cols:2,children:Ve.map(r=>e.jsx(hr,{withBorder:!0,padding:"sm",style:{cursor:"pointer",background:L===r.id?"var(--lb-brand-light)":"var(--lb-bg-tertiary)",borderColor:L===r.id?"var(--lb-brand)":"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)",transition:"var(--lb-transition-fast)"},onClick:()=>oe(L===r.id?null:r.id),children:e.jsxs(o,{gap:"sm",children:[e.jsx(ke,{size:"lg",variant:"light",style:{background:"var(--lb-brand-light)",color:"var(--lb-brand)"},children:Jr[r.icon]||e.jsx(De,{size:20})}),e.jsxs(v,{children:[e.jsx(s,{size:"sm",fw:500,style:{color:"var(--lb-text-primary)"},children:r.name}),e.jsx(s,{size:"xs",style:{color:"var(--lb-text-tertiary)"},children:r.description})]})]})},r.id))}),e.jsxs(o,{justify:"flex-end",mt:"md",children:[e.jsx(x,{variant:"subtle",onClick:()=>D(!1),style:{color:"var(--lb-text-secondary)",transition:"var(--lb-transition-fast)"},children:"Cancel"}),e.jsx(x,{onClick:ar,disabled:!B.trim(),style:{background:"var(--lb-brand)",borderRadius:"var(--lb-radius-md)",transition:"var(--lb-transition-fast)"},className:"lb-btn-primary",children:"Create function"})]})]})}),e.jsx(Fe,{opened:He,onClose:()=>U(!1),title:"Manage Secrets",size:"lg",styles:{header:{background:"var(--lb-bg-secondary)",borderBottom:"1px solid var(--lb-border-default)"},title:{color:"var(--lb-text-primary)",fontWeight:600},body:{background:"var(--lb-bg-secondary)"},content:{borderRadius:"var(--lb-radius-lg)"}},children:e.jsxs(c,{gap:"md",children:[e.jsx(s,{size:"sm",style:{color:"var(--lb-text-secondary)"},children:"Secrets are available to all Edge Functions as environment variables."}),e.jsx(b,{withBorder:!0,p:"md",style:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)",borderRadius:"var(--lb-radius-md)"},children:e.jsx(c,{gap:"sm",children:R.length===0?e.jsx(s,{size:"sm",ta:"center",py:"md",style:{color:"var(--lb-text-secondary)"},children:"No secrets yet"}):R.map(r=>e.jsxs(o,{justify:"space-between",children:[e.jsx(s,{size:"sm",ff:"monospace",style:{color:"var(--lb-text-primary)"},children:r.name}),e.jsxs(o,{gap:"xs",children:[e.jsxs(s,{size:"xs",style:{color:"var(--lb-text-tertiary)"},children:["Added ",new Date(r.created_at).toLocaleDateString()]}),e.jsx(S,{variant:"subtle",color:"red",size:"sm",onClick:()=>nr(r.name),style:{color:"var(--lb-error)"},children:e.jsx(X,{size:14})})]})]},r.id))})}),e.jsx(k,{style:{borderColor:"var(--lb-border-muted)"}}),Ue?e.jsxs(e.Fragment,{children:[e.jsx(Se,{label:"Bulk add secrets (.env format)",placeholder:`SECRET_KEY=value
ANOTHER_KEY=another_value`,value:V,onChange:r=>ae(r.target.value),minRows:6,styles:{label:{color:"var(--lb-text-primary)"},input:{fontFamily:"monospace",background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)"}}}),e.jsxs(o,{justify:"flex-end",children:[e.jsx(x,{variant:"subtle",onClick:()=>J(!1),style:{color:"var(--lb-text-secondary)",transition:"var(--lb-transition-fast)"},children:"Cancel"}),e.jsx(x,{onClick:ir,style:{background:"var(--lb-brand)",borderRadius:"var(--lb-radius-md)",transition:"var(--lb-transition-fast)"},className:"lb-btn-primary",children:"Add secrets"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{children:[e.jsx(m,{placeholder:"Secret name",value:F,onChange:r=>te(r.target.value),style:{flex:1},styles:{input:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)"}}}),e.jsx(m,{placeholder:"Secret value",type:"password",value:I,onChange:r=>se(r.target.value),style:{flex:1},styles:{input:{background:"var(--lb-bg-tertiary)",borderColor:"var(--lb-border-default)"}}}),e.jsx(S,{variant:"filled",onClick:or,disabled:!F.trim()||!I.trim(),style:{background:"var(--lb-brand)",transition:"var(--lb-transition-fast)"},children:e.jsx(O,{size:16})})]}),e.jsx(x,{variant:"subtle",onClick:()=>J(!0),style:{color:"var(--lb-text-secondary)",transition:"var(--lb-transition-fast)"},children:"Bulk add from .env"})]})]})})]})}export{Zr as FunctionsPage,Zr as default};
