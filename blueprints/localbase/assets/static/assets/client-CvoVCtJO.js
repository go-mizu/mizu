var l=Object.defineProperty;var y=(c,e,t)=>e in c?l(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var h=(c,e,t)=>y(c,typeof e!="symbol"?e+"":e,t);const I="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImV4cCI6MTk4MzgxMjk5Nn0.EGIM96RAZx35lJzdJsyH-qQwv8Hdp7fsn3W0YpN81IU";class p extends Error{constructor(t,s,a){super(s);h(this,"status");h(this,"code");this.name="ApiClientError",this.status=t,this.code=a}}class w{getServiceKey(){return localStorage.getItem("serviceKey")||I}async request(e,t,s,a){const n=this.getServiceKey(),d={"Content-Type":"application/json",apikey:n,Authorization:`Bearer ${n}`,...a==null?void 0:a.headers},r=await fetch(t,{method:e,headers:d,body:s?JSON.stringify(s):void 0}),o=r.headers.get("content-type");let u=null;if(o!=null&&o.includes("application/json")){const i=await r.text();i&&(u=JSON.parse(i))}if(!r.ok){const i=u;throw new p(r.status,(i==null?void 0:i.msg)||(i==null?void 0:i.message)||(i==null?void 0:i.error)||"Request failed",i==null?void 0:i.error_code)}return u}async get(e,t){return this.request("GET",e,void 0,t)}async post(e,t,s){return this.request("POST",e,t,s)}async put(e,t,s){return this.request("PUT",e,t,s)}async patch(e,t,s){return this.request("PATCH",e,t,s)}async delete(e,t){return this.request("DELETE",e,void 0,t)}async uploadFile(e,t){const s=this.getServiceKey(),a=await fetch(e,{method:"POST",headers:{apikey:s,Authorization:`Bearer ${s}`},body:t});if(!a.ok){const n=await a.json().catch(()=>({}));throw new p(a.status,(n==null?void 0:n.message)||(n==null?void 0:n.error)||"Upload failed",n==null?void 0:n.error_code)}return a.json()}getAuthenticatedUrl(e){const t=this.getServiceKey(),s=new URL(e,window.location.origin);return s.searchParams.set("apikey",t),s.toString()}}const v=new w;export{v as a};
