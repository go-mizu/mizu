import{j as e,B as l,q as I,G as n,T as i,a3 as D,D as d,S as c,r as h,V as L,N as k,a as x}from"./vendor-mantine-aKbh6G_O.js";import{u as T,r as o,L as _,O as C}from"./vendor-react-CA6k1jPF.js";import{d as p}from"./database-Co5xRXKh.js";import{I as E,c as P,d as B,e as N,j as O,i as R,k as V,f as A,h as F,g as q,aZ as G}from"./vendor-icons-BYOfSTr6.js";import"./client-CvoVCtJO.js";const W=[{icon:P,label:"Tables",path:"/database/tables"},{icon:B,label:"SQL Editor",path:"/database/sql"},{icon:N,label:"Schema Visualizer",path:"/database/schema"},{icon:O,label:"Policies",path:"/database/policies"},{icon:R,label:"Roles",path:"/database/roles"},{icon:V,label:"Indexes",path:"/database/indexes"},{icon:A,label:"Views",path:"/database/views"},{icon:F,label:"Triggers",path:"/database/triggers"},{icon:q,label:"Functions",path:"/database/functions"},{icon:G,label:"Extensions",path:"/database/extensions"}];function K({children:b}){const r=T(),[s,u]=o.useState(null),[m,j]=o.useState([]),[f,g]=o.useState("public"),[v,S]=o.useState(!0);o.useEffect(()=>{(async()=>{try{const[t,z]=await Promise.all([p.getOverview(),p.listSchemas()]);u(t),j(z)}catch(t){console.error("Failed to fetch database overview:",t)}finally{S(!1)}})()},[]);const y=a=>r.pathname===a||r.pathname.startsWith(a+"/"),w=a=>{if(s)switch(a){case"Tables":return s.total_tables;case"Views":return s.total_views;case"Indexes":return s.total_indexes;case"Policies":return s.total_policies;case"Functions":return s.total_functions;default:return}};return e.jsxs(l,{style:{display:"flex",height:"100%"},children:[e.jsxs(I,{style:{width:240,minWidth:240,height:"100%",borderRight:"1px solid var(--mantine-color-default-border)",display:"flex",flexDirection:"column",backgroundColor:"var(--mantine-color-body)"},children:[e.jsxs(l,{p:"md",pb:"sm",children:[e.jsxs(n,{gap:"xs",mb:"sm",children:[e.jsx(E,{size:20,style:{color:"var(--mantine-color-green-6)"}}),e.jsx(i,{fw:600,size:"sm",children:"Database"})]}),e.jsx(D,{size:"xs",placeholder:"Select schema",value:f,onChange:a=>g(a||"public"),data:m.map(a=>({value:a,label:a})),styles:{input:{fontSize:"12px"}}})]}),e.jsx(d,{}),e.jsx(l,{px:"md",py:"sm",children:v?e.jsxs(c,{gap:"xs",children:[e.jsx(h,{height:14,width:"60%"}),e.jsx(h,{height:14,width:"80%"})]}):s?e.jsxs(c,{gap:4,children:[e.jsxs(n,{gap:"xs",justify:"space-between",children:[e.jsx(i,{size:"xs",c:"dimmed",children:"Size"}),e.jsx(i,{size:"xs",fw:500,children:s.database_size})]}),e.jsxs(n,{gap:"xs",justify:"space-between",children:[e.jsx(i,{size:"xs",c:"dimmed",children:"Connections"}),e.jsx(i,{size:"xs",fw:500,children:s.connection_count})]})]}):null}),e.jsx(d,{}),e.jsx(L,{style:{flex:1},p:"xs",children:e.jsx(c,{gap:2,children:W.map(a=>{const t=w(a.label);return e.jsx(k,{component:_,to:a.path,label:a.label,leftSection:e.jsx(a.icon,{size:16,stroke:1.5}),rightSection:t!==void 0?e.jsx(x,{size:"xs",variant:"light",color:"gray",radius:"sm",children:t}):a.badge?e.jsx(x,{size:"xs",variant:"light",color:a.badgeColor||"gray",children:a.badge}):void 0,active:y(a.path),style:{borderRadius:6},styles:{root:{fontSize:"13px"}}},a.path)})})})]}),e.jsx(l,{style:{flex:1,overflow:"auto"},children:b||e.jsx(C,{})})]})}export{K as DatabaseLayout};
