{{define "ClientOptions.java.tmpl"}}// Code generated by sdkjava. DO NOT EDIT.

package {{.Package}};

import java.net.http.HttpClient;
import java.time.Duration;
import java.util.Collections;
import java.util.HashMap;
import java.util.Map;
import java.util.Objects;

/**
 * Configuration options for the SDK client.
 *
 * <p>This class is immutable and thread-safe. Use {@link #builder()} to create instances.
 */
public final class ClientOptions {

    private final String apiKey;
    private final String baseUrl;
    private final Duration timeout;
    private final Duration connectTimeout;
    private final int maxRetries;
    private final Map<String, String> defaultHeaders;
    private final AuthMode authMode;
    private final HttpClient httpClient;

    private ClientOptions(Builder builder) {
        this.apiKey = builder.apiKey;
        this.baseUrl = builder.baseUrl;
        this.timeout = builder.timeout;
        this.connectTimeout = builder.connectTimeout;
        this.maxRetries = builder.maxRetries;
        this.defaultHeaders = Collections.unmodifiableMap(new HashMap<>(builder.defaultHeaders));
        this.authMode = builder.authMode;
        this.httpClient = builder.httpClient;
    }

    /**
     * Creates a new builder for configuring client options.
     *
     * @return a new builder instance
     */
    public static Builder builder() {
        return new Builder();
    }

    /**
     * Returns the API key for authentication.
     *
     * @return the API key, or null if not set
     */
    public String getApiKey() {
        return apiKey;
    }

    /**
     * Returns the base URL for API requests.
     *
     * @return the base URL
     */
    public String getBaseUrl() {
        return baseUrl;
    }

    /**
     * Returns the request timeout.
     *
     * @return the request timeout
     */
    public Duration getTimeout() {
        return timeout;
    }

    /**
     * Returns the connection timeout.
     *
     * @return the connection timeout
     */
    public Duration getConnectTimeout() {
        return connectTimeout;
    }

    /**
     * Returns the maximum number of retry attempts.
     *
     * @return the maximum retries
     */
    public int getMaxRetries() {
        return maxRetries;
    }

    /**
     * Returns the default headers included in all requests.
     *
     * @return an unmodifiable map of default headers
     */
    public Map<String, String> getDefaultHeaders() {
        return defaultHeaders;
    }

    /**
     * Returns the authentication mode.
     *
     * @return the authentication mode
     */
    public AuthMode getAuthMode() {
        return authMode;
    }

    /**
     * Returns the custom HTTP client, if set.
     *
     * @return the HTTP client, or null if using default
     */
    public HttpClient getHttpClient() {
        return httpClient;
    }

    /**
     * Creates a new builder pre-populated with this options' values.
     *
     * @return a new builder
     */
    public Builder toBuilder() {
        return new Builder()
            .apiKey(this.apiKey)
            .baseUrl(this.baseUrl)
            .timeout(this.timeout)
            .connectTimeout(this.connectTimeout)
            .maxRetries(this.maxRetries)
            .defaultHeaders(this.defaultHeaders)
            .authMode(this.authMode)
            .httpClient(this.httpClient);
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        ClientOptions that = (ClientOptions) o;
        return maxRetries == that.maxRetries &&
            Objects.equals(apiKey, that.apiKey) &&
            Objects.equals(baseUrl, that.baseUrl) &&
            Objects.equals(timeout, that.timeout) &&
            Objects.equals(connectTimeout, that.connectTimeout) &&
            Objects.equals(defaultHeaders, that.defaultHeaders) &&
            authMode == that.authMode;
    }

    @Override
    public int hashCode() {
        return Objects.hash(apiKey, baseUrl, timeout, connectTimeout, maxRetries, defaultHeaders, authMode);
    }

    @Override
    public String toString() {
        return "ClientOptions{" +
            "baseUrl='" + baseUrl + '\'' +
            ", timeout=" + timeout +
            ", connectTimeout=" + connectTimeout +
            ", maxRetries=" + maxRetries +
            ", authMode=" + authMode +
            ", hasApiKey=" + (apiKey != null) +
            '}';
    }

    /**
     * Builder for creating ClientOptions instances.
     */
    public static final class Builder {
        private String apiKey;
        private String baseUrl = {{javaString .Client.BaseURL}};
        private Duration timeout = Duration.ofSeconds(60);
        private Duration connectTimeout = Duration.ofSeconds(10);
        private int maxRetries = 2;
        private Map<String, String> defaultHeaders = new HashMap<>();
        private AuthMode authMode = AuthMode.BEARER;
        private HttpClient httpClient;

        private Builder() {
{{- if .Client.Headers}}
            // Default headers from service definition
{{- range .Client.Headers}}
            this.defaultHeaders.put({{javaString .K}}, {{javaString .V}});
{{- end}}
{{- end}}
        }

        /**
         * Sets the API key for authentication.
         *
         * @param apiKey the API key
         * @return this builder
         */
        public Builder apiKey(String apiKey) {
            this.apiKey = apiKey;
            return this;
        }

        /**
         * Sets the base URL for API requests.
         *
         * @param baseUrl the base URL
         * @return this builder
         */
        public Builder baseUrl(String baseUrl) {
            this.baseUrl = Objects.requireNonNull(baseUrl, "baseUrl");
            return this;
        }

        /**
         * Sets the request timeout.
         *
         * @param timeout the request timeout
         * @return this builder
         */
        public Builder timeout(Duration timeout) {
            this.timeout = Objects.requireNonNull(timeout, "timeout");
            return this;
        }

        /**
         * Sets the connection timeout.
         *
         * @param connectTimeout the connection timeout
         * @return this builder
         */
        public Builder connectTimeout(Duration connectTimeout) {
            this.connectTimeout = Objects.requireNonNull(connectTimeout, "connectTimeout");
            return this;
        }

        /**
         * Sets the maximum number of retry attempts.
         *
         * @param maxRetries the maximum retries (must be >= 0)
         * @return this builder
         * @throws IllegalArgumentException if maxRetries is negative
         */
        public Builder maxRetries(int maxRetries) {
            if (maxRetries < 0) {
                throw new IllegalArgumentException("maxRetries must be >= 0");
            }
            this.maxRetries = maxRetries;
            return this;
        }

        /**
         * Adds a default header to all requests.
         *
         * @param name the header name
         * @param value the header value
         * @return this builder
         */
        public Builder addHeader(String name, String value) {
            this.defaultHeaders.put(
                Objects.requireNonNull(name, "header name"),
                Objects.requireNonNull(value, "header value")
            );
            return this;
        }

        /**
         * Sets all default headers, replacing any existing headers.
         *
         * @param headers the headers map
         * @return this builder
         */
        public Builder defaultHeaders(Map<String, String> headers) {
            this.defaultHeaders = new HashMap<>(Objects.requireNonNull(headers, "headers"));
            return this;
        }

        /**
         * Sets the authentication mode.
         *
         * @param authMode the authentication mode
         * @return this builder
         */
        public Builder authMode(AuthMode authMode) {
            this.authMode = Objects.requireNonNull(authMode, "authMode");
            return this;
        }

        /**
         * Sets a custom HTTP client.
         *
         * <p>If not set, a default HTTP client will be created.
         *
         * @param httpClient the HTTP client
         * @return this builder
         */
        public Builder httpClient(HttpClient httpClient) {
            this.httpClient = httpClient;
            return this;
        }

        /**
         * Builds the client options with the configured values.
         *
         * @return a new ClientOptions instance
         */
        public ClientOptions build() {
            return new ClientOptions(this);
        }
    }
}
{{end}}
