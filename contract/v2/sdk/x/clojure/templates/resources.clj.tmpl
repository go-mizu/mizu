{{define "resources.clj.tmpl"}};; Code generated by sdkclojure. DO NOT EDIT.

(ns {{.Namespace}}.resources
  "Resource method implementations for {{.Service.Name}} SDK.

   This namespace contains the underlying implementations of API methods.
   For typical usage, prefer the functions in {{.Namespace}}.core which
   provide a more convenient API."
  (:require [{{.Namespace}}.core :as core]
            [{{.Namespace}}.types :as types]
{{- if .HasSSE}}
            [{{.Namespace}}.streaming :as streaming]
{{- end}}))

;; -----------------------------------------------------------------------------
;; Resource Implementations
;; -----------------------------------------------------------------------------
{{range $r := .Resources}}

;; =============================================================================
;; {{$r.Name | pascal}} Resource
;; =============================================================================
{{- if $r.Description}}
;;
;; {{$r.Description}}
{{- end}}
{{range $m := $r.Methods}}

(defn {{$m.CljName}}
  "{{if $m.Description}}{{$m.Description}}{{else}}{{$m.Name}} operation on {{$r.Name}} resource.{{end}}
{{- if $m.IsStreaming}}

   Returns a core.async channel of events.
{{- end}}

   HTTP: {{$m.HTTPMethod | upper}} {{$m.HTTPPath}}
{{- if $m.HasInput}}

   Parameters:
     client  - The API client
     request - {{$m.InputType}} request data
     opts    - Optional request options
{{- else}}

   Parameters:
     client  - The API client
     opts    - Optional request options
{{- end}}"
{{- if not $m.IsStreaming}}
{{- if $m.HasInput}}
  ([client request]
   ({{$m.CljName}} client request {}))
  ([client request opts]
   (-> (core/request client :{{$m.HTTPMethod}} {{cljString $m.HTTPPath}}
                     (types/stringify-request request) opts)
{{- if $m.HasOutput}}
       types/->{{kebab $m.OutputType}}))
{{- else}}
       types/keywordize-response))
{{- end}}
{{- else}}
  ([client]
   ({{$m.CljName}} client {}))
  ([client opts]
   (-> (core/request client :{{$m.HTTPMethod}} {{cljString $m.HTTPPath}} nil opts)
{{- if $m.HasOutput}}
       types/->{{kebab $m.OutputType}}))
{{- else}}
       types/keywordize-response))
{{- end}}
{{- end}}
{{- else}}
{{- if $m.HasInput}}
  ([client request]
   ({{$m.CljName}} client request {}))
  ([client request opts]
   (core/stream-request client :{{$m.HTTPMethod}} {{cljString $m.HTTPPath}}
                        (-> request types/stringify-request (assoc "stream" true))
                        opts))
{{- else}}
  ([client]
   ({{$m.CljName}} client {}))
  ([client opts]
   (core/stream-request client :{{$m.HTTPMethod}} {{cljString $m.HTTPPath}}
                        {"stream" true} opts))
{{- end}}
{{- end}}
{{- end}}
{{- end}}

;; -----------------------------------------------------------------------------
;; Method Registry
;; -----------------------------------------------------------------------------

(def methods
  "Registry of all available API methods."
  {
{{- range $r := .Resources}}
{{- range $m := $r.Methods}}
   :{{$m.FullName}} {:resource {{cljString $r.Name}}
                     :method {{cljString $m.Name}}
                     :http-method :{{$m.HTTPMethod}}
                     :http-path {{cljString $m.HTTPPath}}
                     :streaming {{$m.IsStreaming}}
                     :has-input {{$m.HasInput}}
                     :has-output {{$m.HasOutput}}}
{{- end}}
{{- end}}})
{{end}}