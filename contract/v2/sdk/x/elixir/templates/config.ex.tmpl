{{define "config.ex.tmpl"}}# Code generated by sdkelixir. DO NOT EDIT.

defmodule {{.ModuleName}}.Config do
  @moduledoc """
  Configuration for the {{.ModuleName}} client.

  ## Options

    * `:api_key` - API key for authentication
    * `:base_url` - Base URL for API requests (default: #{inspect({{elixirQuote .Client.BaseURL}})})
    * `:timeout` - Request timeout in milliseconds (default: 60_000)
    * `:max_retries` - Maximum retry attempts (default: 2)
    * `:auth_mode` - Authentication mode: `:bearer`, `:basic`, `:header`, `:none` (default: :bearer)
    * `:headers` - Additional headers for all requests

  ## Application Configuration

  You can configure defaults via application environment:

      config :{{.AppName}},
        api_key: System.get_env("API_KEY"),
        base_url: {{elixirQuote .Client.BaseURL}},
        timeout: 60_000
  """

  @type auth_mode :: :bearer | :basic | :header | :none

  @type t :: %__MODULE__{
          api_key: String.t() | nil,
          base_url: String.t(),
          timeout: pos_integer(),
          max_retries: non_neg_integer(),
          auth_mode: auth_mode(),
          headers: map()
        }

  @enforce_keys []
  defstruct api_key: nil,
            base_url: {{elixirQuote .Client.BaseURL}},
            timeout: 60_000,
            max_retries: 2,
            auth_mode: :bearer,
            headers: %{
{{- range .Client.Headers}}
              {{elixirQuote .K}} => {{elixirQuote .V}},
{{- end}}
            }

  @doc """
  Creates a new configuration.

  Options are merged with application config and defaults.

  ## Examples

      iex> Config.new(api_key: "sk-...")
      %Config{api_key: "sk-...", ...}
  """
  @spec new(keyword()) :: t()
  def new(opts \\ []) do
    # Get application config
    app_config =
      Application.get_all_env(:{{.AppName}})
      |> Keyword.take([:api_key, :base_url, :timeout, :max_retries, :auth_mode, :headers])

    # Merge: defaults < app config < opts
    merged =
      %__MODULE__{}
      |> Map.from_struct()
      |> Map.merge(Map.new(app_config))
      |> Map.merge(Map.new(opts))

    struct!(__MODULE__, merged)
  end

  @doc """
  Returns the default configuration.
  """
  @spec default() :: t()
  def default do
    %__MODULE__{}
  end
end
{{end}}