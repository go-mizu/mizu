{{define "UnionType.php.tmpl"}}<?php

declare(strict_types=1);

// Code generated by sdkphp. DO NOT EDIT.

namespace {{.Namespace}}\Types;

/**
{{- if .Type.Description}}
 * {{.Type.Description}}
{{- else}}
 * {{.Type.PHPName}} discriminated union type.
{{- end}}
 *
 * Discriminator field: {{.Type.Tag}}
{{- range .Type.Variants}}
 * - "{{.Value}}" => {{.PHPName}}
{{- end}}
 */
abstract readonly class {{.Type.PHPName}} implements \JsonSerializable
{
    public function __construct(
        public string ${{camel .Type.Tag}},
    ) {}

    /**
     * Creates an instance from an array based on the discriminator field.
     *
     * @param array<string, mixed> $data
     * @throws \InvalidArgumentException If discriminator is missing or unknown
     */
    public static function fromArray(array $data): self
    {
        $type = $data[{{phpQuote .Type.Tag}}] ?? throw new \InvalidArgumentException('Missing discriminator field: {{.Type.Tag}}');

        return match ($type) {
{{- range .Type.Variants}}
            {{phpQuote .Value}} => {{.PHPName}}::fromArray($data),
{{- end}}
            default => throw new \InvalidArgumentException("Unknown {{.Type.PHPName}} type: $type"),
        };
    }

    /**
     * @return array<string, mixed>
     */
    abstract public function toArray(): array;

    /**
     * @return array<string, mixed>
     */
    public function jsonSerialize(): array
    {
        return $this->toArray();
    }
}
{{end}}