{{define "errors.mli.tmpl"}}(** Code generated by sdkocaml. DO NOT EDIT.

    Error types for {{.ModuleName}} API.
*)

(** Error type classification. *)
type error_type =
  | Bad_request           (** HTTP 400 *)
  | Unauthorized          (** HTTP 401 *)
  | Forbidden             (** HTTP 403 *)
  | Not_found             (** HTTP 404 *)
  | Unprocessable_entity  (** HTTP 422 *)
  | Rate_limited          (** HTTP 429 *)
  | Server_error          (** HTTP 5xx *)
  | Network_error         (** Connection/network errors *)
  | Parse_error_type      (** JSON parsing errors *)
  | Timeout_error_type    (** Request timeout *)
  | Stream_error_type     (** SSE parsing errors *)

val show_error_type : error_type -> string
val equal_error_type : error_type -> error_type -> bool

(** API error details from server response. *)
type api_error = {
  error_type_str : string;
  message : string;
  param : string option;
  code : string option;
}

val show_api_error : api_error -> string
val equal_api_error : api_error -> api_error -> bool
val api_error_of_yojson : Yojson.Safe.t -> api_error
val yojson_of_api_error : api_error -> Yojson.Safe.t

(** SDK error type.

    Pattern match to handle different error cases:

    {[
      match err with
      | Api_error { status; error } ->
          Printf.printf "API error: %s\n" error.message
      | Connection_error msg ->
          Printf.printf "Network error: %s\n" msg
      | Rate_limit_error { retry_after; _ } ->
          Unix.sleepf (Float.of_int retry_after);
          (* retry *)
      | _ -> Printf.printf "Error: %s\n" (show err)
    ]}
*)
type t =
  | Api_error of { status : int; error : api_error }
      (** API returned an error response *)
  | Connection_error of string
      (** Network/connection error *)
  | Timeout_error of string
      (** Request timed out *)
  | Parse_error of string
      (** Failed to parse response *)
  | Rate_limit_error of { retry_after : int; error : api_error option }
      (** Rate limited (retry after N seconds) *)
  | Stream_error of string
      (** Error in SSE stream *)

val show : t -> string
val equal : t -> t -> bool

(** Create an error from an HTTP response.

    @param status HTTP status code
    @param body Response body
    @return Appropriate error type
*)
val of_response : status:int -> body:string -> t

(** Create an error from an exception.

    @param exn The exception
    @return Connection_error with exception message
*)
val of_exn : exn -> t

(** Check if an error is retryable.

    {[
      if is_retryable err then
        (* retry with backoff *)
      else
        (* fail *)
    ]}
*)
val is_retryable : t -> bool

(** Get human-readable error message. *)
val message : t -> string

(** Get HTTP status code if applicable. *)
val status : t -> int option

(** Get error classification. *)
val classify : t -> error_type
{{end}}