---
title: "Templates"
description: "Understanding Go template syntax and data access in Mizu's view system"
---

This guide covers everything you need to know about writing templates in Mizu's view system. We'll explore Go's template syntax, how data flows through your templates, and common patterns.

## Template Basics

Mizu uses Go's standard `html/template` package. Templates are HTML files with special markers (`{{` and `}}`) for dynamic content.

```html
<!-- views/home.html -->
{{define "content"}}
<h1>Hello, {{.Name}}!</h1>
<p>Welcome to our site.</p>
{{end}}
```

## Go Template Syntax

If you're new to Go templates, here's a quick introduction.

### Outputting Values

Use `.` (the dot) to access data passed to the template:

```html
<!-- Simple value -->
<h1>{{.Title}}</h1>

<!-- Nested value -->
<p>Author: {{.Post.Author.Name}}</p>

<!-- Map access -->
<p>Setting: {{.Settings.theme}}</p>
```

### Conditions

Use `if` to show content conditionally:

```html
{{if .LoggedIn}}
    <p>Welcome back!</p>
{{else}}
    <p>Please log in.</p>
{{end}}

{{if .Error}}
    <div class="error">{{.Error}}</div>
{{end}}
```

### Comparison Operators

Go templates provide comparison functions:

| Function | Description | Example |
|----------|-------------|---------|
| `eq` | Equal | `{{if eq .Status "active"}}` |
| `ne` | Not equal | `{{if ne .Count 0}}` |
| `lt` | Less than | `{{if lt .Price 100}}` |
| `le` | Less than or equal | `{{if le .Stock 5}}` |
| `gt` | Greater than | `{{if gt .Price 100}}` |
| `ge` | Greater than or equal | `{{if ge .Age 18}}` |

```html
{{if eq .Status "active"}}Active{{end}}
{{if ne .Count 0}}Has items{{end}}
{{if gt .Price 100}}Premium{{end}}
{{if le .Stock 5}}Low stock{{end}}
```

### Boolean Logic

Combine conditions with `and`, `or`, and `not`:

```html
{{if and .LoggedIn .IsAdmin}}
    Admin controls
{{end}}

{{if or .Error .Warning}}
    <div class="alert">Check messages</div>
{{end}}

{{if not .Disabled}}
    <button>Click me</button>
{{end}}
```

### Loops

Use `range` to iterate over slices, arrays, or maps:

```html
<!-- Loop over slice -->
<ul>
    {{range .Items}}
    <li>{{.}}</li>
    {{end}}
</ul>

<!-- With index -->
<ul>
    {{range $index, $item := .Items}}
    <li>{{$index}}: {{$item}}</li>
    {{end}}
</ul>

<!-- Empty case -->
{{range .Items}}
    <li>{{.}}</li>
{{else}}
    <li>No items found.</li>
{{end}}
```

### Looping Over Structs

When ranging over a slice of structs:

```html
{{range .Users}}
    <!-- Inside range, . is the current user -->
    <div class="user">
        <h3>{{.Name}}</h3>
        <p>{{.Email}}</p>
    </div>
{{end}}
```

### Looping Over Maps

```html
{{range $key, $value := .Settings}}
    <p>{{$key}}: {{$value}}</p>
{{end}}
```

### Variables

Assign values to variables with `:=`:

```html
{{$name := .User.Name}}
<p>Hello, {{$name}}!</p>

{{$fullName := printf "%s %s" .FirstName .LastName}}
<p>{{$fullName}}</p>
```

### The Root Context ($)

Inside a `range` loop, `.` refers to the current item. Use `$` to access the root context:

```html
{{range .Users}}
    <p>{{.Name}}</p>
    {{if $.ShowEmail}}
        <p>{{.Email}}</p>
    {{end}}
{{end}}
```

`$` always refers to the original data passed to the template.

### Pipelines

Chain operations with `|`:

```html
<!-- Apply function to value -->
<p>{{.Name | upper}}</p>

<!-- Chain multiple functions -->
<p>{{.Title | lower | trim}}</p>
```

### Comments

Template comments are stripped from output:

```html
{{/* This comment won't appear in the HTML */}}
<p>Visible content</p>
```

### Whitespace Control

Use `-` to trim whitespace:

```html
{{- .Name -}}    <!-- Trims whitespace before and after -->
{{- .Name}}      <!-- Trims whitespace before -->
{{.Name -}}      <!-- Trims whitespace after -->
```

This is useful for keeping your HTML clean:

```html
<ul>
    {{- range .Items}}
    <li>{{.}}</li>
    {{- end}}
</ul>
```

## Template Blocks

### define and template

Templates can define named blocks that other templates reference:

```html
<!-- Define a reusable block -->
{{define "header"}}
<header>
    <h1>{{.Title}}</h1>
</header>
{{end}}

<!-- Use the block -->
{{template "header" .}}
```

The second argument to `template` is the data passed to the block. Use `.` to pass all current data.

### block with Default Content

`block` defines a template with default content that can be overridden:

```html
<!-- In layout.html -->
{{block "sidebar" .}}
<aside>Default sidebar content</aside>
{{end}}
```

If another template defines `sidebar`, that content is used instead.

## Working with Data

### Passing Data from Handlers

In your Go handler:

```go
view.From(c).Render(c, "profile", view.Data{
    "User":    user,
    "Posts":   posts,
    "IsAdmin": true,
})
```

In your template:

```html
<h1>{{.User.Name}}</h1>

{{if .IsAdmin}}
<a href="/admin">Admin Panel</a>
{{end}}

{{range .Posts}}
<article>{{.Title}}</article>
{{end}}
```

### Accessing Nested Data

```html
<!-- Struct field -->
{{.User.Profile.Bio}}

<!-- Map key -->
{{.Settings.theme}}

<!-- Slice index -->
{{index .Items 0}}
```

### Calling Methods

If your data has methods, you can call them:

```go
type User struct {
    FirstName string
    LastName  string
}

func (u User) FullName() string {
    return u.FirstName + " " + u.LastName
}
```

```html
<p>{{.User.FullName}}</p>
```

Note: Methods must have no parameters or only one parameter (which must be passed).

## Layout Templates

Layouts wrap your page content. They use `{{template "content" .}}` to include the page.

### Layout Structure

```html
<!-- views/layout.html -->
<!DOCTYPE html>
<html>
<head>
    <title>{{.Title}}</title>
</head>
<body>
    <nav>
        <a href="/">Home</a>
        <a href="/about">About</a>
    </nav>
    <main>
        {{template "content" .}}
    </main>
    <footer>
        Copyright 2024
    </footer>
</body>
</html>
```

### Page Template

Pages define the `content` block:

```html
<!-- views/home.html -->
{{define "content"}}
<h1>Welcome, {{.Name}}!</h1>
<p>This is the home page.</p>
{{end}}
```

## Common Patterns

### Conditional Classes

```html
<div class="card {{if .Featured}}card-featured{{end}}">
    ...
</div>

<!-- Multiple conditional classes -->
<button class="btn {{if .Primary}}btn-primary{{else}}btn-secondary{{end}} {{if .Large}}btn-lg{{end}}">
    {{.Label}}
</button>
```

### Dynamic Attributes

```html
<input
    type="text"
    name="{{.Name}}"
    value="{{.Value}}"
    {{if .Required}}required{{end}}
    {{if .Disabled}}disabled{{end}}
>
```

### Safe HTML Output

By default, Go templates escape HTML to prevent XSS attacks:

```html
<!-- Escaped (safe) - shows HTML as text -->
<div>{{.Content}}</div>
<!-- If .Content is "<b>bold</b>", outputs: &lt;b&gt;bold&lt;/b&gt; -->
```

To output raw HTML (use only with trusted content!):

```go
import "html/template"

view.Data{
    "Content": template.HTML("<b>bold</b>"),
}
```

```html
<div>{{.Content}}</div>
<!-- Now outputs: <b>bold</b> -->
```

### Empty/Nil Checks

```html
<!-- Check for empty string -->
{{if .Description}}
    <p>{{.Description}}</p>
{{end}}

<!-- Check slice length -->
{{if .Items}}
    <ul>
        {{range .Items}}
        <li>{{.}}</li>
        {{end}}
    </ul>
{{else}}
    <p>No items found.</p>
{{end}}
```

### Building Links

```html
<a href="/users/{{.User.ID}}">View Profile</a>
<a href="/posts?page={{.Page}}">Next Page</a>
```

### Formatting Numbers and Dates

Use custom functions or `printf`:

```html
<p>Price: ${{printf "%.2f" .Price}}</p>
<p>Count: {{printf "%d" .Count}}</p>
```

For dates, either format in Go or use a custom function:

```go
view.Data{
    "FormattedDate": time.Now().Format("January 2, 2006"),
}
```

Or add a custom function:

```go
view.Config{
    Funcs: template.FuncMap{
        "formatDate": func(t time.Time) string {
            return t.Format("Jan 2, 2006")
        },
    },
}
```

```html
<p>Published: {{formatDate .PublishedAt}}</p>
```

## Debugging Templates

### Print Values

Use `printf` with `%#v` to see the Go syntax representation:

```html
<pre>{{printf "%#v" .}}</pre>
```

### Check Types

```html
<p>Type: {{printf "%T" .Items}}</p>
```

### Enable Development Mode

For detailed error messages with line numbers:

```go
view.New(view.Config{
    Development: true,
})
```

## Best Practices

### 1. Keep Templates Simple

Put complex logic in Go handlers, not templates:

```go
// Good: logic in handler
isVIP := user.TotalPurchases > 1000 && user.MemberSince.Before(cutoff)
view.Data{"IsVIP": isVIP}
```

```html
<!-- Template just uses the result -->
{{if .IsVIP}}VIP Member{{end}}
```

### 2. Use Meaningful Variable Names

```html
{{range $user := .Users}}
    <p>{{$user.Name}}</p>
{{end}}
```

### 3. Document Expected Data

Add comments at the top of templates:

```html
{{/*
    Expected data:
    - Title: string
    - User: {Name, Email}
    - Posts: []Post
*/}}
```

### 4. Escape User Input

Always let Go's default escaping protect against XSS. Only use `template.HTML` for content you trust completely.

### 5. Use Whitespace Trimming

Keep generated HTML clean:

```html
<ul>
{{- range .Items}}
    <li>{{.}}</li>
{{- end}}
</ul>
```
