# GitHome UI Specification (0205)

This specification defines the UI implementation for GitHome, creating a GitHub-like interface using type-safe page data patterns (following the kanban blueprint) and HTML templates.

## Overview

GitHome's UI follows GitHub's Primer Design System principles:
- Token-based CSS variables for theming (light/dark mode)
- Clean, semantic HTML structure
- Responsive mobile-first design
- SVG icons (Octicons-style)

## File Structure

```
blueprints/githome/
├── app/web/handler/
│   ├── page.go          # Type-safe page data structs and handlers
│   └── page_test.go     # Template rendering tests
├── assets/
│   ├── embed.go         # Template loading and embedding
│   ├── static/
│   │   ├── css/
│   │   │   └── main.css # GitHub-like styles with CSS variables
│   │   └── js/
│   │       └── app.js   # Minimal interactive behaviors
│   └── views/
│       └── default/
│           ├── layouts/
│           │   ├── default.html  # Main authenticated layout
│           │   └── auth.html     # Auth pages layout
│           └── pages/
│               ├── login.html
│               ├── register.html
│               ├── home.html          # Dashboard when logged in
│               ├── explore.html       # Explore public repos
│               ├── user_profile.html  # User profile page
│               ├── repo_home.html     # Repository main page
│               ├── repo_issues.html   # Issues list
│               ├── repo_pulls.html    # Pull requests list
│               ├── repo_code.html     # File browser
│               ├── issue_view.html    # Single issue
│               ├── pull_view.html     # Single PR
│               ├── new_repo.html      # Create repository
│               ├── new_issue.html     # Create issue
│               ├── repo_settings.html # Repository settings
│               └── notifications.html # Notifications page
```

## Color System (CSS Variables)

Following GitHub's Primer design tokens:

```css
:root {
  /* Light mode (default) */
  --color-fg-default: #1f2328;
  --color-fg-muted: #656d76;
  --color-fg-subtle: #6e7781;
  --color-fg-on-emphasis: #ffffff;

  --color-bg-default: #ffffff;
  --color-bg-subtle: #f6f8fa;
  --color-bg-inset: #f6f8fa;
  --color-bg-emphasis: #24292f;

  --color-border-default: #d0d7de;
  --color-border-muted: #d8dee4;
  --color-border-subtle: rgba(27,31,36,0.15);

  --color-accent-fg: #0969da;
  --color-accent-emphasis: #0969da;
  --color-accent-muted: rgba(9,105,218,0.4);
  --color-accent-subtle: #ddf4ff;

  --color-success-fg: #1a7f37;
  --color-success-emphasis: #1f883d;
  --color-success-muted: rgba(26,127,55,0.4);
  --color-success-subtle: #dafbe1;

  --color-danger-fg: #d1242f;
  --color-danger-emphasis: #cf222e;
  --color-danger-muted: rgba(209,36,47,0.4);
  --color-danger-subtle: #ffebe9;

  --color-warning-fg: #9a6700;
  --color-warning-emphasis: #bf8700;
  --color-warning-muted: rgba(154,103,0,0.4);
  --color-warning-subtle: #fff8c5;

  --color-open-fg: #1a7f37;
  --color-open-emphasis: #1f883d;
  --color-closed-fg: #8250df;
  --color-closed-emphasis: #8250df;
  --color-merged-fg: #8250df;
  --color-merged-emphasis: #8250df;

  /* Neutral scale */
  --color-neutral-muted: rgba(175,184,193,0.2);
  --color-neutral-subtle: rgba(234,238,242,0.5);

  /* Header */
  --color-header-bg: #24292f;
  --color-header-text: #ffffff;
  --color-header-divider: #57606a;

  /* Shadows */
  --shadow-sm: 0 1px 0 rgba(27,31,36,0.04);
  --shadow-md: 0 3px 6px rgba(140,149,159,0.15);
  --shadow-lg: 0 8px 24px rgba(140,149,159,0.2);

  /* Border radius */
  --border-radius-sm: 3px;
  --border-radius-md: 6px;
  --border-radius-lg: 12px;

  /* Typography */
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans", Helvetica, Arial, sans-serif;
  --font-family-mono: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, monospace;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 20px;
  --font-size-2xl: 24px;
  --font-size-3xl: 32px;

  /* Spacing */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 16px;
  --space-4: 24px;
  --space-5: 32px;
  --space-6: 40px;
}

/* Dark mode */
[data-theme="dark"] {
  --color-fg-default: #e6edf3;
  --color-fg-muted: #8d96a0;
  --color-fg-subtle: #6e7681;
  --color-fg-on-emphasis: #ffffff;

  --color-bg-default: #0d1117;
  --color-bg-subtle: #161b22;
  --color-bg-inset: #010409;
  --color-bg-emphasis: #6e7681;

  --color-border-default: #30363d;
  --color-border-muted: #21262d;
  --color-border-subtle: rgba(240,246,252,0.1);

  --color-accent-fg: #58a6ff;
  --color-accent-emphasis: #1f6feb;
  --color-accent-muted: rgba(56,139,253,0.4);
  --color-accent-subtle: rgba(56,139,253,0.15);

  --color-success-fg: #3fb950;
  --color-success-emphasis: #238636;
  --color-danger-fg: #f85149;
  --color-danger-emphasis: #da3633;
  --color-warning-fg: #d29922;
  --color-warning-emphasis: #9e6a03;

  --color-header-bg: #161b22;
}
```

## Type-Safe Page Data (page.go)

Following the kanban blueprint pattern, define strongly-typed structs for each page:

### Base Types

```go
package handler

// Breadcrumb for navigation trail
type Breadcrumb struct {
    Label string
    URL   string
}

// NavItem for sidebar/header navigation
type NavItem struct {
    Label    string
    URL      string
    Icon     string
    Active   bool
    Count    int
    External bool
}

// RepoTab represents a tab on the repository page
type RepoTab struct {
    Name   string
    URL    string
    Icon   string
    Count  int
    Active bool
}
```

### Auth Pages

```go
// LoginData holds data for the login page
type LoginData struct {
    Title      string
    Error      string
    ReturnTo   string
}

// RegisterData holds data for the registration page
type RegisterData struct {
    Title      string
    Error      string
}
```

### Dashboard/Home

```go
// HomeData holds data for the authenticated dashboard
type HomeData struct {
    Title           string
    User            *users.User
    Repositories    []*repos.Repository
    StarredRepos    []*repos.Repository
    Organizations   []*orgs.OrgSimple
    RecentActivity  []*activities.Activity
    Notifications   []*notifications.Notification
    UnreadCount     int
    ActiveNav       string
}
```

### Explore Page

```go
// ExploreData holds data for the explore page
type ExploreData struct {
    Title        string
    User         *users.User // nil if not logged in
    Repositories []*repos.Repository
    TrendingRepos []*repos.Repository
    Query        string
    Language     string
    Sort         string
    Page         int
    TotalCount   int
    HasNext      bool
    ActiveNav    string
}
```

### User Profile

```go
// UserProfileData holds data for user profile page
type UserProfileData struct {
    Title           string
    User            *users.User  // Current logged in user
    ProfileUser     *users.User  // User being viewed
    Repositories    []*repos.Repository
    PinnedRepos     []*repos.Repository
    Organizations   []*orgs.OrgSimple
    IsOwnProfile    bool
    IsFollowing     bool
    ContributionData string // JSON for contribution graph
    ActiveTab       string // overview, repositories, stars, followers, following
    Breadcrumbs     []Breadcrumb
}
```

### Repository Views

```go
// RepoView wraps a repository with navigation context
type RepoView struct {
    *repos.Repository
    Tabs        []RepoTab
    ActiveTab   string
    CanPush     bool
    CanAdmin    bool
    IsStarred   bool
    IsWatching  bool
}

// RepoHomeData holds data for repository home page
type RepoHomeData struct {
    Title          string
    User           *users.User
    Repo           *RepoView
    Readme         string // Rendered markdown
    Tree           []*TreeEntry
    Branches       []*branches.Branch
    Tags           []*releases.Tag
    CurrentBranch  string
    CurrentPath    string
    License        string
    Languages      map[string]int
    Contributors   []*repos.Contributor
    Breadcrumbs    []Breadcrumb
    ActiveNav      string
}

// TreeEntry represents a file/directory in repo
type TreeEntry struct {
    Name      string
    Path      string
    Type      string // file, dir, submodule, symlink
    Size      int64
    SHA       string
    LastCommit *commits.Commit
}

// RepoCodeData holds data for file browser
type RepoCodeData struct {
    Title         string
    User          *users.User
    Repo          *RepoView
    Tree          []*TreeEntry
    FileContent   string
    FilePath      string
    FileName      string
    IsFile        bool
    IsBinary      bool
    Language      string
    LineCount     int
    CurrentBranch string
    Branches      []*branches.Branch
    Breadcrumbs   []Breadcrumb
    ActiveNav     string
}
```

### Issues

```go
// IssueView wraps an issue with display context
type IssueView struct {
    *issues.Issue
    TimeAgo      string
    LabelViews   []*LabelView
}

// LabelView wraps a label with contrast color
type LabelView struct {
    *issues.Label
    TextColor string // black or white based on bg
}

// RepoIssuesData holds data for issues list
type RepoIssuesData struct {
    Title         string
    User          *users.User
    Repo          *RepoView
    Issues        []*IssueView
    OpenCount     int
    ClosedCount   int
    Labels        []*issues.Label
    Milestones    []*issues.Milestone
    Assignees     []*users.SimpleUser
    CurrentState  string // open, closed
    CurrentLabel  string
    CurrentSort   string
    Page          int
    HasNext       bool
    Breadcrumbs   []Breadcrumb
    ActiveNav     string
}

// IssueDetailData holds data for single issue view
type IssueDetailData struct {
    Title         string
    User          *users.User
    Repo          *RepoView
    Issue         *IssueView
    Comments      []*CommentView
    Timeline      []*TimelineEvent
    Labels        []*issues.Label
    Milestones    []*issues.Milestone
    Assignees     []*users.SimpleUser
    CanEdit       bool
    CanClose      bool
    Breadcrumbs   []Breadcrumb
    ActiveNav     string
}

// CommentView wraps a comment with author info
type CommentView struct {
    *comments.Comment
    Author       *users.SimpleUser
    TimeAgo      string
    IsEdited     bool
    Reactions    *issues.Reactions
}

// TimelineEvent represents an issue timeline event
type TimelineEvent struct {
    ID        int64
    Type      string // commented, labeled, assigned, closed, reopened, etc.
    Actor     *users.SimpleUser
    TimeAgo   string
    Data      map[string]interface{}
}
```

### Pull Requests

```go
// PullView wraps a PR with display context
type PullView struct {
    *pulls.PullRequest
    TimeAgo     string
    LabelViews  []*LabelView
    StatusIcon  string // check, x, dot
    StatusColor string
}

// RepoPullsData holds data for PR list
type RepoPullsData struct {
    Title         string
    User          *users.User
    Repo          *RepoView
    PullRequests  []*PullView
    OpenCount     int
    ClosedCount   int
    Labels        []*issues.Label
    CurrentState  string
    CurrentSort   string
    Page          int
    HasNext       bool
    Breadcrumbs   []Breadcrumb
    ActiveNav     string
}

// PullDetailData holds data for single PR view
type PullDetailData struct {
    Title          string
    User           *users.User
    Repo           *RepoView
    Pull           *PullView
    Commits        []*pulls.Commit
    Files          []*pulls.PRFile
    Reviews        []*pulls.Review
    Comments       []*CommentView
    Timeline       []*TimelineEvent
    CanMerge       bool
    MergeableState string
    Checks         []*CheckStatus
    Breadcrumbs    []Breadcrumb
    ActiveNav      string
}

// CheckStatus represents a CI check
type CheckStatus struct {
    Name       string
    State      string // pending, success, failure, error
    TargetURL  string
    Description string
}
```

### Create Forms

```go
// NewRepoData holds data for create repository form
type NewRepoData struct {
    Title         string
    User          *users.User
    Organizations []*orgs.OrgSimple
    Licenses      []License
    GitignoreTemplates []string
    Error         string
    ActiveNav     string
}

// NewIssueData holds data for create issue form
type NewIssueData struct {
    Title       string
    User        *users.User
    Repo        *RepoView
    Labels      []*issues.Label
    Milestones  []*issues.Milestone
    Assignees   []*users.SimpleUser
    Error       string
    Breadcrumbs []Breadcrumb
    ActiveNav   string
}
```

### Settings

```go
// RepoSettingsData holds data for repository settings
type RepoSettingsData struct {
    Title         string
    User          *users.User
    Repo          *RepoView
    Collaborators []*CollaboratorView
    Webhooks      []*webhooks.Webhook
    Branches      []*branches.BranchProtection
    Section       string // general, access, branches, webhooks, danger
    Error         string
    Success       string
    Breadcrumbs   []Breadcrumb
    ActiveNav     string
}

// CollaboratorView wraps a collaborator
type CollaboratorView struct {
    *users.SimpleUser
    Permission string // admin, write, read
}
```

### Notifications

```go
// NotificationsData holds data for notifications page
type NotificationsData struct {
    Title           string
    User            *users.User
    Notifications   []*NotificationView
    UnreadCount     int
    Filter          string // all, unread, participating
    ActiveNav       string
}

// NotificationView wraps a notification
type NotificationView struct {
    *notifications.Notification
    TimeAgo  string
    Icon     string
    TypeLabel string
}
```

## Page Handler (page.go)

```go
package handler

import (
    "html/template"
    "net/http"

    "github.com/go-mizu/mizu"
    "github.com/go-mizu/blueprints/githome/feature/..."
)

// Page handles page rendering
type Page struct {
    templates     map[string]*template.Template
    users         users.API
    repos         repos.API
    issues        issues.API
    pulls         pulls.API
    comments      comments.API
    orgs          orgs.API
    notifications notifications.API
    stars         stars.API
    watches       watches.API
    activities    activities.API
    branches      branches.API
    releases      releases.API
    labels        labels.API
    milestones    milestones.API
    collaborators collaborators.API
    getUserID     func(*mizu.Ctx) int64
}

// NewPage creates a new Page handler
func NewPage(
    templates map[string]*template.Template,
    users users.API,
    repos repos.API,
    // ... other services
    getUserID func(*mizu.Ctx) int64,
) *Page {
    return &Page{
        templates: templates,
        users:     users,
        repos:     repos,
        // ...
        getUserID: getUserID,
    }
}

// render is a generic template renderer
func render[T any](h *Page, c *mizu.Ctx, name string, data T) error {
    tmpl, ok := h.templates[name]
    if !ok {
        return c.Text(http.StatusInternalServerError, "Template not found: "+name)
    }
    c.Writer().Header().Set("Content-Type", "text/html; charset=utf-8")
    return tmpl.Execute(c.Writer(), data)
}

// Login renders the login page
func (h *Page) Login(c *mizu.Ctx) error {
    userID := h.getUserID(c)
    if userID != 0 {
        http.Redirect(c.Writer(), c.Request(), "/", http.StatusFound)
        return nil
    }
    return render(h, c, "login", LoginData{
        Title:    "Sign in",
        ReturnTo: c.Query("return_to"),
    })
}

// Home renders the dashboard
func (h *Page) Home(c *mizu.Ctx) error {
    userID := h.getUserID(c)
    if userID == 0 {
        // Show landing page for logged out users
        return h.Landing(c)
    }

    ctx := c.Request().Context()
    user, _ := h.users.GetByID(ctx, userID)

    // Fetch user's repos, starred repos, notifications in parallel
    repoList, _ := h.repos.ListForAuthenticatedUser(ctx, userID, &repos.ListOpts{PerPage: 10})
    starredRepos, _ := h.stars.ListStarredByUser(ctx, user.Login, &stars.ListOpts{PerPage: 5})
    notifs, _ := h.notifications.List(ctx, userID, &notifications.ListOpts{PerPage: 5})

    var unreadCount int
    for _, n := range notifs {
        if n.Unread {
            unreadCount++
        }
    }

    return render(h, c, "home", HomeData{
        Title:         "Dashboard",
        User:          user,
        Repositories:  repoList,
        StarredRepos:  starredRepos,
        Notifications: notifs,
        UnreadCount:   unreadCount,
        ActiveNav:     "home",
    })
}

// RepoHome renders the repository home page
func (h *Page) RepoHome(c *mizu.Ctx) error {
    owner := c.Param("owner")
    repoName := c.Param("repo")

    ctx := c.Request().Context()
    userID := h.getUserID(c)

    repo, err := h.repos.Get(ctx, owner, repoName)
    if err != nil {
        return c.Text(http.StatusNotFound, "Repository not found")
    }

    // Build repo view with tabs
    repoView := h.buildRepoView(ctx, repo, userID, "code")

    // Get README, tree, branches, etc.
    readme, _ := h.repos.GetReadme(ctx, owner, repoName, repo.DefaultBranch)
    branchList, _ := h.branches.List(ctx, owner, repoName, nil)

    var user *users.User
    if userID != 0 {
        user, _ = h.users.GetByID(ctx, userID)
    }

    return render(h, c, "repo_home", RepoHomeData{
        Title:         repo.FullName,
        User:          user,
        Repo:          repoView,
        Readme:        readme.Content,
        Branches:      branchList,
        CurrentBranch: repo.DefaultBranch,
        ActiveNav:     "",
    })
}

// buildRepoView creates a RepoView with tabs and permissions
func (h *Page) buildRepoView(ctx context.Context, repo *repos.Repository, userID int64, activeTab string) *RepoView {
    view := &RepoView{
        Repository: repo,
        ActiveTab:  activeTab,
    }

    // Build tabs
    view.Tabs = []RepoTab{
        {Name: "Code", URL: fmt.Sprintf("/%s", repo.FullName), Icon: "code", Active: activeTab == "code"},
        {Name: "Issues", URL: fmt.Sprintf("/%s/issues", repo.FullName), Icon: "issue-opened", Count: repo.OpenIssuesCount, Active: activeTab == "issues"},
        {Name: "Pull requests", URL: fmt.Sprintf("/%s/pulls", repo.FullName), Icon: "git-pull-request", Active: activeTab == "pulls"},
    }

    if repo.HasWiki {
        view.Tabs = append(view.Tabs, RepoTab{Name: "Wiki", URL: fmt.Sprintf("/%s/wiki", repo.FullName), Icon: "book"})
    }

    // Check permissions
    if userID != 0 {
        if repo.OwnerID == userID {
            view.CanPush = true
            view.CanAdmin = true
        }
        // Check starring/watching
        view.IsStarred, _ = h.stars.IsStarred(ctx, userID, repo.ID)
        view.IsWatching, _ = h.watches.IsWatching(ctx, userID, repo.ID)
    }

    return view
}
```

## HTML Templates

### Default Layout (layouts/default.html)

```html
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}} - GitHome</title>
    <link rel="stylesheet" href="/static/css/main.css">
</head>
<body>
    <header class="Header">
        <div class="Header-content">
            <a href="/" class="Header-logo">
                <svg height="32" viewBox="0 0 16 16" width="32" fill="currentColor">
                    <path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"/>
                </svg>
            </a>

            <nav class="Header-nav">
                {{if .User}}
                <div class="Header-search">
                    <input type="text" placeholder="Search or jump to..." class="Header-search-input">
                </div>
                <a href="/pulls" class="Header-link">Pull requests</a>
                <a href="/issues" class="Header-link">Issues</a>
                {{end}}
            </nav>

            <div class="Header-actions">
                {{if .User}}
                <a href="/notifications" class="Header-link Header-link--icon" title="Notifications">
                    <svg viewBox="0 0 16 16" width="16" height="16" fill="currentColor">
                        <path d="M8 16a2 2 0 0 0 1.985-1.75c.017-.137-.097-.25-.235-.25h-3.5c-.138 0-.252.113-.235.25A2 2 0 0 0 8 16ZM3 5a5 5 0 0 1 10 0v2.947c0 .05.015.098.042.139l1.703 2.555A1.519 1.519 0 0 1 13.482 13H2.518a1.516 1.516 0 0 1-1.263-2.36l1.703-2.554A.255.255 0 0 0 3 7.947Zm5-3.5A3.5 3.5 0 0 0 4.5 5v2.947c0 .346-.102.683-.294.97l-1.703 2.556a.017.017 0 0 0-.003.01l.001.006c0 .002.002.004.004.006l.006.004.007.001h10.964l.007-.001.006-.004.004-.006.001-.007a.017.017 0 0 0-.003-.01l-1.703-2.554a1.745 1.745 0 0 1-.294-.97V5A3.5 3.5 0 0 0 8 1.5Z"/>
                    </svg>
                    {{if gt .UnreadCount 0}}
                    <span class="Counter">{{.UnreadCount}}</span>
                    {{end}}
                </a>
                <a href="/new" class="Header-link Header-link--icon" title="Create new...">
                    <svg viewBox="0 0 16 16" width="16" height="16" fill="currentColor">
                        <path d="M7.75 2a.75.75 0 0 1 .75.75V7h4.25a.75.75 0 0 1 0 1.5H8.5v4.25a.75.75 0 0 1-1.5 0V8.5H2.75a.75.75 0 0 1 0-1.5H7V2.75A.75.75 0 0 1 7.75 2Z"/>
                    </svg>
                </a>
                <div class="Header-user">
                    <img src="{{.User.AvatarURL}}" alt="{{.User.Login}}" class="Avatar Avatar--small">
                </div>
                {{else}}
                <a href="/login" class="Header-link">Sign in</a>
                <a href="/register" class="btn btn-primary">Sign up</a>
                {{end}}
            </div>
        </div>
    </header>

    <main class="Main">
        {{template "content" .}}
    </main>

    <footer class="Footer">
        <div class="Footer-content">
            <span class="Footer-copyright">&copy; 2024 GitHome</span>
            <nav class="Footer-nav">
                <a href="/about">About</a>
                <a href="/docs">Docs</a>
                <a href="/api">API</a>
            </nav>
        </div>
    </footer>

    <script src="/static/js/app.js"></script>
</body>
</html>
```

### Repository Home (pages/repo_home.html)

```html
{{define "content"}}
<div class="repo-header">
    <div class="repo-header-content">
        <div class="repo-header-title">
            <svg class="octicon" viewBox="0 0 16 16" width="16" height="16">
                {{if .Repo.Private}}
                <path fill-rule="evenodd" d="M4 4a4 4 0 0 1 8 0v2h.25c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 12.25 15h-8.5A1.75 1.75 0 0 1 2 13.25v-5.5C2 6.784 2.784 6 3.75 6H4Zm8.25 3.5h-8.5a.25.25 0 0 0-.25.25v5.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 0-.25-.25ZM10.5 6V4a2.5 2.5 0 1 0-5 0v2Z"/>
                {{else}}
                <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"/>
                {{end}}
            </svg>
            <a href="/{{.Repo.Owner.Login}}" class="repo-owner">{{.Repo.Owner.Login}}</a>
            <span class="repo-separator">/</span>
            <a href="/{{.Repo.FullName}}" class="repo-name">{{.Repo.Name}}</a>
            <span class="Label Label--secondary">{{if .Repo.Private}}Private{{else}}Public{{end}}</span>
        </div>

        <div class="repo-header-actions">
            {{if .User}}
            <div class="BtnGroup">
                <button class="btn btn-sm BtnGroup-item{{if .Repo.IsWatching}} selected{{end}}">
                    <svg class="octicon" viewBox="0 0 16 16" width="16" height="16">
                        <path d="M1.679 7.932c.412-.621 1.242-1.75 2.366-2.717C5.175 4.242 6.527 3.5 8 3.5c1.473 0 2.825.742 3.955 1.715 1.124.967 1.954 2.096 2.366 2.717a.119.119 0 0 1 0 .136c-.412.621-1.242 1.75-2.366 2.717C10.825 11.758 9.473 12.5 8 12.5c-1.473 0-2.825-.742-3.955-1.715C2.921 9.818 2.091 8.69 1.679 8.068a.119.119 0 0 1 0-.136ZM8 2c-1.981 0-3.67.992-4.933 2.078C1.797 5.169.88 6.423.43 7.1a1.619 1.619 0 0 0 0 1.798c.45.678 1.367 1.932 2.637 3.024C4.329 13.008 6.019 14 8 14c1.981 0 3.67-.992 4.933-2.078 1.27-1.091 2.187-2.345 2.637-3.023a1.619 1.619 0 0 0 0-1.798c-.45-.678-1.367-1.932-2.637-3.023C11.671 2.992 9.981 2 8 2Zm0 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"/>
                    </svg>
                    Watch
                </button>
                <span class="Counter BtnGroup-item">{{.Repo.WatchersCount}}</span>
            </div>

            <div class="BtnGroup ml-2">
                <button class="btn btn-sm BtnGroup-item{{if .Repo.IsStarred}} selected{{end}}">
                    <svg class="octicon" viewBox="0 0 16 16" width="16" height="16">
                        <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Z"/>
                    </svg>
                    Star
                </button>
                <span class="Counter BtnGroup-item">{{.Repo.StargazersCount}}</span>
            </div>

            <div class="BtnGroup ml-2">
                <button class="btn btn-sm BtnGroup-item">
                    <svg class="octicon" viewBox="0 0 16 16" width="16" height="16">
                        <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"/>
                    </svg>
                    Fork
                </button>
                <span class="Counter BtnGroup-item">{{.Repo.ForksCount}}</span>
            </div>
            {{end}}
        </div>
    </div>
</div>

<nav class="UnderlineNav">
    <div class="UnderlineNav-body">
        {{range .Repo.Tabs}}
        <a href="{{.URL}}" class="UnderlineNav-item{{if .Active}} selected{{end}}">
            <svg class="octicon UnderlineNav-octicon" viewBox="0 0 16 16" width="16" height="16">
                <!-- Icon based on .Icon -->
            </svg>
            <span>{{.Name}}</span>
            {{if gt .Count 0}}
            <span class="Counter">{{.Count}}</span>
            {{end}}
        </a>
        {{end}}
    </div>
</nav>

<div class="container-xl clearfix">
    <div class="Layout Layout--flowRow-until-md">
        <div class="Layout-main">
            <!-- Branch selector and file path -->
            <div class="file-navigation mb-3">
                <div class="d-flex flex-justify-between">
                    <div class="d-flex">
                        <div class="branch-select-menu">
                            <button class="btn btn-sm">
                                <svg class="octicon" viewBox="0 0 16 16" width="16" height="16">
                                    <path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"/>
                                </svg>
                                <span>{{.CurrentBranch}}</span>
                                <span class="dropdown-caret"></span>
                            </button>
                        </div>
                    </div>

                    <div class="d-flex">
                        <a href="/{{.Repo.FullName}}/new/{{.CurrentBranch}}" class="btn btn-sm btn-primary">
                            Add file
                        </a>
                        <button class="btn btn-sm ml-2">
                            <svg class="octicon" viewBox="0 0 16 16" width="16" height="16">
                                <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"/>
                                <path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"/>
                            </svg>
                            Code
                        </button>
                    </div>
                </div>
            </div>

            <!-- File tree -->
            <div class="Box">
                <div class="Box-header">
                    <div class="d-flex">
                        <!-- Last commit info -->
                    </div>
                </div>
                <div class="Box-body">
                    {{range .Tree}}
                    <div class="Box-row Box-row--hover-blue">
                        <div class="d-flex">
                            <svg class="octicon color-fg-muted mr-3" viewBox="0 0 16 16" width="16" height="16">
                                {{if eq .Type "dir"}}
                                <path d="M1.75 1A1.75 1.75 0 0 0 0 2.75v10.5C0 14.216.784 15 1.75 15h12.5A1.75 1.75 0 0 0 16 13.25v-8.5A1.75 1.75 0 0 0 14.25 3H7.5a.25.25 0 0 1-.2-.1l-.9-1.2C6.07 1.26 5.55 1 5 1H1.75Z"/>
                                {{else}}
                                <path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0 1 13.25 16h-9.5A1.75 1.75 0 0 1 2 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h9.5a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 9 4.25V1.5Zm6.75.062V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"/>
                                {{end}}
                            </svg>
                            <a href="/{{$.Repo.FullName}}/blob/{{$.CurrentBranch}}/{{.Path}}" class="Link--primary">
                                {{.Name}}
                            </a>
                        </div>
                    </div>
                    {{end}}
                </div>
            </div>

            <!-- README -->
            {{if .Readme}}
            <div class="Box mt-4">
                <div class="Box-header">
                    <h2 class="Box-title">
                        <svg class="octicon mr-2" viewBox="0 0 16 16" width="16" height="16">
                            <path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"/>
                        </svg>
                        README.md
                    </h2>
                </div>
                <div class="Box-body markdown-body">
                    {{.Readme}}
                </div>
            </div>
            {{end}}
        </div>

        <div class="Layout-sidebar">
            <!-- About section -->
            <div class="BorderGrid BorderGrid--spacious">
                <div class="BorderGrid-row">
                    <div class="BorderGrid-cell">
                        <h2 class="h4 mb-3">About</h2>
                        {{if .Repo.Description}}
                        <p class="f4 my-3">{{.Repo.Description}}</p>
                        {{end}}

                        {{if .Repo.Homepage}}
                        <div class="my-3">
                            <a href="{{.Repo.Homepage}}" class="Link--primary text-bold">
                                <svg class="octicon mr-2" viewBox="0 0 16 16" width="16" height="16">
                                    <path d="M7.775 3.275a.75.75 0 0 0 1.06 1.06l1.25-1.25a2 2 0 1 1 2.83 2.83l-2.5 2.5a2 2 0 0 1-2.83 0 .75.75 0 0 0-1.06 1.06 3.5 3.5 0 0 0 4.95 0l2.5-2.5a3.5 3.5 0 0 0-4.95-4.95l-1.25 1.25Zm-4.69 9.64a2 2 0 0 1 0-2.83l2.5-2.5a2 2 0 0 1 2.83 0 .75.75 0 0 0 1.06-1.06 3.5 3.5 0 0 0-4.95 0l-2.5 2.5a3.5 3.5 0 0 0 4.95 4.95l1.25-1.25a.75.75 0 0 0-1.06-1.06l-1.25 1.25a2 2 0 0 1-2.83 0Z"/>
                                </svg>
                                {{.Repo.Homepage}}
                            </a>
                        </div>
                        {{end}}

                        {{if .Repo.Topics}}
                        <div class="my-3">
                            {{range .Repo.Topics}}
                            <a href="/topics/{{.}}" class="topic-tag">{{.}}</a>
                            {{end}}
                        </div>
                        {{end}}
                    </div>
                </div>

                <div class="BorderGrid-row">
                    <div class="BorderGrid-cell">
                        <h2 class="h4 mb-3">
                            <a href="/{{.Repo.FullName}}/releases" class="Link--primary">
                                Releases
                            </a>
                        </h2>
                        <span class="color-fg-muted">No releases published</span>
                    </div>
                </div>

                <div class="BorderGrid-row">
                    <div class="BorderGrid-cell">
                        <h2 class="h4 mb-3">Languages</h2>
                        {{range $lang, $bytes := .Languages}}
                        <span class="d-inline-flex flex-items-center">
                            <span class="repo-language-color" style="background-color: #f1e05a"></span>
                            <span class="color-fg-default text-bold mr-1">{{$lang}}</span>
                        </span>
                        {{end}}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{{end}}
```

## Page Tests (page_test.go)

```go
package handler

import (
    "bytes"
    "html/template"
    "testing"
    "time"

    "github.com/go-mizu/blueprints/githome/assets"
    "github.com/go-mizu/blueprints/githome/feature/issues"
    "github.com/go-mizu/blueprints/githome/feature/repos"
    "github.com/go-mizu/blueprints/githome/feature/users"
)

func loadTemplates(t *testing.T) map[string]*template.Template {
    t.Helper()
    templates, err := assets.Templates()
    if err != nil {
        t.Fatalf("Failed to load templates: %v", err)
    }
    return templates
}

func TestLoginTemplate(t *testing.T) {
    templates := loadTemplates(t)

    data := LoginData{
        Title: "Sign in",
    }

    var buf bytes.Buffer
    if err := templates["login"].Execute(&buf, data); err != nil {
        t.Errorf("Login template error: %v", err)
    }
}

func TestRegisterTemplate(t *testing.T) {
    templates := loadTemplates(t)

    data := RegisterData{
        Title: "Create account",
    }

    var buf bytes.Buffer
    if err := templates["register"].Execute(&buf, data); err != nil {
        t.Errorf("Register template error: %v", err)
    }
}

func TestHomeTemplate(t *testing.T) {
    templates := loadTemplates(t)

    user := &users.User{
        ID:        1,
        Login:     "testuser",
        Name:      "Test User",
        AvatarURL: "https://example.com/avatar.png",
    }

    repo := &repos.Repository{
        ID:          1,
        Name:        "test-repo",
        FullName:    "testuser/test-repo",
        Description: "A test repository",
        CreatedAt:   time.Now(),
    }

    data := HomeData{
        Title:        "Dashboard",
        User:         user,
        Repositories: []*repos.Repository{repo},
        ActiveNav:    "home",
    }

    var buf bytes.Buffer
    if err := templates["home"].Execute(&buf, data); err != nil {
        t.Errorf("Home template error: %v", err)
    }
}

func TestRepoHomeTemplate(t *testing.T) {
    templates := loadTemplates(t)

    user := &users.User{
        ID:    1,
        Login: "testuser",
    }

    owner := &users.SimpleUser{
        ID:    1,
        Login: "testuser",
    }

    repo := &repos.Repository{
        ID:              1,
        Name:            "test-repo",
        FullName:        "testuser/test-repo",
        Owner:           owner,
        Description:     "A test repository",
        DefaultBranch:   "main",
        StargazersCount: 42,
        ForksCount:      10,
        WatchersCount:   5,
    }

    repoView := &RepoView{
        Repository: repo,
        Tabs: []RepoTab{
            {Name: "Code", URL: "/testuser/test-repo", Icon: "code", Active: true},
            {Name: "Issues", URL: "/testuser/test-repo/issues", Icon: "issue-opened", Count: 3},
        },
        ActiveTab: "code",
    }

    data := RepoHomeData{
        Title:         repo.FullName,
        User:          user,
        Repo:          repoView,
        CurrentBranch: "main",
        Readme:        "<h1>Test Repo</h1><p>Welcome!</p>",
        Tree: []*TreeEntry{
            {Name: "src", Path: "src", Type: "dir"},
            {Name: "README.md", Path: "README.md", Type: "file"},
        },
    }

    var buf bytes.Buffer
    if err := templates["repo_home"].Execute(&buf, data); err != nil {
        t.Errorf("Repo home template error: %v", err)
    }
}

func TestRepoIssuesTemplate(t *testing.T) {
    templates := loadTemplates(t)

    user := &users.User{ID: 1, Login: "testuser"}
    owner := &users.SimpleUser{ID: 1, Login: "testuser"}

    repo := &repos.Repository{
        ID:       1,
        Name:     "test-repo",
        FullName: "testuser/test-repo",
        Owner:    owner,
    }

    repoView := &RepoView{
        Repository: repo,
        ActiveTab:  "issues",
    }

    issue := &issues.Issue{
        ID:        1,
        Number:    1,
        Title:     "Test issue",
        State:     "open",
        CreatedAt: time.Now(),
        User:      owner,
    }

    issueView := &IssueView{
        Issue:   issue,
        TimeAgo: "2 hours ago",
    }

    data := RepoIssuesData{
        Title:        "Issues",
        User:         user,
        Repo:         repoView,
        Issues:       []*IssueView{issueView},
        OpenCount:    1,
        ClosedCount:  0,
        CurrentState: "open",
        Page:         1,
    }

    var buf bytes.Buffer
    if err := templates["repo_issues"].Execute(&buf, data); err != nil {
        t.Errorf("Repo issues template error: %v", err)
    }
}

func TestIssueDetailTemplate(t *testing.T) {
    templates := loadTemplates(t)

    user := &users.User{ID: 1, Login: "testuser"}
    owner := &users.SimpleUser{ID: 1, Login: "testuser"}

    repo := &repos.Repository{
        ID:       1,
        Name:     "test-repo",
        FullName: "testuser/test-repo",
        Owner:    owner,
    }

    repoView := &RepoView{
        Repository: repo,
        ActiveTab:  "issues",
    }

    issue := &issues.Issue{
        ID:        1,
        Number:    1,
        Title:     "Test issue",
        Body:      "This is a test issue description.",
        State:     "open",
        CreatedAt: time.Now(),
        User:      owner,
    }

    issueView := &IssueView{
        Issue:   issue,
        TimeAgo: "2 hours ago",
    }

    data := IssueDetailData{
        Title:   "Test issue #1",
        User:    user,
        Repo:    repoView,
        Issue:   issueView,
        CanEdit: true,
        Breadcrumbs: []Breadcrumb{
            {Label: "Issues", URL: "/testuser/test-repo/issues"},
            {Label: "#1", URL: ""},
        },
    }

    var buf bytes.Buffer
    if err := templates["issue_view"].Execute(&buf, data); err != nil {
        t.Errorf("Issue view template error: %v", err)
    }
}

func TestNewRepoTemplate(t *testing.T) {
    templates := loadTemplates(t)

    user := &users.User{ID: 1, Login: "testuser"}

    data := NewRepoData{
        Title:     "Create a new repository",
        User:      user,
        ActiveNav: "new",
    }

    var buf bytes.Buffer
    if err := templates["new_repo"].Execute(&buf, data); err != nil {
        t.Errorf("New repo template error: %v", err)
    }
}

func TestUserProfileTemplate(t *testing.T) {
    templates := loadTemplates(t)

    user := &users.User{
        ID:        1,
        Login:     "testuser",
        Name:      "Test User",
        Bio:       "Software developer",
        Followers: 100,
        Following: 50,
    }

    repo := &repos.Repository{
        ID:          1,
        Name:        "popular-repo",
        FullName:    "testuser/popular-repo",
        Description: "My most popular repo",
    }

    data := UserProfileData{
        Title:        "testuser",
        User:         user,
        ProfileUser:  user,
        Repositories: []*repos.Repository{repo},
        IsOwnProfile: true,
        ActiveTab:    "overview",
    }

    var buf bytes.Buffer
    if err := templates["user_profile"].Execute(&buf, data); err != nil {
        t.Errorf("User profile template error: %v", err)
    }
}

func TestNotificationsTemplate(t *testing.T) {
    templates := loadTemplates(t)

    user := &users.User{ID: 1, Login: "testuser"}

    data := NotificationsData{
        Title:       "Notifications",
        User:        user,
        UnreadCount: 3,
        Filter:      "unread",
        ActiveNav:   "notifications",
    }

    var buf bytes.Buffer
    if err := templates["notifications"].Execute(&buf, data); err != nil {
        t.Errorf("Notifications template error: %v", err)
    }
}

func TestEmptyStates(t *testing.T) {
    templates := loadTemplates(t)

    tests := []struct {
        name     string
        template string
        data     interface{}
    }{
        {
            name:     "empty home",
            template: "home",
            data: HomeData{
                Title:        "Dashboard",
                User:         &users.User{ID: 1, Login: "newuser"},
                Repositories: []*repos.Repository{},
            },
        },
        {
            name:     "empty issues",
            template: "repo_issues",
            data: RepoIssuesData{
                Title:        "Issues",
                User:         &users.User{ID: 1, Login: "testuser"},
                Repo:         &RepoView{Repository: &repos.Repository{FullName: "testuser/test-repo"}},
                Issues:       []*IssueView{},
                CurrentState: "open",
            },
        },
        {
            name:     "empty explore",
            template: "explore",
            data: ExploreData{
                Title:        "Explore",
                Repositories: []*repos.Repository{},
            },
        },
    }

    for _, tt := range tests {
        t.Run(tt.name, func(t *testing.T) {
            var buf bytes.Buffer
            if err := templates[tt.template].Execute(&buf, tt.data); err != nil {
                t.Errorf("%s template error: %v", tt.template, err)
            }
        })
    }
}
```

## CSS Organization

The main.css file should be organized as follows:

1. **CSS Variables** (colors, typography, spacing)
2. **Base/Reset** (normalize, box-sizing)
3. **Typography** (headings, body, links)
4. **Layout** (containers, grid, flexbox utilities)
5. **Components**:
   - Header
   - Footer
   - Buttons
   - Forms/Inputs
   - Avatars
   - Labels/Badges
   - Counters
   - Box/Card
   - UnderlineNav (tabs)
   - BtnGroup
   - Timeline
   - Markdown-body
6. **Page-specific** (repo, issue, profile)
7. **Utilities** (display, spacing, colors)
8. **Dark mode overrides**

## Implementation Priorities

1. **Phase 1: Auth & Layout**
   - Login/Register pages
   - Default layout with header
   - Basic CSS framework

2. **Phase 2: Core Pages**
   - Dashboard/Home
   - User profile
   - Explore

3. **Phase 3: Repository**
   - Repo home with README
   - File browser
   - Branch selector

4. **Phase 4: Issues & PRs**
   - Issues list
   - Issue detail
   - Pull requests list
   - PR detail

5. **Phase 5: Polish**
   - Notifications
   - Settings pages
   - Dark mode
   - Mobile responsive

## Helper Functions

The embed.go should include these template helper functions:

```go
funcMap := template.FuncMap{
    "lower":      strings.ToLower,
    "upper":      strings.ToUpper,
    "title":      strings.Title,
    "truncate":   truncate,
    "timeAgo":    timeAgo,
    "formatDate": formatDate,
    "add":        func(a, b int) int { return a + b },
    "sub":        func(a, b int) int { return a - b },
    "eq":         func(a, b interface{}) bool { return a == b },
    "ne":         func(a, b interface{}) bool { return a != b },
    "contains":   strings.Contains,
    "hasPrefix":  strings.HasPrefix,
    "hasSuffix":  strings.HasSuffix,
    "join":       strings.Join,
    "split":      strings.Split,
    "safeHTML":   func(s string) template.HTML { return template.HTML(s) },
    "json":       jsonMarshal,
    "contrastColor": contrastColor, // returns black/white based on bg
    "pluralize":  pluralize,
    "default":    defaultValue,
}
```

## Responsive Breakpoints

```css
/* Mobile first */
@media (min-width: 544px) { /* sm */ }
@media (min-width: 768px) { /* md */ }
@media (min-width: 1012px) { /* lg */ }
@media (min-width: 1280px) { /* xl */ }
```

## Accessibility Requirements

1. All interactive elements must be keyboard accessible
2. Proper ARIA labels on icon-only buttons
3. Sufficient color contrast (WCAG 2.1 AA)
4. Focus indicators on all focusable elements
5. Skip-to-content link
6. Semantic HTML structure
7. Alt text for images
8. Form labels and error messages

## File Size Targets

- CSS: < 50KB minified
- JS: < 20KB minified
- Total initial page load: < 100KB (excluding images)
